## ç¿»è¯‘: å¦‚ä½•ä½¿ç”¨ PostgreSQL æ‰§è¡Œï¼ˆå†›äº‹ï¼‰åœ°ç†åˆ†æä»»åŠ¡    
                                                                                    
### ä½œè€…                                                                                    
Taras Kloba                                                                                    
                                                                                    
### æ—¥æœŸ                                                                                    
2024-03-14                                                                             
                                                                                    
### æ ‡ç­¾                                                                                    
PostgreSQL , PolarDB , DuckDB , åœ°ç†ä¿¡æ¯åˆ†æ                       
                                                                                    
----                                                                                    
                                                                                    
## èƒŒæ™¯    
è¯´æ˜: ç¿»è¯‘æ–‡, ä¸ä»£è¡¨ä»»ä½•ä¸ªäººè§‚ç‚¹å’Œç«‹åœº, ä»…ç”¨äºæŠ€æœ¯å­¦ä¹ .   
  
åŸæ–‡åœ°å€: https://klioba.com/how-to-use-postgresql-for-military-geoanalytics-tasks  
  
# ç¿»è¯‘å†…å®¹å¦‚ä¸‹  
åœ°ç†åˆ†æåœ¨å†›äº‹äº‹åŠ¡ä¸­è‡³å…³é‡è¦ï¼Œå› ä¸ºå†›äº‹æ•°æ®çš„å¾ˆå¤§ä¸€éƒ¨åˆ†åŒ…å«åœ°ç†å±æ€§ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨ PostgreSQL å¤„ç†åœ°ç†ç©ºé—´æ•°æ®å¹¶è§£å†³å¸¸è§çš„åœ°ç†åˆ†æä»»åŠ¡ã€‚è¿™äº›ä¿¡æ¯å°†æ¶µç›–æŸ¥æ‰¾æœ€è¿‘ç‰©ä½“ã€è·ç¦»è®¡ç®—ä»¥åŠä½¿ç”¨åœ°ç†ç©ºé—´ç´¢å¼•æ¥å¢å¼ºè¿™äº›è¿‡ç¨‹çš„æ–¹æ³•ã€‚æˆ‘ä»¬è¿˜å°†æ¢ç´¢ç¡®å®šå¤šè¾¹å½¢å†…çš„ç‚¹å’Œåœ°ç†ç©ºé—´èšåˆçš„æŠ€æœ¯ã€‚æœ¬æ–‡çš„ç›®æ ‡æ˜¯æä¾›å®é™…ç¤ºä¾‹å’ŒæŠ€å·§ï¼Œä»¥å¢å¼ºåœ°ç†ç©ºé—´æ•°æ®çš„ä½¿ç”¨å¹¶æœ‰åŠ©äºæ–°è§£å†³æ–¹æ¡ˆçš„å¼€å‘ã€‚  
  
*æ–‡ç« ä¸­ä½¿ç”¨çš„ææ–™å’Œæ•°æ®éƒ½æ˜¯å¼€æºçš„ï¼Œå¹¶å¾—åˆ°äº†å†›æ–¹ä»£è¡¨çš„è®¤å¯ã€‚*  
  
## ç¬¬ä¸€ä¸ªæ•°æ®æºï¼šå¦‚ä½•å°†ä¿„ç½—æ–¯å†›äº‹å¤šè¾¹å½¢æ•°æ®å¯¼å…¥PostgreSQL  
æˆ‘å°†éœ€è¦æŸäº›æ•°æ®é›†æ¥å¯åŠ¨åˆ†æå¹¶å±•ç¤º PostgreSQL åœ¨åœ°ç†åˆ†ææ–¹é¢çš„åŠŸèƒ½ã€‚æˆ‘å†³å®šä»[OpenStreetMap (OSM)](https://www.openstreetmap.org/)ä¸Šæä¾›çš„ä¿„ç½—æ–¯å†›äº‹è®¾æ–½æ•°æ®å¼€å§‹ ã€‚ç¬¬ä¸€æ­¥æ˜¯å°†è¿™äº›æ•°æ®åŠ è½½åˆ° PostgreSQL ä¸­ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·æ¥ä¼˜åŒ–æŸ¥è¯¢å¹¶æé«˜å…¶æ•ˆç‡ã€‚  
  
è¦ä» OSM å¯¼å…¥ä¿„ç½—æ–¯å†›äº‹ç›®æ ‡çš„æ•°æ®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [osm2pgsql](https://osm2pgsql.org/) å·¥å…·ã€‚è¿™ä¸ªå¼€æºå·¥å…·å¯ä»¥æœ‰æ•ˆåœ°å°†æ•°æ®ä» OSM ä¼ è¾“åˆ° PostgreSQLã€‚æˆ‘ä»¬å°†åŠ è½½ [Russia-latest.osm.pbf](http://download.geofabrik.de/russia-latest.osm.pbf) æ–‡ä»¶ (3.4 GB)ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³ OSM ä¸­çš„ç‚¹ã€çº¿ã€é“è·¯å’Œå¤šè¾¹å½¢çš„ä¿¡æ¯ã€‚åŠ è½½åï¼Œè¯¥æ–‡ä»¶å°†ç”¨äºå¡«å……PostgreSQLä¸­ç›¸åº”çš„è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­å¼€å§‹æ•°æ®çš„åˆ†æå’Œå¤„ç†ã€‚  
  
æˆ‘ä»¬ä½¿ç”¨çš„è„šæœ¬åŒ…æ‹¬åŠ è½½ OSM æ•°æ®ã€åˆ›å»ºæ–°çš„ PostgreSQL æ•°æ®åº“ä»¥åŠä½¿ç”¨ osm2pgsql å¯¼å…¥æ•°æ®çš„å‘½ä»¤ï¼š  
```  
#!/bin/bash  
   
# Variable for the database and OSM file name  
DB_NAME="russia_latest"    
   
# Construct the OSM data URL using the DB_NAME  
OSM_DATA_URL="http://download.geofabrik.de/russia-latest.osm.pbf"  
   
# Download the latest OSM data for Russia  
echo "Downloading OSM data for Russia..."  
wget $OSM_DATA_URL -O $DB_NAME.osm.pbf  
   
# Create a new PostgreSQL database with the corrected name  
echo "Creating new PostgreSQL database named $DB_NAME..."  
sudo -u postgres psql -c "CREATE DATABASE $DB_NAME;"  
sudo -u postgres psql -d $DB_NAME -c "CREATE EXTENSION postgis;"  
   
# Import the OSM data into the PostgreSQL database using osm2pgsql  
echo "Importing OSM data into PostgreSQL database named $DB_NAME..."  
osm2pgsql --create \  
          --verbose \  
          --database $DB_NAME \  
          --latlong \  
          --number-processes 4 \  
          --username postgres \  
          --host localhost \  
          --port 5432 \  
          --password \  
          $DB_NAME.osm.pbf  
   
echo "Data import complete."   
```  
  
[view rawimport_russia_osm_to_postgres.sh hosted with â¤ by GitHub](https://gist.github.com/kloba/5df9d0e76adabeda278c6d5c9cef7828/raw/53f81e7e330df6dae040d5584e05240de5a0e280/import_russia_osm_to_postgres.sh)   
  
  
æ‰§è¡Œè„šæœ¬åï¼Œæˆ‘ä»¬çš„æ•°æ®åº“ä¸­å°†å‡ºç°äº”ä¸ªä¸»è¦è¡¨ï¼š  
- osm2pgsql_properties â€”å­˜å‚¨æ•°æ®å¯¼å…¥æœŸé—´ä½¿ç”¨çš„è®¾ç½®å’Œå±æ€§ã€‚  
- Planet_osm_line â€”åŒ…å«çº¿æ€§å…ƒç´ ï¼Œä¾‹å¦‚é“è·¯å’Œæ²³æµã€‚  
- Planet_osm_point â€”åŒ…æ‹¬ç‚¹å¯¹è±¡ï¼Œä¾‹å¦‚å»ºç­‘ç‰©ï¼ˆå¹¶éæ‰€æœ‰å»ºç­‘ç‰©éƒ½è¢«æ ‡è®°ä¸ºåœ°ç†å¤šè¾¹å½¢ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è®¾è®¡ä¸€äº›ä¸œè¥¿æ¥å¤„ç†è¿™äº›ç‚¹ï¼‰ã€‚  
- Planet_osm_polygon â€”å­˜å‚¨ä»£è¡¨åŒºåŸŸçš„å¤šè¾¹å½¢ï¼Œä¾‹å¦‚å†›äº‹åŸºåœ°ã€‚  
- Planet_osm_roads â€”å­˜å‚¨äº¤é€šè·¯çº¿ã€‚  
  
ä¸ºäº†ç®€åŒ–å†›äº‹å¯¹è±¡çš„åˆ†æï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸ºMilitary_geometriesçš„è¡¨ã€‚SQL è„šæœ¬å°†ä» planet_osm_lineã€planet_osm_pointã€planet_osm_polygonå’Œ planet_osm_roadsè¡¨ä¸­é€‰æ‹©æ•°æ®ï¼Œè¿‡æ»¤æ‰å†›äº‹å¯¹è±¡ã€‚ä½¿ç”¨ [ST_Buffer](https://postgis.net/docs/ST_Buffer.html) å°† 100 ç±³ç¼“å†²åŒºåº”ç”¨äºçº¿ã€ç‚¹å’Œé“è·¯ ã€‚è¿™è¿˜å…è®¸æˆ‘ä»¬åŸºäºç‚¹å’Œçº¿åˆ›å»ºå¤šè¾¹å½¢ï¼Œæä¾›åˆ†æçš„èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªç‚¹æ˜¯å¦åœ¨æŒ‡å®šçš„å¤šè¾¹å½¢å†…ã€‚  
```  
DROP TABLE IF EXISTS military_geometries;  
   
CREATE TABLE military_geometries AS  
SELECT osm_id, 'line' AS geom_type, landuse, military, building, name, operator,  
       ST_Buffer(way, 0.0009)::geometry(Polygon, 4326) AS geom  
FROM public.planet_osm_line  
WHERE military IS NOT NULL OR building = 'military' OR landuse = 'military'  
   
UNION ALL  
   
SELECT osm_id, 'point' AS geom_type, landuse, military, building, name, operator,  
       ST_Buffer(way, 0.0009)::geometry(Polygon, 4326) AS geom  
FROM public.planet_osm_point  
WHERE military IS NOT NULL OR building = 'military' OR landuse = 'military'  
   
UNION ALL  
   
SELECT osm_id, 'polygon' AS geom_type, landuse, military, building, name, operator,  
       way::geometry(Polygon, 4326) AS geom  
FROM public.planet_osm_polygon  
WHERE military IS NOT NULL OR building = 'military' OR landuse = 'military'  
   
UNION ALL  
   
SELECT osm_id, 'road' AS geom_type, landuse, military, building, name, operator,  
       ST_Buffer(way, 0.0009)::geometry(Polygon, 4326) AS geom  
FROM public.planet_osm_roads  
WHERE military IS NOT NULL OR building = 'military' OR landuse = 'military';  
   
--  
SELECT 9252 Query returned successfully in 12 secs 151 ms.   
```  
  
[view rawcreate_military_geometries.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/882a40179ba66d7d218ab8ef9a306fd7/raw/30f147a5890b32a7243220d3aa3f53e4c8a53162/create_military_geometries.sql)  
  
æ‰§è¡Œæä¾›çš„ SQL è„šæœ¬å°†å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Military_geometriesè¡¨ï¼Œå…¶ä¸­åŒ…å« OSM ä¸Šè¯†åˆ«çš„ 9,252 ä¸ªå†›äº‹ç‰©ä½“çš„å¤šè¾¹å½¢ï¼š  
  
![pic](20240314_05_pic_001.png)  
  
ä½¿ç”¨ QGIS å¯¹ä¿„ç½—æ–¯å’Œä¸´æ—¶å é¢†çš„å…‹é‡Œç±³äºšè‡ªæ²»å…±å’Œå›½çš„ 9,252 ä¸ªå†›äº‹åœ°ç‚¹è¿›è¡Œå¯è§†åŒ–  
  
åœ¨ OSM ä¸­ï¼Œä¸å…¶ä»–å¼€æºä¸€æ ·ï¼Œä¿¡æ¯å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä¾‹å¦‚ï¼Œä»2022å¹´åˆå¼€å§‹ï¼Œä¿„ç½—æ–¯åˆ é™¤äº†2995ä¸ªå†›äº‹ç›®æ ‡ã€‚  
  
ä»–ä»¬è¯´ï¼Œâ€œå±å¹•æˆªå›¾ä¸ä¼šè¢«çƒ§æ¯â€ï¼Œä½†è¿™ç§åˆ é™¤å¾€å¾€ä¼šå¯¼è‡´[å²ç¿ çŠæ•ˆåº”](https://en.wikipedia.org/wiki/Streisand_effect)ï¼Œå³è¯•å›¾éšè—ä¿¡æ¯åªä¼šå¸å¼•æ›´å¤šå…³æ³¨ã€‚å¦‚æœæ‚¨æƒ³æ·±å…¥ç ”ç©¶ OSM çš„å†å²æ•°æ®å¹¶å¸®åŠ©è¯†åˆ«æ­¤ç±»å¼‚å¸¸æƒ…å†µï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [GeoFabrik.de](https://download.geofabrik.de/russia.html) ç­‰èµ„æºã€‚è™½ç„¶è¿™ä¸æˆ‘ä»¬çš„åˆ†ææ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œä½†æˆ‘æƒ³å±•ç¤ºè¿™äº›è¢«åˆ é™¤çš„ç‰©ä½“åœ¨åœ°å›¾ä¸Šçš„æ ·å­ï¼Œè¯´æ˜ä¿„ç½—æ–¯è¯•å›¾éšè—é‡è¦æ•°æ®ã€‚  
  
![pic](20240314_05_pic_002.jpeg)  
  
2022 å¹´ 1 æœˆ 1 æ—¥ä¹‹ååˆ é™¤ï¼ˆè“è‰²ï¼‰å’Œè«æ–¯ç§‘å†›äº‹è®¾æ–½ç°æœ‰ï¼ˆçº¢è‰²ï¼‰åœ°ç†å¤šè¾¹å½¢  
  
## ç¬¬äºŒä¸ªæ•°æ®æºï¼šNASAå«æ˜Ÿçš„ç«ç¾æ•°æ®  
ä½œä¸ºä¸‹ä¸€ä¸ªæ•°æ®æºï¼Œæˆ‘ä»¬å°†åˆ©ç”¨é©¬é‡Œå…°å¤§å­¦åœ¨ NASA å’Œè”åˆå›½çš„æ”¯æŒä¸‹äº 2007 å¹´å¼€å‘çš„[ç«ç¾ä¿¡æ¯èµ„æºç®¡ç†ç³»ç»Ÿ](https://www.earthdata.nasa.gov/learn/find-data/near-real-time/firms/vj114imgtdlnrt)  (FIRMS) çš„ä¿¡æ¯ã€‚FIRMS å¯ä»¥åˆ©ç”¨æ•°æ®å®æ—¶ç›‘æ§å…¨çƒæ­£åœ¨å‘ç”Ÿçš„ç«ç¾æ¥è‡ª S-NPP å’Œ NOAA 20 å«æ˜Ÿä¸Šé…å¤‡ MODIS å…‰è°±è¾å°„è®¡å’Œ VIIRS çš„ Aqua å’Œ Terra å«æ˜Ÿã€‚è¯¥ä¿¡æ¯æ¯ä¸‰ä¸ªå°æ—¶æ›´æ–°ä¸€æ¬¡ï¼Œç¾å›½å’ŒåŠ æ‹¿å¤§çš„æ›´æ–°é¢‘ç‡æ›´é«˜ã€‚  
  
è‡ª 2022 å¹´ä»¥æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ FIRMS æ•°æ®æ¥è¯†åˆ«ä¿„ç½—æ–¯å†›äº‹è®¾æ–½å¢ƒå†…çš„ç«ç¾ã€‚  
  
ä¸ºäº†ä» FIRMS ç³»ç»Ÿä¸‹è½½ç«ç¾æ•°æ®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼Œæå–ä» 2022 å¹´ 1 æœˆ 1 æ—¥åˆ°å½“å‰æ—¥æœŸä¿„ç½—æ–¯çš„æ‰€æœ‰ç«ç¾è®°å½•ã€‚ç„¶åï¼Œè¿™äº›æ•°æ®å°†è¢«å¯¼å…¥åˆ°PostgreSQL æ•°æ®åº“ä¸­çš„æ–°è¡¨viirs_fire_eventsä¸­ã€‚  
```  
from datetime import datetime, timedelta  
import time  
import requests  
import psycopg2  
import csv  
from psycopg2.extras import execute_values  
   
# Your NASA FIRMS API key  
api_key = 'your_api_key'  
   
# Start and end dates for the data retrieval  
start_date = datetime(2022, 1, 1)  
end_date = datetime(2023, 12, 24)  
   
# URL for the NASA FIRMS API call  
base_url = "https://firms.modaps.eosdis.nasa.gov/api/country/csv/{}/VIIRS_NOAA20_NRT/RUS/1/{}"  
   
# Database connection details  
db_name = 'your_db_name'  
db_user = 'your_db_user'  
db_password = 'your_db_password'  
db_host = 'your_db_host'  
db_port = 'your_db_port'  
   
# Function to insert data into PostgreSQL  
def insert_data_into_db(data, cursor):  
    insert_query = """INSERT INTO viirs_fire_events (country_id, latitude, longitude, bright_ti4, scan, track, acq_date, acq_time, satellite, instrument, confidence, version, bright_ti5, frp, daynight) VALUES %s;"""  
    execute_values(cursor, insert_query, data)  
   
# Function to fetch and insert data into the database  
def fetch_and_insert_data(date, cursor):  
    formatted_date = date.strftime("%Y-%m-%d")  
    try:  
        response = requests.get(base_url.format(api_key, formatted_date))  
          
        if "Invalid MAP_KEY" in response.text:  
            print(f"Invalid MAP_KEY detected for {formatted_date}. Waiting for 10 minutes before retrying.")  
            time.sleep(600)  # Wait for 10 minutes  
            return fetch_and_insert_data(date, cursor)  # Retry  
   
        decoded_content = response.content.decode('utf-8')  
        csv_reader = csv.reader(decoded_content.splitlines(), delimiter=',')  
        next(csv_reader, None)  # Skip the header  
        rows = [tuple(row) for row in csv_reader if row]  
   
        if rows:  
            insert_data_into_db(rows, cursor)  
            print(f"Data for {formatted_date} inserted successfully (rows = {len(rows)}).")  
        else:  
            print(f"No valid data to insert for {formatted_date}.")  
   
    except Exception as e:  
        # General exception handler for any other unexpected errors  
        print(f"Error fetching data for {formatted_date}: {e}")  
   
try:  
    conn = psycopg2.connect(dbname=db_name, user=db_user, password=db_password, host=db_host, port=db_port)  
    cur = conn.cursor()  
   
    current_date = start_date  
    while current_date <= end_date:  
        fetch_and_insert_data(current_date, cur)  
        conn.commit()  
        current_date += timedelta(days=1)  
      
except Exception as e:  
    print(f"Database error: {e}")  
finally:  
    if cur is not None:  
        cur.close()  
    if conn is not None:  
        conn.close()  
   
print("Data fetching and insertion complete.")   
```  
  
[view rawfetch_insert_viirs_fire_data.py hosted with â¤ by GitHub](https://gist.github.com/kloba/8c64099f4286fd3275b7a9604e5b9128/raw/39f00d492399472677477433cb64205f610300ae/fetch_insert_viirs_fire_data.py)  
  
å› æ­¤ï¼Œæˆ‘ä»¬å°†å¡«å……viirs_fire_eventsè¡¨ï¼Œå…¶ä¸­å°†åŒ…å« 1,711,475 æ¡ä¿„ç½—æ–¯ç«ç¾è®°å½•ã€‚è¿™äº›ç«ç¾çš„è¡¨ç°å¦‚ä¸‹ï¼š  
  
![pic](20240314_05_pic_003.jpeg)  
  
è‡ª 2022 å¹´ 1 æœˆ 1 æ—¥ä»¥æ¥ä¿„ç½—æ–¯ç«ç¾å¯è§†åŒ–ï¼ˆ1,711,475 èµ·ç«ç¾ï¼‰  
  
PostgreSQL æ•°æ®åº“ä¸­çš„viirs_fire_eventsè¡¨å°†ç”¨äºå­˜å‚¨è¯¦ç»†çš„ç«ç¾æ•°æ®ï¼Œå…¶ä¸­åŒ…å«åæ ‡ã€å«æ˜Ÿå‚æ•°ã€é‡‡é›†æ—¥æœŸå’Œæ—¶é—´ä»¥åŠå…¶ä»–å…³é”®å…ƒæ•°æ®å­—æ®µã€‚å°†æ ¹æ®ç»åº¦å’Œ çº¬åº¦åˆ—ä¸­çš„æ•°æ®è‡ªåŠ¨å¡«å……æ•°æ®ç±»å‹ä¸ºGEOMETRY(POINT, 4326)çš„æ–°åˆ—ã€‚  
```  
CREATE TABLE viirs_fire_events (  
    country_id TEXT,  
    latitude FLOAT,  
    longitude FLOAT,  
    bright_ti4 FLOAT,  
    scan FLOAT,  
    track FLOAT,  
    acq_date DATE,  
    acq_time INT,  
    satellite TEXT,  
    instrument TEXT,  
    confidence TEXT,  
    version TEXT,  
    bright_ti5 FLOAT,  
    frp FLOAT,  
    daynight TEXT,  
    geom GEOMETRY(POINT, 4326) GENERATED ALWAYS AS (ST_MakePoint(longitude, latitude)) STORED  
);   
```  
  
[view rawcreate_viirs_fire_events_table.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/14a295808b1173044ef2ace4465fb5f4/raw/d7cfec4dc63a6b25ddf8f160758c20b430da0a5c/create_viirs_fire_events_table.sql)  
  
å‡è®¾æ‚¨æœ‰å…´è¶£ä½¿ç”¨æœ‰å…³å†›äº‹ç‰©ä½“å’Œç«ç¾çš„æ•°æ®ï¼Œä½†æ‰€æè¿°çš„æå–æ•°æ®é›†çš„è¿‡ç¨‹ä¼¼ä¹éå¸¸è€—æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸ºæ‚¨å¯¼å‡º CSV è¡¨ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹é“¾æ¥ä¸‹è½½å®ƒä»¬ï¼š [military_geometries](https://storage.googleapis.com/files.sql.ua/csv/military_geometries.csv)ã€ [viirs_fire_events](https://storage.googleapis.com/files.sql.ua/csv/viirs_fire_events.csv)ã€‚  
  
## æœç´¢å‘ç”Ÿç«ç¾çš„å†›äº‹è®¾æ–½ï¼šå¤šè¾¹å½¢å†…çš„ç‚¹  
ç›®å‰ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªè¡¨ï¼šMilitary_geometrieså’Œ viirs_fire_eventsã€‚è®©æˆ‘ä»¬å°è¯•æŸ¥æ‰¾é‚£äº›å‘ç”Ÿè¿‡ç«ç¾ï¼ˆè‡ª 2022 å¹´åˆä»¥æ¥ï¼‰æˆ–å°šæœªå‘ç”Ÿç«ç¾çš„å†›äº‹è®¾æ–½ ğŸ™‚ã€‚  
  
![pic](20240314_05_pic_004.png)  
  
è®©æˆ‘ä»¬ä½¿ç”¨å¸¦æœ‰ [ST_Contains](https://postgis.net/docs/ST_Contains.html) å‡½æ•°çš„ SQL æŸ¥è¯¢æ¥è¯†åˆ«ä» NASA å«æ˜Ÿæ£€æµ‹åˆ°ç«ç¾çš„å†›äº‹ç‰©ä½“ã€‚  
```  
SELECT mg.osm_id,   
    mg.geom_type,   
    mg.landuse,   
    mg.military,   
    mg.building,   
    mg.name,   
    mg.operator,   
    mg.geom  
FROM public.military_geometries AS mg  
WHERE EXISTS (  
    SELECT 1  
    FROM public.viirs_fire_events AS vfe  
    WHERE ST_Contains(mg.geom, vfe.geom)  
);  
--  
Successfully run. Total query runtime: 54 min 15 secs. 129 rows affected.   
```  
  
[view rawselect_military_areas_with_fires.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/49609e30b2b736c4d758c26c11fea068/raw/a75ff87ee03a31ad47b645b90195b98884b90464/select_military_areas_with_fires.sql)  
  
æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬å·²ç»ç¡®å®šäº†è‡ª 2022 å¹´åˆä»¥æ¥å‘ç”Ÿè¿‡ç«ç¾çš„ 129 ä¸ªå†›äº‹åœºæ‰€ã€‚æœ‰è¶£çš„æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›ç«ç¾ä¼¼ä¹å‘ç”Ÿäº†ä¸æ­¢ä¸€æ¬¡ã€‚  
  
![pic](20240314_05_pic_005.png)  
  
2022å¹´åˆä»¥æ¥å‘ç”Ÿç«ç¾çš„å†›äº‹è®¾æ–½ï¼ˆè®¾æ–½çš„é€æ˜åº¦è¡¨æ˜ç«ç¾äº‹ä»¶çš„é¢‘ç‡ï¼‰  
  
æ‚¨å¯èƒ½æ³¨æ„åˆ°çš„ç¬¬äºŒä¸ªæ–¹é¢æ˜¯ï¼ŒæŒ‡å®šçš„æŸ¥è¯¢æ‰§è¡Œäº† 54 åˆ† 15 ç§’ï¼Œè¿™å¯¹äºå¦‚æ­¤ç®€å•çš„æ“ä½œæ¥è¯´ç›¸å½“é•¿ã€‚ä½¿ç”¨ [EXPLAIN ANALYZE](https://www.postgresql.org/docs/current/sql-explain.html) å‘½ä»¤æ¥äº†è§£æ­¤æŒç»­æ—¶é—´çš„åŸå› å¾ˆæœ‰å¸®åŠ©ã€‚è¯¥å‘½ä»¤å…è®¸æ‚¨åˆ†ææŸ¥è¯¢æ‰§è¡Œè¿‡ç¨‹ï¼Œè¯†åˆ«æ½œåœ¨çš„ç“¶é¢ˆï¼Œå¹¶è¿›ä¸€æ­¥ä¼˜åŒ–æŸ¥è¯¢ä»¥æé«˜æ€§èƒ½ã€‚  
```  
Nested Loop Semi Join  (cost=0.00..395827843592.52 rows=8 width=524) (actual time=4628.471..4005790.130rows=129 loops=1)  
  Join Filter: st_contains(mg.geom, vfe.geom)  
  Rows Removed by Join Filter: 15695214562  
  ->  Seq Scan on military_geometries mg  (cost=0.00..649.52 rows=9252 width=524) (actual time=0.009..22.516rows=9252 loops=1)  
  ->  Materialize  (cost=0.00..70285.12 rows=1711475 width=32) (actual time=0.015..121.310 rows=1696413loops=9252)  
        ->  Seq Scan on viirs_fire_events vfe  (cost=0.00..50027.75 rows=1711475 width=32) (actual time=124.339..351.922 rows=1711475 loops=1)  
Planning Time: 0.923 ms  
Execution Time: 4005798.854 ms   
```  
  
[view rawmilitary_areas_with_fires_query_plan.txt hosted with â¤ by GitHub](https://gist.github.com/kloba/5865856dae4e0995bcf00967394d2d50/raw/4234182603ecc1d21225948c7e6f7e965a267c21/military_areas_with_fires_query_plan.txt)  
  
åœ¨æœ¬ä¾‹ä¸­ï¼Œå½“ä½¿ç”¨Nested Loop Semi Joinè¿ç®—ç¬¦æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº† `O(n*m)` çš„å¤æ‚åº¦ï¼Œå…¶ä¸­ n æ˜¯ Military_geometries è¡¨ä¸­çš„ 9,252 è¡Œ ï¼Œ m æ˜¯ viirs_fire_eventsä¸­çš„ 1,711,475 è¡Œã€‚è¿™æ„å‘³ç€ç¬¬ä¸€ä¸ªè¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½ä¼šä¸ç¬¬äºŒä¸ªè¡¨ä¸­çš„æ¯ä¸€è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œå¯¼è‡´å¤§é‡æ“ä½œã€‚  
  
å› æ­¤ï¼Œè®©æˆ‘ä»¬è®¨è®ºå¦‚ä½•é€šè¿‡åˆ©ç”¨ç´¢å¼•æ¥åŠ å¿«æ­¤ç±»æŸ¥è¯¢çš„æ‰§è¡Œé€Ÿåº¦ã€‚  
  
## ç”Ÿäº§åŠ›æå‡ï¼šåœ¨åœ°ç†åˆ†æä¸­åˆ©ç”¨ç´¢å¼•  
PostgreSQL ä»¥å…¶å¯æ‰©å±•æ€§åŠŸèƒ½è€Œé—»åï¼Œæä¾›äº†å¤šç§è®¿é—®è¯¥æ•°æ®åº“ä¸­çš„åœ°ç†ç©ºé—´æ•°æ®çš„æ–¹æ³•ã€‚è¦æŸ¥æ‰¾é€‚åˆå¤„ç†äºŒç»´ç©ºé—´ä¸­çš„ç‚¹çš„æ‰€æœ‰æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼š  
```  
SELECT am.amname AS access_method, typ.typname, opc.opcname AS operator_class   
FROM pg_am am  
INNER JOIN pg_opclass opc ON am.oid = opc.opcmethod  
INNER JOIN pg_type typ ON typ.oid = opc.opcintype  
WHERE (opc.opcname LIKE '%geometry%' OR opc.opcname LIKE '%point%')  
AND (  
    opc.opcname NOT LIKE '%3d%' AND  
    opc.opcname NOT LIKE '%4d%' AND  
    opc.opcname NOT LIKE '%nd%'  
);   
```  
  
[view rawselect_geometry_operator_classes.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/fc87c4192c371f543a811691c6ea921c/raw/9b5f2795da225de9c4c490009379a49e0411ad28/select_geometry_operator_classes.sql)  
  
å› æ­¤ï¼Œæˆ‘ä»¬å°†è§‚å¯Ÿåˆ°è‡³å°‘äº”ç§è®¿é—®æ–¹æ³•ï¼ŒåŒ…æ‹¬ btreeã€hashã€gistã€brin å’Œ spgistã€‚æˆ‘å»ºè®®é€šè¿‡ä¸ºæ¯ä¸ªæ–¹æ³•å’Œè¿ç®—ç¬¦ç±»åˆ›å»ºç´¢å¼•æ¥è¿›è¡Œè°ƒæŸ¥ã€‚åˆ›å»ºç´¢å¼•åï¼Œæˆ‘ä»¬å°†è¯„ä¼°æœ‰å…³ä¿„ç½—æ–¯å†›äº‹è®¾æ–½ç«ç¾çš„æŸ¥è¯¢æ€§èƒ½ï¼Œä»¥ç¡®å®šå“ªäº›æ–¹æ³•å¯¹æˆ‘ä»¬çš„ä»»åŠ¡æœ€æœ‰æ•ˆã€‚  
  
ç´¢å¼•ç±»å‹	|ç´¢å¼•è¿ç®—ç¬¦ops	|è¿‡æ»¤è¿ç®—ç¬¦	|ç´¢å¼•åˆ›å»ºæ—¶é—´	|ç´¢å¼•å¤§å°	|æŸ¥è¯¢æ‰§è¡Œæ—¶é—´	|ç®€è¦è¯´æ˜  
---|---|---|---|---|---|---  
btree	|btree_geometry_ops	|æ²¡æœ‰ç›¸åº”çš„è¿ç®—ç¬¦ - æ­¤æŸ¥è¯¢å°†å¿½ç•¥ç´¢å¼•ã€‚	|1 ç§’ 918 æ¯«ç§’	|81MB	|53 åˆ† 45 ç§’ï¼ˆ129 è¡Œå—å½±å“ï¼‰	|æ”¯æŒç›¸ç­‰å’ŒèŒƒå›´æŸ¥è¯¢ï¼›å¿«é€Ÿä¸”æœ‰ç»„ç»‡åœ°æ£€ç´¢æ•°æ®ã€‚  
hash	|hash_geometry_ops|	æ²¡æœ‰ç›¸åº”çš„è¿ç®—ç¬¦ - æ­¤æŸ¥è¯¢å°†å¿½ç•¥ç´¢å¼•ã€‚	|3 ç§’ 158 æ¯«ç§’	|59MB	|53 åˆ† 15 ç§’ï¼ˆ129 è¡Œå—å½±å“ï¼‰	|å¿«é€Ÿç­‰å¼æœç´¢ï¼›ä¸é€‚åˆæ’åºæˆ–èŒƒå›´æŸ¥è¯¢ã€‚  
brin	|brin_geometry_inclusion_ops_2d|	@ï¼ˆgeometry, geometryï¼‰	|536 æ¯«ç§’	|0.032MB	|28 åˆ† 3 ç§’ï¼ˆ129 è¡Œå—å½±å“ï¼‰	|å¯¹äºå…·æœ‰è‡ªç„¶æ’åºæ•°æ®çš„å¤§å‹æ•°æ®é›†æœ‰æ•ˆï¼›ç´¢å¼•å—èŒƒå›´è€Œä¸æ˜¯å•ä¸ªè¡Œã€‚  
gist	| gist_geometry_ops_2d	|@(geometry,geometry)	|11 ç§’ 659 æ¯«ç§’	|94MB	|493 æ¯«ç§’ï¼ˆ129 è¡Œå—å½±å“ï¼‰	|æ”¯æŒå¹¿æ³›çš„æŸ¥è¯¢ï¼ŒåŒ…æ‹¬é‡å å’Œé‚»è¿‘çš„ç©ºé—´æœç´¢ã€‚  
spgist	|spgist_geometry_ops_2d	|@(geometry,geometry)	|6 ç§’ 290 æ¯«ç§’	|78MB	|353 æ¯«ç§’ï¼ˆ129 è¡Œå—å½±å“ï¼‰	|é€‚ç”¨äºåˆ†å¸ƒä¸å‡åŒ€çš„æ•°æ®ï¼›æ”¯æŒå¤šç§åˆ†è£‚æ ‘ç»“æ„ã€‚  
gist	|point_ops	|`<@(point,polygon)`	|1 ç§’ 426 æ¯«ç§’	|81MB	|306æ¯«ç§’ï¼ˆè¿”å›132æ¡è®°å½•ï¼‰	|éå¸¸é€‚åˆç‚¹æ•°æ®ï¼›æ”¯æŒç©ºé—´å…³ç³»æŸ¥è¯¢ï¼Œä¾‹å¦‚åŒ…å«ã€äº¤é›†ç­‰ã€‚  
spgist	|quad_point_ops	|`<@(point,box)`|	4 ç§’ 849 æ¯«ç§’	|77MB	|243 æ¯«ç§’ï¼ˆ173 è¡Œå—å½±å“ï¼‰	|åˆ©ç”¨å››å‰æ ‘æ¥ç´¢å¼•ç‚¹æ•°æ®ï¼›åœ¨ç©ºé—´åˆ†æçš„ç‰¹å®šåœºæ™¯ä¸­æœ‰æ•ˆã€‚  
spgist	|kd_point_ops	|`<@(point,box)`|	5 ç§’ 204 æ¯«ç§’	|93MB	|199 æ¯«ç§’ï¼ˆ173 è¡Œå—å½±å“ï¼‰	|é‡‡ç”¨ kd æ ‘æ¥å¤„ç†å¤šç»´ç‚¹æ•°æ®ï¼›éå¸¸é€‚åˆå¯»æ‰¾æœ€è¿‘çš„é‚»å±…ã€‚  
  
æ³¨æ„ï¼šæ‰€æåˆ°çš„è¿ç®—ç¬¦ç±»ä¸ä½¿ç”¨å‡ ä½•æ•°æ®ç±»å‹è¿›è¡Œæœç´¢ï¼›å®ƒä»¬ä½¿ç”¨ `<@(point,polygon)` å’Œ `<@(point,box)` ã€‚å› æ­¤ï¼Œè¡Œè®¡æ•°å¯èƒ½ä¸è¾“å‡ºä¸åŒ¹é…ï¼ˆä¾‹å¦‚ï¼Œå¤æ‚çš„åœ°ç†å¤šè¾¹å½¢å¯èƒ½å·²ç®€åŒ–ä¸ºçŸ©å½¢ï¼‰ã€‚  
  
ç»“æœè¡¨æ˜¾ç¤ºï¼Œå¯¹æˆ‘ä»¬çš„ä»»åŠ¡æœ€æœ‰æ•ˆçš„ç´¢å¼•æ˜¯ [GiST](https://www.postgresql.org/docs/current/gist.html) å’Œ [SP-GiST](https://www.postgresql.org/docs/current/spgist.html) ã€‚è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¸€ä¸‹å®ƒä»¬æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚    
  
## GiST çš„å·¥ä½œåŸç†  
PostgreSQL ä¸­çš„å¹¿ä¹‰æœç´¢æ ‘ (GiST) ç´¢å¼•ä½¿ç”¨å¹³è¡¡æ ‘çš„æ¦‚å¿µï¼Œå¯ä»¥è·¨ä¸åŒæ•°æ®ç±»å‹è¿›è¡Œé«˜æ•ˆæ’åºå’Œæœç´¢ã€‚å®ƒä»¬æä¾›äº†å¼€å‘ç”¨äºç´¢å¼•çš„è‡ªå®šä¹‰è¿ç®—ç¬¦çš„èƒ½åŠ›ï¼Œä½¿å¾— GiST éå¸¸é€šç”¨å¹¶ä¸”èƒ½å¤Ÿé€‚åº”ç‰¹å®šçš„è¦æ±‚ã€‚  
  
![pic](20240314_05_pic_006.png)  
  
*PostgreSQLä¸­GiSTç´¢å¼•çš„å±‚æ¬¡ç»“æ„[1]*  
  
åœ¨æ‰€æè¿°çš„ GiST æ ‘çš„ç¤ºä¾‹ä¸­ï¼šåœ¨é¡¶å±‚ï¼Œæœ‰ R1å’ŒR2ï¼Œç”¨ä½œå…¶ä»–å…ƒç´ çš„è¾¹ç•Œæ¡†ã€‚R1 åŒ…å«R3ã€R4å’ŒR5ï¼Œè€ŒR3åˆåŒ…å« R8ã€R9å’ŒR10ã€‚GiST ç´¢å¼•å…·æœ‰åˆ†å±‚ç»“æ„ï¼Œå¯ä»¥æ˜¾ç€åŠ å¿«æœç´¢é€Ÿåº¦ã€‚ä¸ B æ ‘ä¸åŒï¼ŒGiST æ”¯æŒé‡å æ“ä½œå’Œç©ºé—´å…³ç³»ç¡®å®šã€‚è¿™å°±æ˜¯ GiST éå¸¸é€‚åˆç´¢å¼•å‡ ä½•æ•°æ®çš„åŸå› ã€‚  
  
## SP-GiST çš„å·¥ä½œåŸç†  
PostgreSQL ä¸­çš„ç©ºé—´åˆ†åŒºå¹¿ä¹‰æœç´¢æ ‘ (SP-GiST) ç´¢å¼•ä¸“ä¸ºå°†ç©ºé—´åˆ†åŒºä¸ºéé‡å åŒºåŸŸçš„æ•°æ®ç»“æ„è€Œè®¾è®¡ï¼Œä¾‹å¦‚è±¡é™æ ‘æˆ–å‰ç¼€æ ‘ã€‚å®ƒä»¬èƒ½å¤Ÿå°†æ•°æ®é€’å½’åˆ’åˆ†ä¸ºå­é›†ï¼Œå½¢æˆä¸å¹³è¡¡çš„æ ‘ã€‚è¿™ä½¿å¾— SP-GiST ç´¢å¼•å¯¹äºå†…å­˜ä½¿ç”¨ç‰¹åˆ«æœ‰æ•ˆï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹ä¸­çš„çº§åˆ«è¾ƒå°‘ä¸”æ•°æ®ç»„è¾ƒå°ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥å¿«é€Ÿå¤„ç†æŸ¥è¯¢ã€‚  
  
ç„¶è€Œï¼ŒSP-GiST ç´¢å¼•åœ¨å­˜å‚¨åœ¨ç£ç›˜ä¸Šæ—¶å­˜åœ¨ç¼ºç‚¹ï¼Œå› ä¸ºå…¶è¿è¡Œéœ€è¦å¤§é‡ç£ç›˜æ“ä½œï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹æ•°æ®åº“ä¸­ã€‚  
  
è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼ŒGiST ç´¢å¼•é€šå¸¸æˆä¸ºæ›´å¥½çš„é€‰æ‹©ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤šè¾¹å½¢å’Œå¤æ‚ç©ºé—´ç»“æ„æ—¶ã€‚  
  
## å¯»æ‰¾æœ€è¿‘çš„é‚»å±…ï¼šShahed ç”Ÿäº§å‚é™„è¿‘å‘ç”Ÿäº† 10 èµ·ç«ç¾  
ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ PostgreSQL æ¥è§£å†³æŸ¥æ‰¾æœ€è¿‘é‚»å±…çš„ä»»åŠ¡ã€‚ä½¿ç”¨æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å°†å°è¯•è¯†åˆ«åœ¨ä¿„ç½—æ–¯åˆ¶é€ ä¼Šæœ— Shahed æ— äººæœºçš„å·¥å‚é™„è¿‘å‘ç”Ÿçš„åèµ·ç«ç¾ã€‚æœ‰å…³è¯¥æ¤ç‰©çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥å‚è€ƒ Molfar å›¢é˜Ÿè¿›è¡Œçš„[ç ”ç©¶](https://molfar.com/blog/alabuga-deanon)ã€‚è¯¥å·¥å‚ä½äºé‘é¼æ–¯å¦å…±å’Œå›½[é˜¿æ‹‰å¸ƒåŠ ](https://en.wikipedia.org/wiki/Alabuga_Special_Economic_Zone)ç»æµç‰¹åŒº ï¼Œè¿™é‡Œä»¥å‰ç”Ÿäº§çŒ«ç²®å’Œæ±½è½¦ç»ç’ƒï¼Œè¿˜ç§æ¤è˜‘è‡ã€‚ç„¶è€Œï¼Œåœ¨å¯¹ä¿„ç½—æ–¯å®æ–½åˆ¶è£ä¹‹åï¼Œå…¶ä¼˜å…ˆäº‹é¡¹å‘ç”Ÿäº†è½¬å˜ï¼Œç°åœ¨å®ƒåœ¨ä¿„ç½—æ–¯çš„æ— äººæœºç”Ÿäº§è®¡åˆ’ä¸­å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚  
  
è§£å†³æ­¤ä»»åŠ¡çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä»¥å›´ç»•æ‰€é€‰ç›®æ ‡çš„åœ†åœˆå½¢å¼åˆ›å»ºç¼“å†²åŒºã€‚è¯¥ç¼“å†²åŒºè¢«é€’å½’æ‰©å±•ï¼Œç›´åˆ°è·å¾—æ‰€éœ€æ•°é‡çš„ç»“æœã€‚åœ¨ PostgreSQL ä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹ SQL æŸ¥è¯¢æ¥å®ç°ï¼Œè¯¥æŸ¥è¯¢å½¢æˆç¼“å†²åŒºå¹¶è¯†åˆ«åœ¨é€‰å®šå¯¹è±¡çš„æŒ‡å®šåŠå¾„å†…å‘ç”Ÿçš„ç«ç¾ï¼š  
```  
SELECT *  
FROM public.viirs_fire_events  
WHERE ST_DWithin(  
    geom,   
    ST_SetSRID(ST_MakePoint(52.048470, 55.821688), 4326)::geography,   
    10000 -- can be changed to 1000, 5000, 10000, ...  
)  
LIMIT 10;  
   
--  
Successfully run. Total query runtime: 1 secs 157 ms.  
10 rows affected.   
```  
  
[view rawselect_viirs_events_near_point.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/44b4f72ebbf45f8e3babd82ef2f04e14/raw/cfe3a744c094d1bf4d490bb82c1dfdcee135f40a/select_viirs_events_near_point.sql)  
  
è¿™ç§æ–¹æ³•æ¶‰åŠé€æ¸æ‰©å¤§ç¼“å†²åŒºå¹¶åˆ†æç»“æœï¼Œè¿™å¯èƒ½éå¸¸è€—æ—¶ã€‚  
  
![pic](20240314_05_pic_007.png)  
  
*é‘é¼æ–¯å¦çš„ä¸€å®¶å·¥å‚ç”Ÿäº§çš„ Shaheds å…·æœ‰ 1.5 å…¬é‡Œå’Œ 10 å…¬é‡ŒåŠå¾„å†…çš„ç«ç„°å¯è§†åŒ–åŠŸèƒ½*  
  
GiST ç´¢å¼•æ”¯æŒçš„å„ç§è¿ç®—ç¬¦å¯ç”¨äºä¼˜åŒ–åœ°ç†ç©ºé—´æŸ¥è¯¢ã€‚è¦æ£€ç´¢ä¸ GiST ç´¢å¼•ä¸€èµ·ä½¿ç”¨çš„å¯ç”¨è¿ç®—ç¬¦åˆ—è¡¨ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œ SQL æŸ¥è¯¢æ¥æ‰«æ PostgreSQL ç³»ç»Ÿè¡¨å¹¶æä¾›æœ‰å…³ä¸ gist_geometry_ops_2d è¿ç®—ç¬¦ç±»å…³è”çš„è¿ç®—ç¬¦çš„ä¿¡æ¯ã€‚è¿™å°†æœ‰åŠ©äºç¡®å®šåœ¨æ•°æ®åº“ä¸­æ‰§è¡Œç‰¹å®šåœ°ç†ç©ºé—´æ“ä½œçš„æœ€æœ‰æ•ˆçš„æ“ä½œå‘˜ã€‚  
```  
SELECT  
    amopopr::regoperator,   
    oprcode::regproc,   
    obj_description(opr.oid, 'pg_operator') description  
FROM pg_am am  
INNER JOIN pg_opclass opc ON opcmethod = am.oid  
INNER JOIN pg_amop amop ON amopfamily = opcfamily  
INNER JOIN pg_operator opr ON opr.oid = amopopr  
WHERE amname = 'gist'  
    AND opcname = 'gist_geometry_ops_2d'  
ORDER BY amopstrategy;  
   
--  
 amopopr                |    oprcode            | description  
------------------------+-----------------------+-----------------------------------  
 <<(geometry,geometry)  | geometry_left         | Determines if one geometry is left of another  
 &<(geometry,geometry)  | geometry_overleft     | Checks if one geometry overlaps the left of another  
 &&(geometry,geometry)  | geometry_overlaps     | Checks if two geometries overlap  
 &>(geometry,geometry)  | geometry_overright    | Determines if one geometry overlaps the right of another  
 >>(geometry,geometry)  | geometry_right        | Determines if one geometry is right of another  
 ~=(geometry,geometry)  | geometry_same         | Checks if two geometries are the same  
 ~(geometry,geometry)   | geometry_contains     | Determines if one geometry contains another  
 @(geometry,geometry)   | geometry_within       | Determines if one geometry is within another  
 &<|(geometry,geometry) | geometry_overbelow    | Determines if one geometry overlaps below another  
 <<|(geometry,geometry) | geometry_below        | Determines if one geometry is below another  
 |>>(geometry,geometry) | geometry_above        | Determines if one geometry is above another  
 |&>(geometry,geometry) | geometry_overabove    | Determines if one geometry overlaps above another  
 <->(geometry,geometry) | geometry_distance_centroid | Calculates centroid distance between geometries  
 <#>(geometry,geometry) | geometry_distance_box | Calculates box distance between geometries   
```  
  
[view rawselect_gist_geometry_operators.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/99d7f600c728f184d412d77ce8028fb4/raw/0d0d978943a027275e567f0ce6961f3fb9899965/select_gist_geometry_operators.sql)  
  
æˆ‘ä»¬çš„ GiST ç´¢å¼•æä¾›äº†å¤„ç†åœ°ç†æ•°æ®çš„å¹¿æ³›åŠŸèƒ½ï¼Œä½¿æ‚¨å¯ä»¥ç¡®å®šå¯¹è±¡çš„ç©ºé—´ä½ç½®å¹¶æµ‹é‡è·ç¦»ã€‚`<->` è¿ç®—ç¬¦å…è®¸æŒ‰ä¸æŒ‡å®šç‚¹çš„æ¥è¿‘ç¨‹åº¦å¯¹å¯¹è±¡è¿›è¡Œæ’åºã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ­¤è¿ç®—ç¬¦æ¥è¯†åˆ«è·ç¦»æŒ‡å®šä½ç½®æœ€è¿‘çš„åå¤„ç«ç¾ã€‚  
```  
SELECT *  
FROM public.viirs_fire_events  
ORDER BY geom <-> ST_SetSRID(ST_MakePoint(52.048470, 55.821688), 4326)  
LIMIT 10;  
   
--  
Successfully run. Total query runtime: 78 ms.  
10 rows affected.   
```  
  
[view rawselect_nearest_viirs_events.sql hosted with â¤ by GitHub](https://gist.github.com/kloba/b3ac9dab240ca834cf20b61016f0da3e/raw/845379a0e50c5aafbe95f034d30a55ce614c6449/select_nearest_viirs_events.sql)  
  
ä¸ä¹‹å‰çš„æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æŸ¥è¯¢é€Ÿåº¦æ˜¾ç€åŠ å¿«ï¼Œå¿«äº† 15 å€ï¼Œå¹¶ä¸”æ²¡æœ‰ä½¿ç”¨æ›´æ”¹çš„åŠå¾„é‡å¤æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥åˆ†ææŸ¥è¯¢è®¡åˆ’æ¥ç¡®è®¤é€Ÿåº¦ç”±äºä½¿ç”¨ç´¢å¼•å’Œè¿ç®—ç¬¦è€Œæé«˜ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½ç¡®ä¿ç´¢å¼•ç¡®å®å‚ä¸å…¶ä¸­ï¼Œè¿™æ˜¯æé«˜ç”Ÿäº§åŠ›çš„å…³é”®ã€‚  
```  
EXPLAIN ANALYZE  
SELECT *  
FROM public.viirs_fire_events  
ORDER BY geom <-> ST_SetSRID(ST_MakePoint(52.048470, 55.821688), 4326)  
LIMIT 10;  
   
--  
QUERY PLAN  
Limit  (cost=0.41..14.22 rows=10 width=143) (actual time=0.230..0.254 rows=10 loops=1)  
  ->  Index Scan using idx_viirs_fire_events_geom_gist on viirs_fire_events  (cost=0.41..2363046.98rows=1711475 width=143) (actual time=0.229..0.252 rows=10 loops=1)  
        Order By: (geom <-> '0101000020E6100000276BD44334064A4001C287122DE94B40'::geometry)  
Planning Time: 0.105 ms  
Execution Time: 0.283 ms   
```  
  
[view rawnearest_viirs_events_query_plan.txt hosted with â¤ by GitHub](https://gist.github.com/kloba/f6be940d206e4a453ce58f572f0559f3/raw/cc3ebbe747a4c0bc5bd19daee454fffa42c8c806/nearest_viirs_events_query_plan.txt)  
  
æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œç´¢å¼•ä¸ GiST ç±»ä¼¼ï¼Œå°†åˆ†æåŠŸèƒ½æ‰©å±•åˆ°ç®€å•æ¯”è¾ƒä¹‹å¤–ï¼Œä»è€Œèƒ½å¤Ÿè§£å†³æ›´å¤æ‚çš„ä»»åŠ¡ã€‚æ­£å¦‚æœ¬æ–‡æ‰€æ¼”ç¤ºçš„ï¼Œå¼€æ”¾æ•°æ®å¯ä»¥æœ‰æ•ˆåœ°ç”¨äºå¿«é€Ÿè¯„ä¼°å’Œå®šä¹‰å…¨çƒèŒƒå›´å†…çš„ç›®æ ‡ï¼ŒåŒ…æ‹¬è¯„ä¼°ç›®æ ‡å½±å“çš„æˆåŠŸç¨‹åº¦ã€‚  
  
## Uber çš„ H3ï¼šåœ°ç†ç©ºé—´åˆ†æå’Œæ•°æ®èšåˆçš„è§†è§’  
H3ç”±Uberå¼€å‘ï¼Œæ˜¯ä¸€ä¸ªå…­è¾¹å½¢ç½‘æ ¼ç³»ç»Ÿï¼Œæ—¨åœ¨ä¿ƒè¿›åœ°ç†ç©ºé—´æ•°æ®çµæ´»é«˜æ•ˆçš„åˆ†å‘ã€‚H3 ä¼¼ä¹æœ‰æ½œåŠ›æˆä¸ºä¹Œå…‹å…°æ­¦è£…éƒ¨é˜Ÿå¤„ç†åœ°ç†æ•°æ®çš„é€šç”¨æ ‡å‡†ã€‚è®©æˆ‘ä»¬æ¢è®¨å¦‚ä½•ä½¿ç”¨è¯¥å·¥å…·è¿›è¡Œæ•°æ®èšåˆå’Œè§£å†³å¤æ‚çš„åœ°ç†åˆ†æä»»åŠ¡ã€‚  
  
![pic](20240314_05_pic_008.png)  
  
Uber H3 å…­è¾¹å½¢ç½‘æ ¼å›¾è§£  
  
æ­£å¦‚æ‚¨åœ¨å›¾åƒä¸­æ‰€çœ‹åˆ°çš„ï¼Œæ¯ä¸ªå…­è¾¹å½¢éƒ½æ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„åœ°ç†å•å…ƒï¼Œå°†å¤æ‚çš„åœ°ç†å½¢çŠ¶ç®€åŒ–ä¸ºç»Ÿä¸€çš„ç‰‡æ®µã€‚  
  
ç­‰çº§	|å¯¹è±¡æ€»æ•°	|å…­è¾¹å½¢æ•°é‡|	äº”è¾¹å½¢æ•°é‡  
---|---|---|---  
0	| 122	|110	|12  
1	| 842	|830	|12  
2	| 5,882	|5,870	|12  
3	| 41,162	|41,150|12  
4	| 288,122	|288,110|	12  
5	| 2,016,842|	2,016,830|	12  
6	| 14,117,882	|14,117,870|	12  
7	| 98,825,162	|98,825,150	|12  
8	| 691,776,122	|691,776,110	|12  
9	| 4,842,432,842	|4,842,432,830	|12  
10	| 33,897,029,882	|33,897,029,870	|12  
11	| 237,279,209,162	|237,279,209,150	|12  
12	| 1,660,954,464,122	|1,660,954,464,110	|12  
13	| 11,626,681,248,842	|11,626,681,248,830	|12  
14	| 81,386,768,741,882	|81,386,768,741,870	|12  
15	| 569,707,381,193,162	|569,707,381,193,150	|12  
  
è¿™æ˜¯ä¸€ä¸ªç”± 15 ä¸ªçº§åˆ«ç»„æˆçš„åˆ†å±‚ç³»ç»Ÿï¼Œå°†åœ°çƒè¡¨é¢åˆ’åˆ†ä¸ºå…­è¾¹å½¢ã€‚é›¶å±‚åˆ†ä¸º122ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­12ä¸ªæ˜¯äº”è¾¹å½¢ï¼Œä»¥å‡†ç¡®è¡¨ç¤ºåœ°çƒçš„çƒå½¢ã€‚æˆ‘ä»¬æ‹¥æœ‰å¤§çº¦ 569 ä¸‡äº¿ä¸ªæœ€ç²¾ç»†çš„å…­è¾¹å½¢ï¼Œæ¯ä¸ªå…­è¾¹å½¢ä»£è¡¨ä¸€ä¸ªç‹¬ç‰¹çš„åœ°ç†ç©ºé—´å¯¹è±¡ã€‚ä¸‹é¢çš„è§†é¢‘æ¼”ç¤ºäº†è¿™åœ¨å®è·µä¸­æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚ [https://youtu.be/RbeYPqsFGPI](https://youtu.be/RbeYPqsFGPI)  
  
PostgreSQL å¯ä»¥é€šè¿‡é™„åŠ æ‰©å±•é›†æˆ H3 åŠŸèƒ½ã€‚è¦å®‰è£…æ­¤æ‰©å±•ï¼Œè¯·ä½¿ç”¨CREATE EXTENSION h3ï¼› å‘½ä»¤ï¼Œå¹¶ä¸”å¯ä»¥åœ¨äº‘è®¡ç®—æœåŠ¡ä¸Šä½¿ç”¨ï¼ŒåŒ…æ‹¬ AWS RDSï¼ˆæˆ‘æ„Ÿè°¢ AWS å¯¹ä¹Œå…‹å…°çš„æ”¯æŒï¼‰ã€‚å®‰è£…æ­¤æ‰©å±•åï¼Œå³å¯ä½¿ç”¨æ–°åŠŸèƒ½ã€‚è®©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹é‚£äº›å¯èƒ½å¯¹åˆå­¦è€…æœ‰ç”¨çš„åŠŸèƒ½ï¼š  
  
åŠŸèƒ½	|è¾“å…¥æ•°æ®|	è¾“å‡ºæ•°æ®	|æè¿°  
---|---|---|---  
h3_lat_lng_to_cell	|çº¬åº¦ï¼šFLOATï¼Œç»åº¦ï¼šFLOATï¼Œåˆ†è¾¨ç‡ï¼šINT	|H3 indexï¼šBIGINT	|å°†çº¬åº¦å’Œç»åº¦åæ ‡è½¬æ¢ä¸ºæŒ‡å®šåˆ†è¾¨ç‡çº§åˆ«çš„ H3 ç´¢å¼•ã€‚  
h3_cell_to_boundary	|H3 indexï¼šBIGINT	|è¾¹ç•Œåæ ‡æ•°ç»„ï¼šGEOMETRY(POLYGON, 4326)	|å°† H3 ç´¢å¼•è½¬æ¢ä¸ºè¡¨ç¤ºå…­è¾¹å½¢è¾¹ç•Œçš„å‡ ä½•å¤šè¾¹å½¢ã€‚  
h3_get_resolution	|H3 indexï¼šBIGINT	|åˆ†è¾¨ç‡çº§åˆ«ï¼šINT	|è¿”å›ç»™å®š H3 ç´¢å¼•çš„åˆ†è¾¨ç‡çº§åˆ«ã€‚  
h3_cell_to_parent	|H3 indexï¼šBIGINTï¼Œæ‰€éœ€åˆ†è¾¨ç‡ï¼šINT	|çˆ¶H3ç´¢å¼•ï¼šBIGINT	|å°† H3 ç´¢å¼•è½¬æ¢ä¸ºå…¶æ›´é«˜å±‚æ¬¡ç»“æ„çº§åˆ«çš„çˆ¶ç´¢å¼•ã€‚  
h3_cell_to_children	|H3 indexï¼šBIGINTï¼Œæ‰€éœ€åˆ†è¾¨ç‡ï¼šINT	|å­ H3 ç´¢å¼•æ•°ç»„ï¼šSETOF BIGINT	|å°† H3 ç´¢å¼•è½¬æ¢ä¸ºè¾ƒä½å±‚æ¬¡ç»“æ„çº§åˆ«çš„å­ç´¢å¼•æ•°ç»„ã€‚  
h3_polygon_to_cells	|å‡ ä½•å½¢çŠ¶ï¼šGEOMETRYï¼Œåˆ†è¾¨ç‡ï¼šINT	|H3 ç´¢å¼•æ•°ç»„ï¼šSETOF BIGINT	|å°†å¤šè¾¹å½¢è½¬æ¢ä¸ºå®Œå…¨æˆ–éƒ¨åˆ†è¦†ç›–å¤šè¾¹å½¢çš„ä¸€ç»„ H3 ç´¢å¼•ã€‚  
h3_grid_disk	|H3 indexï¼šBIGINTï¼ŒèŒƒå›´ï¼šINT	|H3 ç´¢å¼•æ•°ç»„ï¼šSETOF BIGINT	|ç”Ÿæˆä¸€ä¸ª H3 ç´¢å¼•æ•°ç»„ï¼Œè¡¨ç¤ºå›´ç»•ä¸­å¿ƒ H3 ç´¢å¼•çš„å…­è¾¹å½¢ç½‘æ ¼ï¼Œå½¢æˆä¸€ä¸ªå®šä¹‰åŠå¾„çš„â€œåœ†ç›˜â€ã€‚  
h3_compact_cells	|Array of H3 indexesï¼šSETOF BIGINT	|ç´§å‡‘ H3 ç´¢å¼•æ•°ç»„ï¼šSETOF BIGINT	|åˆå¹¶ H3 ç´¢å¼•æ•°ç»„ï¼Œå‡å°‘è¦†ç›–åŒä¸€åŒºåŸŸçš„ç´¢å¼•æ•°é‡ã€‚  
  
ä¸ºäº†æœ‰æ•ˆåœ°è§£å†³ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰å¤šè¾¹å½¢è½¬æ¢ä¸ºæŒ‡å®šçº§åˆ«çš„ H3 ç´¢å¼•ï¼ˆå…­è¾¹å½¢ï¼‰æ•°ç»„ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†ç«ç¾çš„è´¨å¿ƒè½¬æ¢ä¸º H3 ç´¢å¼•æ¥å¤„ç†å®ƒä»¬ã€‚é€šè¿‡è·å–è¿™äº› H3 ç´¢å¼•çš„ BIGINT æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨æ ‡å‡†çš„ B æ ‘ç´¢å¼•ï¼Œè¿™åœ¨æ‰§è¡Œç›¸ç­‰æ¯”è¾ƒæ“ä½œæ—¶ç‰¹åˆ«æœ‰æ•ˆã€‚è¿™å°†æ˜¾ç€æé«˜å¤æ‚åœ°ç†åˆ†æä»»åŠ¡ä¸­çš„æŸ¥è¯¢æ‰§è¡Œé€Ÿåº¦ï¼Œç¡®ä¿å¿«é€Ÿã€å‡†ç¡®çš„ç»“æœã€‚  
  
è®©æˆ‘ä»¬æ£€æŸ¥ä¸€äº›ç®€å•çš„ H3 å‡½æ•°ï¼Œè¿™å°†æœ‰åŠ©äºæ›´å¥½åœ°ç†è§£å…¶åœ¨å®è·µä¸­çš„å·¥ä½œåŸç†ï¼š  
  
![pic](20240314_05_pic_009.png)	| ![pic](20240314_05_pic_010.png) | ![pic](20240314_05_pic_011.png)    
---|---|---  
h3_polygon_to_cells(geom, 8) </br> è¯¥å‡½æ•°å°†å†›äº‹å¤šè¾¹å½¢çš„å‡ ä½•å½¢çŠ¶è½¬æ¢ä¸ºä¸€ç»„ç¬¬å…«çº§åˆ†è¾¨ç‡çš„H3ç´¢å¼•ï¼Œæœ‰æ•ˆåœ°å°†å¤šè¾¹å½¢åˆ’åˆ†ä¸ºå…­è¾¹å½¢ï¼Œæ¯ä¸ªå…­è¾¹å½¢çš„é¢ç§¯ä¸º0.737327598å¹³æ–¹å…¬é‡Œï¼Œä»è€Œå¯ä»¥è¿›è¡Œè¯¦ç»†çš„ç©ºé—´åˆ†æã€‚	| h3_grid_disk(h3_polygon_to_cells(geom, 8), 1) </br> å¦‚æœåº”ç”¨ h3_polygon_to_cells åå¤šè¾¹å½¢çš„æŸäº›åŒºåŸŸä»æœªè¢«è¦†ç›–ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ h3_grid_disk åˆ›å»ºé¢å¤–çš„ H3 ç´¢å¼•ç¯ã€‚å®ƒå°†é€šè¿‡åœ¨ç°æœ‰ç´¢å¼•å‘¨å›´æ·»åŠ å…­è¾¹å½¢æ¥æ‰©å¤§è¦†ç›–èŒƒå›´ï¼Œç¡®ä¿å®Œå…¨è¦†ç›–å®šä¹‰çš„åœ°ç†å¤šè¾¹å½¢ã€‚	| h3_polygon_to_cells(geom, 9) </br> ä½¿ç”¨çº§åˆ«ä¸º 9 çš„h3_polygon_to_cellså‡½æ•°å°†ç½‘æ ¼åˆ†è¾¨ç‡æé«˜åˆ°æ›´ç²¾ç»†çš„æ¯”ä¾‹ï¼Œå…¶ä¸­æ¯ä¸ªå…­è¾¹å½¢ä»£è¡¨ 0.105332513 å¹³æ–¹å…¬é‡Œçš„é¢ç§¯ã€‚è¿™æ ·å¯ä»¥æ›´å‡†ç¡®åœ°å†ç°åœ°ç†å¤šè¾¹å½¢çš„å‡ ä½•å½¢çŠ¶ï¼Œä»¥è¿›è¡Œè¯¦ç»†çš„ç©ºé—´åˆ†æã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¼šäº§ç”Ÿæ›´å¤šçš„å…­è¾¹å½¢ï¼Œè¿™å¯èƒ½ä¼šå¯¹æŸ¥è¯¢æ‰§è¡Œé€Ÿåº¦äº§ç”Ÿè´Ÿé¢å½±å“ã€‚  
  
åœ¨æ¬§æ´²æœ€å¤§çš„ PostgreSQL ä¼šè®® PGConf.2023 ä¸Šçš„æ¼”è®²ä¸­ï¼Œæˆ‘æœ‰æœºä¼šå±•ç¤ºäº†ä¸€ç³»åˆ—æ›´å¤æ‚çš„æŒ‘æˆ˜ï¼Œè¿™äº›æŒ‘æˆ˜å¯ä»¥é€šè¿‡ä½¿ç”¨ H3 èšåˆåœ°ç†ç©ºé—´æ•°æ®æ¥è§£å†³ã€‚ä¸€ä¸ªä¾‹å­æ¶‰åŠæœç´¢ä½äºç¡®åˆ‡ä½ç½®å’Œæ—¶é—´çš„å…¶ä»–æ— äººæœºï¼Œä»¥åŠåˆ†æåœ¨ç‰¹å®šæ—¶æœŸå†…ä¸åŒåœ°ç‚¹è¯†åˆ«çš„ä¸€èµ·é£è¡Œçš„æ— äººæœºæ‰€é‡‡å–çš„è·¯çº¿ï¼ˆåŒä¼´åˆ†æï¼‰ã€‚åœ¨æœ¬æ–‡çš„åç»­å†…å®¹ä¸­ï¼Œæ‚¨å°†æœ‰æœºä¼šäº†è§£æœ‰å…³æ­¤ä¸»é¢˜çš„æ›´å¤šä¿¡æ¯ã€‚åŒæ—¶ï¼Œä½ å¯ä»¥æŸ¥çœ‹æˆ‘çš„ [æ¼”è®²ææ–™](https://klioba.com/public/presentations/PostGIS_Warfare_Export.pdf) ã€‚  
  
åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æå†›äº‹ç‰©ä½“ï¼Œå¹¶é€šè¿‡ä¸ H3 èšåˆï¼Œè®¡ç®—è¿™äº›ç‰©ä½“åœ¨ä¿„ç½—æ–¯çš„å¯†åº¦ã€‚è¯¥åˆ†æçš„å¯è§†åŒ–å¦‚ä¸‹æ‰€ç¤ºï¼š  
  
![pic](20240314_05_pic_012.png)  
  
*ä½¿ç”¨ H3 å…­è¾¹å½¢å¯è§†åŒ–ä¿„ç½—æ–¯å’Œæš‚æ—¶å é¢†çš„å…‹é‡Œç±³äºšè‡ªæ²»å…±å’Œå›½çš„å†›äº‹ç‰©ä½“å¯†åº¦*   
  
ä½¿ç”¨ H3 èšåˆåœ°ç†ç©ºé—´æ•°æ®å¯ä»¥æ˜¾ç€å¢å¼ºåˆ†æèƒ½åŠ›ï¼Œä»è€Œå¯ä»¥å¯¹å¤æ‚çš„ç©ºé—´å…³ç³»è¿›è¡Œæ›´æ·±åˆ»çš„è§£é‡Šå’Œå¯è§†åŒ–ã€‚  
    
## ç»“æŸè¯­  
æˆ‘åœ¨å‡†å¤‡æœ¬æ–‡æ—¶ä½¿ç”¨çš„å…¶ä»–èµ„æºï¼š  
- [æŒæ¡ PostgreSQL ä½œè€…ï¼šHans-JÃ¼rgen SchÃ¶nig](https://subscription.packtpub.com/book/data/9781800567498/3/ch03lvl1sec19/understanding-postgresql-index-types)  
- [uber H3ã€‚ä¸åŒåˆ†è¾¨ç‡çš„å•å…ƒç»Ÿè®¡è¡¨](https://h3geo.org/docs/core-library/restable/)  
- [H3-PG æ‰©å±•ã€‚APIå‚è€ƒ](https://github.com/zachasme/h3-pg/blob/main/docs/api.md)  
- [PostGIS æ–‡æ¡£](https://postgis.net/documentation/)  
- [PostGIS in Actionï¼Œç¬¬ä¸‰ç‰ˆï¼Œä½œè€…ï¼šLeo S. Hsu å’Œ Regina Obe](https://www.amazon.com/PostGIS-Action-Third-Leo-Hsu/dp/1617296694)  
     
  
#### [æœŸæœ› PostgreSQL|å¼€æºPolarDB å¢åŠ ä»€ä¹ˆåŠŸèƒ½?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB å¼€æºæ•°æ®åº“](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB å­¦ä¹ å›¾è°±](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [è´­ä¹°PolarDBäº‘æœåŠ¡æŠ˜æ‰£æ´»åŠ¨è¿›è¡Œä¸­, 55å…ƒèµ·](https://www.aliyun.com/activity/new/polardb-yunparter?userCode=bsb3t4al "e0495c413bedacabb75ff1e880be465a")
  
  
#### [PostgreSQL è§£å†³æ–¹æ¡ˆé›†åˆ](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [å¾·å“¥ / digoal's Github - å…¬ç›Šæ˜¯ä¸€è¾ˆå­çš„äº‹.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About å¾·å“¥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
