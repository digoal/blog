## ä»ETLåˆ°MTL, DuckDB flockMTLæ’ä»¶æŠŠå¤§æ¨¡å‹ç©å¾—å¾ˆæºœ  
          
### ä½œè€…          
digoal          
          
### æ—¥æœŸ          
2025-06-23          
          
### æ ‡ç­¾          
PostgreSQL , PolarDB , DuckDB , AI , LLM , ETL , MTL , flockMTL         
          
----          
          
## èƒŒæ™¯   
è™¹å¸æ•ˆåº”å¾ˆå¯æ€•, ä¸ç®¡æ˜¯åœ¨ç‰©ç†ä¸–ç•Œè¿˜æ˜¯è™šæ‹Ÿä¸–ç•Œ.  
  
çœä¼šåŸå¸‚è™¹å¸å‘¨è¾¹åŸå¸‚äººæ‰.  
  
å¤§å…¬å¸è™¹å¸å°å…¬å¸äººæ‰.  
  
çƒ­é—¨çš„èµ›é“ã€å¼€æºé¡¹ç›®å¸å¼•æ›´å¤šä¼˜è´¨äººæ‰çš„å‚ä¸, åŠ©åŠ›å…¶æ›´å¿«çš„å‘å±•.  
  
ä½ å¯ä»¥é—­é—¨é€ è½¦, ä½ ä¹Ÿå¯ä»¥å¤šçœ‹çœ‹çƒ­é—¨èµ›é“é‡Œçš„çƒ­é—¨é¡¹ç›®, å‘ä¼˜ç§€å­¦ä¹ .   
  
å‰æ®µæ—¶é—´å‘äº†ä¸€ç¯‡æ–‡ç« , è§‚å¯Ÿåˆ°DuckDBåœ¨æ”¯æŒrust/goçš„æ‰©å±•æ¥å£, æ„å‘³ç€æœªæ¥rust/goå·¥ç¨‹å¸ˆå°±å¯ä»¥å†™DuckDBæ‰©å±•æ’ä»¶, ç›¸å½“äºä¸ºDuckDBæä¾›æ›´å¤šå‘¨è¾¹åŠŸèƒ½å¼€äº†ä¸€ä¸ªç®¡é“, è¾“é€ä»£ç çš„æ˜¯c/c++/go/rustçš„å¼€å‘è€….  
- [ã€Šç¥è´ºDuckDBæ–©è·30K star, Roadmapæš´éœ²é‡å¿ƒ, ä¼°å€¼å¯èƒ½è¿‡ç™¾äº¿ã€‹](../202506/20250610_04.md)    
  
æœ‰æ®µæ—¶é—´æ²¡å…³æ³¨DuckDBçš„æ’ä»¶ç¤¾åŒºäº†, ä»Šå¤©ç®€å•çœ‹äº†ä¸€ä¸‹, å¤©ç¿»åœ°è¦†çš„å˜åŒ–å•Š, å¤šäº†å¥½å¤šæœ‰è¶£çš„æ’ä»¶. ç­‰rust/goæ”¯æŒå, ä¼°è®¡å‘å±•ä¼šæ›´å¿«. è¿™å°±æ˜¯è™¹å¸æ•ˆåº”çš„ä½“ç°.  
- https://duckdb.org/community_extensions/list_of_extensions  
  
## æ¥çœ‹å‡ ä¸ªæœ‰è¶£çš„æ’ä»¶  
è¿™äº›æ’ä»¶å¤§æ¦‚ç‡æ˜¯ç”¨æˆ·è´¡çŒ®çš„. ä¾‹å¦‚è¯»å–ç½‘ç»œæŠ“åŒ…è½¯ä»¶pcapæ–‡ä»¶ã€å®šæ—¶ä»»åŠ¡ã€è¯»å–clickhouseæ•°æ®æºã€åˆ†æè´¢ç»æ•°æ®ç­‰.   
  
æˆ‘ä»…æˆªå–äº†ä¸€äº›æ¯”è¾ƒæœ‰è¶£çš„æ’ä»¶, æŒ‰åŠŸèƒ½åšäº†ä¸€äº›åˆ†ç±»å¦‚ä¸‹.  
  
1ã€è¯»å–å…¶ä»–æ•°æ®æº  
  
æ’ä»¶ | æè¿°  
---|---  
bigquery 	|	Integrates DuckDB with Google BigQuery, allowing direct querying and management of BigQuery datasets  
chsql_native	|	ClickHouse Native Client & File Reader for chsql  
gsheets	|	Read and write Google Sheets using SQL  
msolap	|	Extension that allows DuckDB to connect to Microsoft SQL Server Analysis Services (SSAS) and other OLAP data sources using the MSOLAP provider  
nanodbc	|	Connect to any ODBC-compatible database and query data directly from DuckDB  
scrooge	|	Provides functionality for financial data-analysis, including data scanners for the Ethereum Blockchain and Yahoo Finance  
  
2ã€å…¼å®¹å…¶ä»–æ•°æ®åº“  
  
æ’ä»¶ | æè¿°  
---|---  
redis	|	Redis compatible Client for DuckDB  
  
3ã€æ•´åˆå¤§æ¨¡å‹  
  
æ’ä»¶ | æè¿°  
---|---  
flockmtl	|	LLM & RAG extension to combine analytics and semantic analysis  
open_prompt	|  Interact with LLMs with a simple DuckDB Extension  
quackformers	|	Bert-based embedding extension.  
  
4ã€å¤šæ¨¡æ€æ”¯æŒ  
  
æ’ä»¶ | æè¿°  
---|---  
geography	|	Global spatial data processing on the sphere  
h3	|	Hierarchical hexagonal indexing for geospatial data  
duckpgq	|	Extension that adds support for SQL/PGQ and graph algorithms  
datasketches|		By utilizing the Apache DataSketches library this extension can efficiently compute approximate distinct item counts and estimations of quantiles, while allowing the sketches to be serialized.  
pcap_reader	|	Read PCAP files from DuckDB  
wireduck	|	Read and dissect PCAP files from DuckDB  
pbix	|	Extension that allows parsing the data model embedded in PowerBI (pbix) files  
  
5ã€å…¶ä»–åŠŸèƒ½  
  
æ’ä»¶ | æè¿°  
---|---  
cronjob	|	DuckDB HTTP Cronjob Extension  
  
  
## flockmtl : ETL -> MTL  
ä¹‹å‰DuckDBå¯ä»¥ä½¿ç”¨httpæ’ä»¶è°ƒç”¨æ¨¡å‹. ç”¨æ³•è§: [ã€Šå¦‚ä½•åœ¨DuckDBä¸­è°ƒç”¨openAI/ollama APIæ¥å£?ã€‹](../202502/20250221_06.md)     
  
ç°åœ¨æ›´ç®€å•äº†.    
  
flockmtl è¿™ä¸ªæ’ä»¶æœ‰ç‚¹æ„æ€, æˆ‘ä»¬éƒ½çŸ¥é“ETL çš„æ„æ€æ˜¯ Eï¼ˆExtractï¼‰ã€Tï¼ˆTransformï¼‰ã€Lï¼ˆLoadï¼‰  
  
MTL æ˜¾ç„¶æ˜¯æŠŠEæ¢æˆäº†M, ä¹Ÿå°±æ˜¯è®©æ¨¡å‹æ¥åšæ•°æ®æŠ½å–.  
  
Tå’ŒLå‘¢, éƒ½äº¤ç»™DuckDB. ç»“åˆèµ·æ¥å°±æ˜¯MTL.  
  
ä¹Ÿè®¸æœªæ¥TLéƒ½è®©æ¨¡å‹å¹²äº†.  
  
ä¸‹é¢ç®€å•ä½“éªŒä¸€ä¸‹flockmtlæ’ä»¶.  
  
**FlockMTL æ˜¯ä»€ä¹ˆï¼Ÿ**  
  
FlockMTL æ˜¯ DuckDB çš„ä¸€ä¸ªæ‰©å±•ï¼Œæ—¨åœ¨å°†è¯­ä¹‰åˆ†æåŠŸèƒ½ç›´æ¥å¼•å…¥åˆ° SQL æŸ¥è¯¢ä¸­ã€‚å®ƒé€šè¿‡ä¸€ç»„ map å’Œ reduce å‡½æ•°æ·±åº¦é›†æˆäº†è¯­è¨€æ¨¡å‹å’Œæ£€ç´¢å¢å¼ºç”ŸæˆåŠŸèƒ½ã€‚  
  
**è°å¯ä»¥ä»ä½¿ç”¨ FlockMTL ä¸­å—ç›Šï¼Ÿ**  
  
FlockMTL ä¸“ä¸ºéœ€è¦ç»“åˆä¼ ç»Ÿ SQL æ“ä½œæ¥åˆ©ç”¨è¯­ä¹‰åˆ†æçš„å¼€å‘è€…ã€æ•°æ®ç§‘å­¦å®¶å’Œä¼ä¸šè€Œè®¾è®¡ã€‚å®ƒå¯¹äºæ–‡æ¡£æ’åã€å†…å®¹ç”Ÿæˆå’Œè¯­ä¹‰æœç´¢ç­‰ç”¨ä¾‹å°¤å…¶æœ‰ç”¨ã€‚  
  
**FlockMTL çš„ä¸»è¦åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ**  
- æ¨¡å‹ç®¡ç†ï¼šé…ç½®ç³»ç»Ÿå®šä¹‰å’Œç”¨æˆ·å®šä¹‰çš„æ¨¡å‹ã€‚  
- æç¤ºç®¡ç†ï¼šåˆ›å»ºå’Œç®¡ç†å¯é‡å¤ä½¿ç”¨çš„æ–‡æœ¬æç¤ºã€‚  
- LLM å¯†é’¥ç®¡ç†ï¼šä¸ºæ”¯æŒçš„æä¾›å•†(ä¾‹å¦‚å¾®è½¯ã€openai)å®‰å…¨åœ°å­˜å‚¨å’Œç®¡ç† API å¯†é’¥ã€‚  
- ä¸ DuckDB é›†æˆï¼šåˆ©ç”¨ DuckDB å¼ºå¤§çš„ SQL å¼•æ“ä»¥åŠè¯­ä¹‰åŠŸèƒ½ã€‚  
- æ”¯æŒå¤šå®¶æä¾›å•†ï¼šè®¿é—® OpenAIã€Azure å’Œ Ollama æ¨¡å‹ä»¥æ‰§è¡Œå„ç§ä»»åŠ¡ã€‚  
- ä½¿ç”¨ Ollama è¿›è¡Œæœ¬åœ°æ¨ç†ï¼šä½¿ç”¨ LLaMA æ¨¡å‹åœ¨æœ¬åœ°æ‰§è¡Œæ¨ç†ã€‚  
- æ ‡é‡å‡½æ•°ï¼šä½¿ç”¨llm_completeã€llm_complete_jsonå’Œç­‰å‡½æ•°llm_filteræ‰§è¡Œé«˜çº§ä»»åŠ¡ã€‚  
- èšåˆå‡½æ•°llm_reduceï¼šä½¿ç”¨å’Œç­‰å‡½æ•°æ‰§è¡Œæ±‡æ€»ã€æ’åå’Œé‡æ–°æ’åºllm_rerankã€‚  
  
**å¦‚ä½•å®‰è£… FlockMTLï¼Ÿ**  
  
æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤è½»æ¾å®‰è£… FlockMTLï¼š  
```  
INSTALL flockmtl FROM community;  
LOAD flockmtl;  
```  
  
  
**å¦‚ä½•åœ¨ FlockMTL ä¸­ç®¡ç†æ¨¡å‹ï¼Ÿ**  
  
æ‚¨å¯ä»¥ä½¿ç”¨ SQL å‘½ä»¤ç®¡ç†æ¨¡å‹ï¼Œä¾‹å¦‚ï¼š  
```  
CREATE MODEL  
UPDATE MODEL  
DELETE MODELæœ‰å…³è¯¦ç»†ç¤ºä¾‹ï¼Œ è¯·å‚é˜…æ¨¡å‹ç®¡ç†éƒ¨åˆ†ã€‚( https://dais-polymtl.github.io/flockmtl/docs/resource-management/models )  
```  
  
**æˆ‘å¯ä»¥ä¸ºæˆ‘çš„ä»»åŠ¡åˆ›å»ºè‡ªå®šä¹‰æç¤ºè¯å—ï¼Ÿ**  
  
æ˜¯çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`CREATE PROMPT`å’Œ`UPDATE PROMPT`å‘½ä»¤åˆ›å»ºå’Œç®¡ç†è‡ªå®šä¹‰æç¤ºã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…â€œæç¤ºè¯ç®¡ç†â€éƒ¨åˆ†ã€‚( https://dais-polymtl.github.io/flockmtl/docs/resource-management/prompts )  
  
  
### ä¾‹å­  
ä»¥æœ¬åœ°æ¨¡å‹ä¸ºä¾‹, å¯åŠ¨ollama   
```  
$ OLLAMA_HOST=0.0.0.0:11434 OLLAMA_KEEP_ALIVE=-1 nohup ollama serve > /dev/null 2>&1 &  
  
$ ollama list  
NAME                                   ID              SIZE      MODIFIED             
qwen3:4b                               2bfd38a7daaf    2.6 GB    About a minute ago      
qwen3:14b                              7d7da67570e2    9.3 GB    7 weeks ago             
linux6200/bge-reranker-v2-m3:latest    abf5c6d8bc56    1.2 GB    2 months ago            
qwen2.5-coder:3b                       e7149271c296    1.9 GB    2 months ago            
ds-qwen2.5-1.5b-digoal:latest          2c6aaa8a497c    3.6 GB    3 months ago            
qwen2.5:1.5b                           65ec06548149    986 MB    4 months ago            
deepseek-r1:7b                         0a8c26691023    4.7 GB    4 months ago            
qwen_1.5b_test1:latest                 682ad25636bd    1.1 GB    4 months ago            
deepseek-r1:1.5b                       a42b25d8c10a    1.1 GB    4 months ago            
deepseek-r1:14b                        ea35dfe18182    9.0 GB    5 months ago            
mxbai-embed-large:latest               468836162de7    669 MB    7 months ago   
```  
  
å¯åŠ¨duckdb  
```  
$ duckdb   
DuckDB v1.3.1 (Ossivalis) 2063dda3e6  
Enter ".help" for usage hints.  
Connected to a transient in-memory database.  
Use ".open FILENAME" to reopen on a persistent database.  
```  
  
å®‰è£…flockmtlæ’ä»¶  
```  
D INSTALL flockmtl FROM community;  
100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   
D LOAD flockmtl;  
```  
  
åˆ›å»ºllmå¯†é’¥  
```  
CREATE SECRET (  
    TYPE OLLAMA,  
    API_URL '127.0.0.1:11434'  
);  
```  
  
åˆ›å»ºæ¨¡å‹  
```  
CREATE MODEL(  
   'QuackingModel',  
   'qwen2.5:1.5b',  
   'ollama',  
   {"context_window": 128000, "max_output_tokens": 2048}  
);    
```  
  
ä½¿ç”¨æ¨¡å‹  
```  
D SELECT llm_complete(  
      {'model_name': 'QuackingModel'},  
      {'prompt': 'Talk like a duck ğŸ¦† and write a poem about a database ğŸ“š'}  
  );  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚                         llm_complete(main.struct_pack(model_name := 'QuackingModel'), main.struct_pack(prompt := 'Talk like a duck ğŸ¦† and write a poem about a database ğŸ“š'))                          â”‚  
â”‚                                                                                                varchar                                                                                                 â”‚  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚ Quack quack! In the marshy meadow,\nWhere the water's deep and the reeds sway.\nI am a database, my home is wide,\nA place where data doth reside.\n\nRows of tables, columns they align,\nEach one â€¦  â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  
```  
  
æ›´å¤šç”¨æ³•è¯·å‚è€ƒflockMTLæ–‡æ¡£.  
- æ¨¡å‹ç®¡ç†  
- æç¤ºè¯ç®¡ç†  
- æ··åˆæœç´¢  
- æ ‡é‡æŸ¥è¯¢  
- èšåˆæŸ¥è¯¢ç­‰    
    
  
#### [æœŸæœ› PostgreSQL|å¼€æºPolarDB å¢åŠ ä»€ä¹ˆåŠŸèƒ½?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB å¼€æºæ•°æ®åº“](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB å­¦ä¹ å›¾è°±](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [PostgreSQL è§£å†³æ–¹æ¡ˆé›†åˆ](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [å¾·å“¥ / digoal's Github - å…¬ç›Šæ˜¯ä¸€è¾ˆå­çš„äº‹.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About å¾·å“¥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
