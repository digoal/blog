## AIè®ºæ–‡è§£è¯» | Reciprocal Rank Fusion outperforms Condorcet and individual Rank Learning Methods
        
### ä½œè€…        
digoal        
        
### æ—¥æœŸ        
2025-07-24       
        
### æ ‡ç­¾        
PostgreSQL , PolarDB , DuckDB , AI , è®ºæ–‡è§£è¯»        
        
----        
        
## èƒŒæ™¯  
      
https://plg.uwaterloo.ca/~gvcormac/cormacksigir09-rrf.pdf        
  
æç¤º:        
```        
ä¸‰ä¸ªé—®é¢˜:  
  
1ã€è¯»æ‡‚è¿™ç¯‡è®ºæ–‡éœ€è¦æå‰æŒæ¡å“ªäº›åŸºç¡€çŸ¥è¯†, è¯·ä½¿ç”¨ä¸­æ–‡é€šç†Ÿæ˜“æ‡‚çš„è®²è§£è¿™äº›åŸºç¡€çŸ¥è¯†, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§.  
  
2ã€ä½¿ç”¨ä¸­æ–‡é€šç†Ÿæ˜“æ‡‚çš„è§£è¯»è¿™ç¯‡è®ºæ–‡, å…³é”®å†…å®¹è¯·æ·±å…¥è®²è§£, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§.  
  
3ã€ä½¿ç”¨ä¸­æ–‡æå–è¿™ç¯‡è®ºæ–‡ä¸­çš„é‡è¦æœ¯è¯­å¹¶è¯¦ç»†è§£é‡Š, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§.      
```     

## è®ºæ–‡è§£è¯»

### **1. è¯»æ‡‚è¿™ç¯‡è®ºæ–‡éœ€è¦æå‰æŒæ¡å“ªäº›åŸºç¡€çŸ¥è¯†**

è¦ç†è§£è¿™ç¯‡å…³äº **Reciprocal Rank Fusion (RRF)** çš„è®ºæ–‡ï¼Œä½ éœ€è¦æŒæ¡ä»¥ä¸‹å‡ ä¸ªåŸºç¡€æ¦‚å¿µã€‚æˆ‘ä¼šç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Šï¼Œå¹¶ç»“åˆè®ºæ–‡å†…å®¹å¸®åŠ©ä½ ç†è§£ã€‚
  
PS: RRFçš„ç®—æ³•å’Œæ¨¡å‹å¯¹å¬å›çš„â€œContext precisionâ€è¯„åˆ†ç®—æ³•æœ‰ç‚¹å¼‚æ›²åŒå·¥, å‚è€ƒ: [ã€Šä¸ºä»€ä¹ˆç”¨äº†RAG, æˆ‘çš„AIè¿˜æ˜¯ç¬¨å¾—è·ŸçŒªä¸€æ ·! RAGæ•ˆæœè¯„æµ‹ä¸ä¼˜åŒ–ã€‹](../202504/20250414_04.md)  
  
#### **1.1 ä¿¡æ¯æ£€ç´¢ï¼ˆInformation Retrieval, IRï¼‰**
è¿™æ˜¯æœç´¢å¼•æ“çš„æ ¸å¿ƒæŠ€æœ¯ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ï¼š  
å½“ä½ è¾“å…¥ä¸€ä¸ªæŸ¥è¯¢ï¼ˆæ¯”å¦‚â€œå¦‚ä½•å­¦ä¹ AIâ€ï¼‰ï¼Œç³»ç»Ÿä¼šä»å¤§é‡æ–‡æ¡£ä¸­æ‰¾å‡ºæœ€ç›¸å…³çš„é‚£äº›ï¼Œå¹¶æŒ‰ç›¸å…³æ€§æ’åºè¿”å›ç»™ä½ ã€‚

- **ç›®æ ‡**ï¼šè®©æœ€ç›¸å…³çš„æ–‡æ¡£æ’åœ¨å‰é¢ã€‚
- **æŒ‘æˆ˜**ï¼šä¸åŒç³»ç»Ÿå¯¹â€œç›¸å…³â€çš„åˆ¤æ–­å¯èƒ½ä¸åŒã€‚

ğŸ“Œ ä¸¾ä¾‹ï¼šGoogleã€ç™¾åº¦éƒ½æ˜¯ä¿¡æ¯æ£€ç´¢ç³»ç»Ÿã€‚



#### **1.2 æ’åï¼ˆRankingï¼‰ä¸è¯„åˆ†ï¼ˆScoringï¼‰**
æ¯ä¸ªæ–‡æ¡£ä¼šè¢«æ‰“åˆ†ï¼Œç„¶åæ ¹æ®åˆ†æ•°ä»é«˜åˆ°ä½æ’åºã€‚è¿™ä¸ªé¡ºåºå°±æ˜¯â€œæ’åâ€ã€‚

| æ–‡æ¡£ | ç›¸å…³æ€§åˆ†æ•° | æ’å |
|------|------------|------|
| D1   | 0.95       | 1    |
| D2   | 0.87       | 2    |
| D3   | 0.63       | 3    |

- æ’åè¶Šé å‰ï¼ˆæ•°å­—è¶Šå°ï¼‰ï¼Œè¯´æ˜ç³»ç»Ÿè®¤ä¸ºå®ƒè¶Šç›¸å…³ã€‚
- ä¸åŒç³»ç»Ÿçš„æ‰“åˆ†æ–¹å¼ä¸åŒï¼ˆæœ‰çš„ç”¨TF-IDFï¼Œæœ‰çš„ç”¨ç¥ç»ç½‘ç»œï¼‰ï¼Œæ‰€ä»¥åˆ†æ•°ä¸èƒ½ç›´æ¥æ¯”è¾ƒã€‚

âœ… è®ºæ–‡ä¸­çš„å…³é”®ç‚¹ï¼šRRF åªçœ‹â€œæ’åâ€ï¼Œä¸çœ‹â€œåŸå§‹åˆ†æ•°â€ï¼Œè¿™æ ·å°±èƒ½å…¬å¹³åœ°èåˆå¤šä¸ªç³»ç»Ÿçš„ç»“æœã€‚



#### **1.3 èåˆï¼ˆFusion / Aggregationï¼‰**
å¤šä¸ªæœç´¢å¼•æ“å¯¹åŒä¸€æŸ¥è¯¢ç»™å‡ºä¸åŒçš„ç»“æœåˆ—è¡¨ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬â€œèåˆâ€èµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„ç»¼åˆæ’åã€‚

ğŸ” ä¸ºä»€ä¹ˆèåˆæœ‰ç”¨ï¼Ÿ
- Aç³»ç»Ÿæ“…é•¿æ‰¾æ–°é—»
- Bç³»ç»Ÿæ“…é•¿æ‰¾å­¦æœ¯æ–‡ç« 
- Cç³»ç»Ÿæ“…é•¿æ‰¾å›¾ç‰‡

ğŸ‘‰ æŠŠä¸‰è€…ç»“æœèåˆï¼Œå¯èƒ½æ¯”ä»»ä½•ä¸€ä¸ªå•ç‹¬ç³»ç»Ÿéƒ½å¥½ï¼

ğŸ“Œ è®ºæ–‡ç›®æ ‡ï¼šæå‡ºä¸€ç§ç®€å•ä½†å¼ºå¤§çš„èåˆæ–¹æ³• â€”â€” RRFã€‚



#### **1.4 è¯„ä¼°æŒ‡æ ‡ï¼šMAPã€P@kã€NDCG**
æ€ä¹ˆåˆ¤æ–­å“ªä¸ªç³»ç»Ÿæ›´å¥½ï¼Ÿéœ€è¦ç”¨é‡åŒ–æŒ‡æ ‡ã€‚

##### **MAPï¼ˆMean Average Precisionï¼Œå¹³å‡å‡†ç¡®ç‡å‡å€¼ï¼‰**
- è¡¡é‡æ•´ä½“æ’åºè´¨é‡ã€‚
- å¯¹æ¯ä¸ªæŸ¥è¯¢è®¡ç®—â€œå¹³å‡ç²¾åº¦â€ï¼ˆAPï¼‰ï¼Œå†å–æ‰€æœ‰æŸ¥è¯¢çš„å¹³å‡å€¼ã€‚
- å€¼è¶Šé«˜è¶Šå¥½ï¼ŒèŒƒå›´æ˜¯ 0ï½1ã€‚

ğŸ“Œ è®ºæ–‡ä¸­æ‰€æœ‰è¡¨æ ¼ï¼ˆå¦‚ Table 2ã€3ï¼‰éƒ½ç”¨ MAP æ¥æ¯”è¾ƒæ€§èƒ½ã€‚

##### **P@kï¼ˆPrecision at kï¼‰**
å‰ k ä¸ªç»“æœä¸­æœ‰å¤šå°‘æ˜¯ç›¸å…³çš„ï¼Ÿ

ä¾‹å¦‚ P@5 = 0.8 è¡¨ç¤ºå‰5ä¸ªç»“æœä¸­æœ‰4ä¸ªæ˜¯ç›¸å…³çš„ã€‚

##### **NDCGï¼ˆNormalized Discounted Cumulative Gainï¼‰**
è€ƒè™‘äº†ç›¸å…³ç¨‹åº¦ï¼ˆæ¯”å¦‚â€œå®Œå…¨ç›¸å…³â€ã€â€œéƒ¨åˆ†ç›¸å…³â€ï¼‰å’Œä½ç½®è¡°å‡ï¼ˆè¶Šé åï¼Œæƒé‡è¶Šä½ï¼‰ã€‚

ğŸ§  å°çŸ¥è¯†ï¼šä½ç½®è¶Šé å‰è¶Šé‡è¦ã€‚ç¬¬1åçš„å½±å“è¿œå¤§äºç¬¬10åã€‚



#### **1.5 å­¦ä¹ æ’åºï¼ˆLearning to Rank, LTRï¼‰**
è®©æœºå™¨å­¦ä¹ æ¨¡å‹è‡ªåŠ¨å­¦ä¼šå¦‚ä½•ç»™æ–‡æ¡£æ‰“åˆ†æ’åºã€‚

å¸¸è§æ–¹æ³•ï¼š
- **RankSVM**ï¼šç”¨æ”¯æŒå‘é‡æœºåšæ’åº
- **ListNet**ï¼šç”¨ç¥ç»ç½‘ç»œä¼˜åŒ–æ•´ä¸ªåˆ—è¡¨
- **AdaRank**ï¼šåŸºäº boosting çš„æ’åºç®—æ³•

ğŸ“Œ è®ºæ–‡æåˆ°è¿™äº›æ–¹æ³•ä½œä¸ºå¯¹æ¯”åŸºå‡†ï¼ˆè§ Table 3ï¼‰ã€‚



#### **1.6 Condorcet Fusion ä¸ CombMNZï¼ˆå·²æœ‰èåˆæ–¹æ³•ï¼‰**

##### **Condorcet Fusion**
æ€æƒ³æ¥è‡ªæŠ•ç¥¨ç†è®ºï¼šä¸¤ä¸¤æ¯”è¾ƒæ–‡æ¡£ï¼Œè°è¢«æ›´å¤šç³»ç»Ÿæ’åœ¨å‰é¢ï¼Œè°å°±èµ¢ã€‚

```mermaid
graph LR
    D1 -- è¢«5ä¸ªç³»ç»Ÿæ’åœ¨D2å‰ --> Winner[D1èƒœ]
    D2 -- è¢«2ä¸ªç³»ç»Ÿæ’åœ¨D1å‰ --> Loser
```

æœ€ç»ˆå½¢æˆä¸€ä¸ªæ€»æ’åã€‚ä½†å®ƒéœ€è¦åš O(nÂ²) æ¬¡æ¯”è¾ƒï¼Œè®¡ç®—é‡å¤§ã€‚

ğŸ“Œ è®ºæ–‡æŒ‡å‡º RRF æ¯”å®ƒæ›´ç®€å•æœ‰æ•ˆã€‚

##### **CombMNZ**
å…¬å¼å¦‚ä¸‹ï¼ˆæ¥è‡ªè®ºæ–‡ï¼‰ï¼š

![pic](20250724_03_pic_001.jpg)  `$$\text{CMNZscore}(d) = \underbrace{\left|\{r \in R \mid r(d) \leq c\}\right|}_{\text{æœ‰å¤šå°‘ç³»ç»ŸæŠŠdæ’è¿›å‰cå}} \times \underbrace{\sum_{\{r \mid r(d)\leq c\}} s_r(d)}_{\text{è¿™äº›ç³»ç»Ÿçš„åŸå§‹å¾—åˆ†ä¹‹å’Œ}}$$`

âš ï¸ é—®é¢˜ï¼šä¾èµ–åŸå§‹å¾—åˆ† $s_r(d)$ï¼Œè€Œä¸åŒç³»ç»Ÿçš„å¾—åˆ†å°ºåº¦ä¸åŒï¼Œéš¾ä»¥å…¬å¹³èåˆã€‚



### **æ€»ç»“ï¼šåŸºç¡€çŸ¥è¯†å›¾è°±**

```mermaid
graph TD
    A[ä¿¡æ¯æ£€ç´¢ IR] --> B[æ’å Ranking]
    B --> C[èåˆ Fusion]
    C --> D[è¯„ä¼°æŒ‡æ ‡ MAP/P@k/NDCG]
    B --> E[å­¦ä¹ æ’åº Learning to Rank]
    E --> F[RankSVM, ListNet, AdaRank...]
    C --> G[èåˆæ–¹æ³•]
    G --> H[Condorcet]
    G --> I[CombMNZ]
    G --> J[RRF â† æœ¬æ–‡æå‡º]
```

æŒæ¡ä»¥ä¸ŠçŸ¥è¯†åï¼Œå°±å¯ä»¥æ·±å…¥ç†è§£è¿™ç¯‡è®ºæ–‡äº†ã€‚



## **2. ä½¿ç”¨ä¸­æ–‡é€šä¿—è§£è¯»è¿™ç¯‡è®ºæ–‡**

æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥æ‹†è§£è¿™ç¯‡è®ºæ–‡çš„æ ¸å¿ƒæ€æƒ³ã€‚



### **2.1 è®ºæ–‡è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ**

> å¦‚ä½•æŠŠå¤šä¸ªä¿¡æ¯æ£€ç´¢ç³»ç»Ÿçš„æ’åç»“æœæœ‰æ•ˆåœ°èåˆåœ¨ä¸€èµ·ï¼Œå¾—åˆ°ä¸€ä¸ªæ¯”ä»»ä½•ä¸€ä¸ªå•ç‹¬ç³»ç»Ÿéƒ½å¼ºçš„â€œè¶…çº§ç³»ç»Ÿâ€ï¼Ÿ

ğŸ¯ ç›®æ ‡ï¼šä¸ä¾èµ–è®­ç»ƒæ•°æ®ï¼ˆæ— ç›‘ç£ï¼‰ã€ç®€å•ã€é«˜æ•ˆã€æ•ˆæœå¥½ã€‚



### **2.2 ä½œè€…æå‡ºäº†ä»€ä¹ˆæ–°æ–¹æ³•ï¼Ÿâ€”â€” RRFï¼ˆReciprocal Rank Fusionï¼‰**

#### **æ ¸å¿ƒæ€æƒ³ï¼šè¶Šé å‰çš„æ–‡æ¡£è¶Šé‡è¦ï¼Œä½†ä¸èƒ½å¿½ç•¥åé¢çš„æ–‡æ¡£**

æˆ‘ä»¬æ¥çœ‹ RRF çš„æ‰“åˆ†å…¬å¼ï¼ˆè®ºæ–‡ç¬¬1èŠ‚ï¼‰ï¼š

$$\text{RRFscore}(d) = \sum_{r \in R} \frac{1}{k + r(d)}$$

å…¶ä¸­ï¼š
- $d$ ï¼šæŸä¸ªæ–‡æ¡£
- $r(d)$ ï¼šåœ¨ç¬¬ $r$ ä¸ªç³»ç»Ÿä¸­çš„æ’åï¼ˆ1è¡¨ç¤ºç¬¬1åï¼‰
- $k$ ï¼šè°ƒèŠ‚å‚æ•°ï¼ˆè®ºæ–‡ä¸­è®¾ä¸º60ï¼‰
- $R$ ï¼šæ‰€æœ‰å‚ä¸èåˆçš„ç³»ç»Ÿé›†åˆ



#### **ä¸¾ä¸ªä¾‹å­ ğŸŒ°**

å‡è®¾æˆ‘ä»¬æœ‰ 3 ä¸ªæœç´¢å¼•æ“å¯¹æ–‡æ¡£ D çš„æ’åå¦‚ä¸‹ï¼š

| ç³»ç»Ÿ | æ’å $r(d)$ | $\frac{1}{60 + r(d)}$ |
|------|----------------|----------------------------|
| A    | 1              | 1/61 â‰ˆ 0.0164             |
| B    | 3              | 1/63 â‰ˆ 0.0159             |
| C    | 10             | 1/70 â‰ˆ 0.0143             |
|      | **æ€»åˆ†**       | **â‰ˆ 0.0466**               |

ğŸ‘‰ æ€»åˆ†è¶Šé«˜ï¼Œè¯´æ˜æ•´ä½“æ’åè¶Šé å‰ï¼Œåº”è¯¥æ’åœ¨æœ€ç»ˆç»“æœçš„å‰é¢ã€‚



#### **ä¸ºä»€ä¹ˆåŠ ä¸ª k=60ï¼Ÿ**

å¦‚æœä¸åŠ  kï¼Œæ¯”å¦‚ç”¨ $\frac{1}{r(d)}$ï¼Œä¼šå‡ºç°æç«¯æƒ…å†µï¼š

| æ’å | åˆ†æ•°ï¼ˆ1/rï¼‰ |
|------|------------|
| 1    | 1.0        |
| 2    | 0.5        |
| 3    | 0.33       |
| 10   | 0.1        |

â¡ï¸ ç¬¬1åå¾—åˆ†æ˜¯ç¬¬2åçš„2å€ï¼å¤ªæ•æ„Ÿäº†ï¼

åŠ ä¸Š k=60 åï¼š

| æ’å | åˆ†æ•°ï¼ˆ1/(60+r)ï¼‰ |
|------|------------------|
| 1    | 0.0164           |
| 2    | 0.0161           |
| 3    | 0.0159           |
| 10   | 0.0143           |

â¡ï¸ å·®å¼‚å˜å°ï¼Œæ›´å¹³æ»‘ï¼Œé¿å…ä¸ªåˆ«ç³»ç»Ÿâ€œåˆ·æ¦œâ€ã€‚



#### **ç›´è§‚ç†è§£ RRF çš„ä¼˜åŠ¿**

```mermaid
pie
    title RRF çš„è®¾è®¡ç†å¿µ
    "é«˜æ’åå¾ˆé‡è¦" : 60
    "ä½æ’åä¹Ÿæœ‰ä»·å€¼" : 30
    "é¿å…å¼‚å¸¸å€¼å½±å“" : 10
```

- ä¸åƒæŒ‡æ•°å‡½æ•°é‚£æ ·â€œåªå…³æ³¨å‰å‡ åâ€
- ä¸åƒå¹³å‡æ’åé‚£æ ·â€œå¿½è§†å¤´éƒ¨ä¼˜åŠ¿â€
- æ˜¯ä¸€ç§â€œæ¸©å’ŒåŠ æƒâ€çš„èåˆç­–ç•¥



### **2.3 å®éªŒéªŒè¯ï¼šRRF åˆ°åº•å¥½ä¸å¥½ï¼Ÿ**

ä½œè€…åšäº†ä¸‰ç±»å®éªŒï¼š

#### âœ… å®éªŒ1ï¼šWumpus ç³»ç»Ÿåœ¨ TREC æ•°æ®é›†ä¸Šçš„èåˆï¼ˆTable 1ï¼‰

| k å€¼ | MAP  |
|------|------|
| 0    | 0.2072 |
| 10   | 0.2123 |
| ...  | ...  |
| 60   | **0.2145** âœ… |
| 100  | 0.2142 |
| 500  | 0.2098 |

â¡ï¸ k=60 æ¥è¿‘æœ€ä¼˜ï¼Œä¸”å¯¹ç»“æœå½±å“ä¸å¤§ â†’ å‚æ•°é²æ£’ï¼



#### âœ… å®éªŒ2ï¼šTREC æäº¤ç»“æœçš„èåˆï¼ˆTable 2ï¼‰â€”â€” æ›´çœŸå®åœºæ™¯

| æ–¹æ³•           | TREC Robust | TREC 3 | TREC 5 | TREC 9 |
|----------------|-------------|--------|--------|--------|
| RRF            | **0.3686**  | **0.4350** | **0.3394** | **0.2830** |
| Best Individual| 0.3586      | 0.4226 | 0.3165 | 0.3519\* |
| Condorcet      | 0.3652      | 0.4256 | 0.3213 | 0.2750 |
| CombMNZ        | 0.3575      | 0.4381 | 0.3237 | 0.2671 |

> æ³¨ï¼šTREC 9 çš„â€œæœ€ä½³ä¸ªä½“â€æ˜¯äººå·¥å‚ä¸çš„ç»“æœï¼ˆ\*ï¼‰ï¼Œä¸ç®—çº¯è‡ªåŠ¨ç³»ç»Ÿã€‚

ğŸ“Œ **ç»“è®º**ï¼š
- RRF åœ¨ 3/4 ä¸ªä»»åŠ¡ä¸­è¶…è¿‡æ‰€æœ‰æ–¹æ³•
- å³ä½¿åœ¨ TREC 3 è¾“ç»™ CombMNZï¼Œåœ¨å…¶ä»–ä»»åŠ¡ä¹Ÿèµ¢äº†
- å¹³å‡æå‡ **4%~5%**



#### âœ… å®éªŒ3ï¼šLETOR 3 æ•°æ®é›†ä¸Šçš„å­¦ä¹ æ’åºèåˆï¼ˆTable 3ï¼‰â€”â€” æœ€å¼ºå¯¹æ¯”

| æ–¹æ³•           | MAP     | RRF è¶…å‡ºé‡ | æ˜¾è‘—æ€§ï¼ˆpå€¼ï¼‰ |
|----------------|---------|-----------|---------------|
| RRF            | **0.6051** | â€”         | â€”             |
| Condorcet      | 0.5917  | +0.0134   | p=0.004 âœ…     |
| CombMNZ        | 0.6107  | -0.0056   | p=0.2 âŒ       |
| ListNet        | 0.5846  | +0.0205   | p=0.001 âœ…     |
| RankSVM        | 0.5737  | +0.0314   | p=0.000 âœ…     |

ğŸ“Œ **æƒŠäººå‘ç°**ï¼š
- RRF èåˆå¤šä¸ªå­¦ä¹ æ’åºæ¨¡å‹ï¼Œæ•ˆæœè¶…è¿‡äº†ä»»ä½•ä¸€ä¸ªå•ç‹¬æ¨¡å‹ï¼
- è¿™ç›¸å½“äºæ„å»ºäº†ä¸€ä¸ªâ€œå…ƒå­¦ä¹ å™¨â€ï¼ˆmeta-learnerï¼‰
- è™½ç„¶ CombMNZ ç•¥é«˜ï¼Œä½†å·®å¼‚ä¸æ˜¾è‘—ï¼ˆp=0.2ï¼‰

> ğŸ’¡ ä½œè€…è¯´ï¼šâ€œæ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œæ²¡æœ‰å·²å‘è¡¨çš„æ–¹æ³•èƒ½è¶…è¿‡è¿™ä¸ªèåˆç»“æœã€‚â€



### **2.4 ä¸ºä»€ä¹ˆ RRF èƒ½èµ¢ï¼Ÿâ€”â€” æ·±å…¥åˆ†æ**

è®ºæ–‡åœ¨ç¬¬2èŠ‚è®¨è®ºäº†åŸå› ï¼š

#### ğŸ” å¯¹æ¯” Condorcet
- Condorcet æ˜¯â€œå¤šæ•°å†³â€ï¼šåªè¦å¤šæ•°ç³»ç»Ÿè®¤ä¸º A > Bï¼Œå°±æˆç«‹ã€‚
- ä½†å¿½ç•¥äº†â€œå¼ºåå¥½â€ vs â€œå¼±åå¥½â€ã€‚
- ä¸¾ä¾‹ï¼š5ä¸ªç³»ç»Ÿè½»è½»æŠŠAæ’å‰é¢ï¼Œ2ä¸ªç³»ç»Ÿå¼ºçƒˆè®¤ä¸ºAæ˜¯ç¬¬ä¸€å â†’ RRF æ›´èƒ½ä½“ç°è¿™ç§â€œäº®ç‚¹â€ã€‚

#### ğŸ” å¯¹æ¯” CombMNZ
- CombMNZ ä¾èµ–åŸå§‹å¾—åˆ†ï¼Œè€Œä¸åŒç³»ç»Ÿçš„å¾—åˆ†æ²¡æœ‰å¯æ¯”æ€§ã€‚
- æœ‰äº›ç³»ç»Ÿå¤©ç”Ÿæ‰“åˆ†é«˜ï¼Œå®¹æ˜“â€œåˆ·åˆ†â€ã€‚
- RRF åªç”¨æ’åï¼Œæ›´å…¬å¹³ã€æ›´ç¨³å®šã€‚



### **2.5 RRF çš„ä¼˜ç‚¹æ€»ç»“**

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸŸ¢ æ— ç›‘ç£ | ä¸éœ€è¦è®­ç»ƒæ•°æ®ï¼Œç›´æ¥èåˆæ’å |
| ğŸŸ¢ ç®€å• | ä¸€è¡Œå…¬å¼æå®šï¼Œæ˜“äºå®ç° |
| ğŸŸ¢ é«˜æ•ˆ | å¯é€ä¸ªç³»ç»Ÿç´¯åŠ ï¼Œå†…å­˜å‹å¥½ |
| ğŸŸ¢ é²æ£’ | å‚æ•° k ä¸æ•æ„Ÿï¼Œç»“æœç¨³å®š |
| ğŸŸ¢ é€šç”¨ | èƒ½èåˆä»»ä½•æ’åç³»ç»Ÿï¼ˆåŒ…æ‹¬å­¦ä¹ æ’åºï¼‰ |



## **3. é‡è¦æœ¯è¯­è¯¦è§£**

ä¸‹é¢åˆ—å‡ºè®ºæ–‡ä¸­çš„å…³é”®æœ¯è¯­å¹¶è¯¦ç»†è§£é‡Šã€‚



### **3.1 Reciprocal Rank Fusion (RRF)**
> **ä¸­æ–‡**ï¼šå€’æ•°æ’åèåˆ

#### **å®šä¹‰**
ä¸€ç§åŸºäºæ–‡æ¡£æ’åä½ç½®çš„èåˆæ–¹æ³•ï¼Œä½¿ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—ç»¼åˆå¾—åˆ†ï¼š

$$
\text{RRFscore}(d) = \sum_{r \in R} \frac{1}{k + r(d)}, \quad k=60
$$

#### **ç‰¹ç‚¹**
- â€œå€’æ•°â€æ„å‘³ç€æ’åè¶Šé å‰ï¼ˆrè¶Šå°ï¼‰ï¼Œå¾—åˆ†è¶Šé«˜
- åŠ ä¸Š k æ˜¯ä¸ºäº†é˜²æ­¢å¤´éƒ¨æ’åè¿‡äºä¸»å¯¼
- æ‰€æœ‰ç³»ç»Ÿå¹³ç­‰å¯¹å¾…ï¼Œæ— éœ€æ ¡å‡†å¾—åˆ†

#### **æµç¨‹å›¾**

```mermaid
graph TB
    A[å¤šä¸ªç³»ç»Ÿè¾“å‡ºæ’å] --> B[å¯¹æ¯ä¸ªæ–‡æ¡£d]
    B --> C["è®¡ç®—æ¯ä¸ªç³»ç»Ÿä¸­dçš„æ’år(d)"]
    C --> D["ä»£å…¥å…¬å¼: 1/(60 + r(d))"]
    D --> E["æ±‚å’Œå¾—åˆ°RRFscore(d)"]
    E --> F[æŒ‰æ€»åˆ†æ’åºè¾“å‡º]
```



### **3.2 Condorcet Fusion**
> **ä¸­æ–‡**ï¼šå­”å¤šå¡èåˆ

#### **æ¥æº**
æºè‡ªç¤¾ä¼šé€‰æ‹©ç†è®ºä¸­çš„â€œå­”å¤šå¡èµ¢å®¶â€ï¼šèƒ½åœ¨ä¸¤ä¸¤å¯¹å†³ä¸­å‡»è´¥æ‰€æœ‰å¯¹æ‰‹çš„å€™é€‰äººã€‚

#### **åœ¨IRä¸­çš„åº”ç”¨**
- å¯¹æ¯å¯¹æ–‡æ¡£ (d1, d2)ï¼Œç»Ÿè®¡æœ‰å¤šå°‘ç³»ç»Ÿè®¤ä¸º d1 æ¯” d2 æ›´ç›¸å…³
- å¦‚æœå¤šæ•°ç³»ç»Ÿè®¤ä¸º d1 > d2ï¼Œåˆ™ d1 æ’åœ¨å‰é¢
- æœ€ç»ˆå½¢æˆä¸€ä¸ªå…¨å±€æ’åº

#### **ç¼ºç‚¹**
- è®¡ç®—å¤æ‚ï¼ˆO(nÂ²) æ¯”è¾ƒï¼‰
- å¿½è§†åå¥½å¼ºåº¦
- å¯èƒ½å‡ºç°â€œæŠ•ç¥¨æ‚–è®ºâ€ï¼ˆæ— ç¨³å®šæ’åºï¼‰



### **3.3 CombMNZ**
> **ä¸­æ–‡**ï¼šå¸¦å½’ä¸€åŒ–çš„ç»„åˆå¾—åˆ†æ³•ï¼ˆCombination with Minimum Normalization and Zeroï¼‰

#### **å…¬å¼å›é¡¾**

$$
\text{CMNZscore}(d) = \text{count}(r(d) \leq c) \times \sum_{r(d) \leq c} s_r(d)
$$

#### **å«ä¹‰**
- ç¬¬ä¸€éƒ¨åˆ†ï¼šæœ‰å¤šå°‘ç³»ç»Ÿå°† d æ’è¿›å‰ c åï¼ˆæ¯”å¦‚å‰10åï¼‰
- ç¬¬äºŒéƒ¨åˆ†ï¼šè¿™äº›ç³»ç»Ÿç»™ d çš„åŸå§‹å¾—åˆ†ä¹‹å’Œ
- ç›¸å½“äºâ€œå—æ¬¢è¿ç¨‹åº¦ Ã— æ€»ä½“æ”¯æŒåº¦â€

#### **é—®é¢˜**
- ä¾èµ–åŸå§‹å¾—åˆ† $s_r(d)$ï¼Œè€Œä¸åŒç³»ç»Ÿçš„å¾—åˆ†ä¸å¯æ¯”
- æŸäº›ç³»ç»Ÿå¾—åˆ†åé«˜ä¼šâ€œéœ¸æ¦œâ€
- å®éªŒæ˜¾ç¤ºæ–¹å·®å¤§ï¼Œä¸ç¨³å®š



### **3.4 Learning to Rank (LTR)**
> **ä¸­æ–‡**ï¼šå­¦ä¹ æ’åº

#### **å®šä¹‰**
ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä»æ ‡æ³¨æ•°æ®ä¸­å­¦ä¹ å¦‚ä½•ä¸ºæ–‡æ¡£æ‰“åˆ†æ’åºã€‚

#### **å¸¸è§æ–¹æ³•**
| æ–¹æ³• | åŸç†ç®€è¿° |
|------|---------|
| RankSVM | å°†æ’åºè½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Œç”¨SVMè®­ç»ƒ |
| ListNet | ç›´æ¥ä¼˜åŒ–æ•´ä¸ªæ’åºåˆ—è¡¨çš„æ¦‚ç‡åˆ†å¸ƒ |
| AdaRank | ç±»ä¼¼AdaBoostï¼Œè¿­ä»£æå‡æ’åºæ€§èƒ½ |

#### **ä¸RRFçš„å…³ç³»**
- RRF å¯ä»¥èåˆå¤šä¸ª LTR æ¨¡å‹çš„ç»“æœ
- å®éªŒè¡¨æ˜ï¼šèåˆåçš„æ€§èƒ½ > ä»»ä¸€å•ç‹¬æ¨¡å‹



### **3.5 MAPï¼ˆMean Average Precisionï¼‰**
> **ä¸­æ–‡**ï¼šå¹³å‡å‡†ç¡®ç‡å‡å€¼

#### **è®¡ç®—æ­¥éª¤**
1. å¯¹æ¯ä¸ªæŸ¥è¯¢è®¡ç®— APï¼ˆAverage Precisionï¼‰ï¼š
   $$AP = \frac{\sum_{i=1}^n \text{rel}(i)/i}{\text{æ€»ç›¸å…³æ–‡æ¡£æ•°}}$$
   å…¶ä¸­ rel(i)=1 è¡¨ç¤ºç¬¬ i ä¸ªç»“æœç›¸å…³
2. å¯¹æ‰€æœ‰æŸ¥è¯¢å–å¹³å‡ â†’ MAP

#### **æ„ä¹‰**
- ç»¼åˆåæ˜ æ’åºè´¨é‡å’Œè¦†ç›–ç‡
- æ˜¯ TREC ç­‰è¯„æµ‹çš„æ ‡å‡†æŒ‡æ ‡



### **3.6 Meta-Learnerï¼ˆå…ƒå­¦ä¹ å™¨ï¼‰**
> **ä¸­æ–‡**ï¼šå…ƒå­¦ä¹ å™¨

#### **å®šä¹‰**
ä¸æ˜¯ç›´æ¥å­¦ä¹ æ’åºï¼Œè€Œæ˜¯é€šè¿‡èåˆå¤šä¸ªåŸºç¡€å­¦ä¹ å™¨çš„ç»“æœï¼Œæ„å»ºä¸€ä¸ªæ›´å¼ºçš„æ•´ä½“æ¨¡å‹ã€‚

#### **æœ¬æ–‡ä¸­çš„ä½“ç°**
- å°†å¤šä¸ª LTR æ¨¡å‹ï¼ˆå¦‚ RankSVMã€ListNetï¼‰çš„ç»“æœç”¨ RRF èåˆ
- å¾—åˆ°çš„æ–°æ’åºå™¨æ€§èƒ½è¶…è¿‡æ‰€æœ‰åŸºç¡€æ¨¡å‹
- æˆä¸º LETOR 3 æ•°æ®é›†ä¸Šçš„æ–° SOTAï¼ˆState-of-the-Artï¼‰



### **æœ¯è¯­å…³ç³»å›¾**

```mermaid
graph LR
    A[ä¿¡æ¯æ£€ç´¢ IR] --> B[æ’å Ranking]
    B --> C[Fusion èåˆ]
    C --> D[RRF]
    C --> E[Condorcet]
    C --> F[CombMNZ]
    B --> G[Learning to Rank]
    G --> H[RankSVM]
    G --> I[ListNet]
    G --> J[AdaRank]
    C --> K[Meta-Learner]
    K --> L[RRF + LTR = æ–°SOTA]
    D --> K
    H --> K
    I --> K
```



### âœ… æ€»ç»“

è¿™ç¯‡è®ºæ–‡çš„è´¡çŒ®å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š

> **æå‡ºäº†ä¸€ç§æå…¶ç®€å•ä½†å¼‚å¸¸æœ‰æ•ˆçš„èåˆæ–¹æ³• RRFï¼Œå®ƒæ— éœ€è®­ç»ƒã€ä¸ä¾èµ–å¾—åˆ†ã€è®¡ç®—é«˜æ•ˆï¼Œåœ¨å¤šä¸ªä»»åŠ¡ä¸Šè¶…è¶Šäº†å¤æ‚çš„å­¦ä¹ æ’åºæ¨¡å‹å’Œä¼ ç»Ÿèåˆæ–¹æ³•ï¼Œæˆä¸ºæ–°çš„â€œå…ƒå­¦ä¹ â€æ ‡æ†ã€‚**

ğŸ¯ å¯ç¤ºï¼š
- æœ‰æ—¶å€™ï¼Œâ€œç®€å•â€æ¯”â€œå¤æ‚â€æ›´å¼ºå¤§
- èåˆå¤šæ ·æ€§æ˜¯æå‡æ€§èƒ½çš„å…³é”®
- æ’åæœ¬èº«è•´å«ä¸°å¯Œä¿¡æ¯ï¼Œå€¼å¾—æ·±å…¥æŒ–æ˜

 

å¦‚æœä½ æ­£åœ¨åšæœç´¢ã€æ¨èæˆ–æ’åºç³»ç»Ÿï¼Œ**RRF æ˜¯ä¸€ä¸ªå¿…é¡»å°è¯•çš„ baseline æ–¹æ³•**ã€‚
  
## å‚è€ƒ        
         
https://plg.uwaterloo.ca/~gvcormac/cormacksigir09-rrf.pdf  
    
<b> ä»¥ä¸Šå†…å®¹åŸºäºDeepSeekã€Qwenã€GeminiåŠè¯¸å¤šAIç”Ÿæˆ, è½»å¾®äººå·¥è°ƒæ•´, æ„Ÿè°¢æ­å·æ·±åº¦æ±‚ç´¢äººå·¥æ™ºèƒ½ã€é˜¿é‡Œäº‘ã€Googleç­‰å…¬å¸. </b>        
        
<b> AI ç”Ÿæˆçš„å†…å®¹è¯·è‡ªè¡Œè¾¨åˆ«æ­£ç¡®æ€§, å½“ç„¶ä¹Ÿå¤šäº†äº›è®¸è¸©å‘çš„ä¹è¶£, æ¯•ç«Ÿå†’é™©æ˜¯æ¯ä¸ªç”·äººçš„å¤©æ€§.  </b>        
    
  
  
#### [æœŸæœ› PostgreSQL|å¼€æºPolarDB å¢åŠ ä»€ä¹ˆåŠŸèƒ½?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB å¼€æºæ•°æ®åº“](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB å­¦ä¹ å›¾è°±](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [PostgreSQL è§£å†³æ–¹æ¡ˆé›†åˆ](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [å¾·å“¥ / digoal's Github - å…¬ç›Šæ˜¯ä¸€è¾ˆå­çš„äº‹.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About å¾·å“¥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
