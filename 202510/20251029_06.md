## AIè®ºæ–‡è§£è¯» | XIndex: A Scalable Learned Index for Multicore Data Storage
        
### ä½œè€…        
digoal        
        
### æ—¥æœŸ        
2025-10-29        
        
### æ ‡ç­¾        
PostgreSQL , PolarDB , DuckDB , AI , è®ºæ–‡è§£è¯»        
        
----        
        
## èƒŒæ™¯  
      
https://dl.acm.org/doi/pdf/10.1145/3332466.3374547        
  
æç¤º:          
```          
è¯»æ‡‚ã€ŠXIndex: A Scalable Learned Index for Multicore Data Storageã€‹è¿™ç¯‡è®ºæ–‡éœ€è¦æå‰æŒæ¡å“ªäº›åŸºç¡€çŸ¥è¯†, è¯·ä½¿ç”¨ä¸­æ–‡é€šç†Ÿæ˜“æ‡‚çš„è®²è§£è¿™äº›åŸºç¡€çŸ¥è¯†, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§. 
  
ä½¿ç”¨ä¸­æ–‡é€šç†Ÿæ˜“æ‡‚çš„è§£è¯»ã€ŠXIndex: A Scalable Learned Index for Multicore Data Storageã€‹è¿™ç¯‡è®ºæ–‡, å…¶ä¸­çš„å…³é”®å†…å®¹è¯·ç€é‡è®²è§£, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§. 
  
æå–ã€ŠXIndex: A Scalable Learned Index for Multicore Data Storageã€‹è¿™ç¯‡è®ºæ–‡ä¸­çš„é‡è¦æœ¯è¯­, ä½¿ç”¨ä¸­æ–‡å¯¹è¿™äº›æœ¯è¯­è¿›è¡Œé€šç†Ÿæ˜“æ‡‚çš„è®²è§£, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§. 
```     
  
## 1 å‰ç½®çŸ¥è¯† 
  
ç†è§£è¿™ç¯‡è®ºæ–‡ã€ŠXIndex: A Scalable Learned Index for Multicore Data Storageã€‹ç¡®å®éœ€è¦ä¸€äº›è·¨å­¦ç§‘çš„çŸ¥è¯†ã€‚ç®€å•æ¥è¯´ï¼Œ**XIndex æ˜¯ä¸€ç§åœ¨å¤šæ ¸ CPU ä¸Šè¿è¡Œå¾—éå¸¸å¿«çš„æ–°å‹æ•°æ®åº“ç´¢å¼•**ã€‚

å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯â€œå­¦ä¹ å‹â€ï¼ˆLearnedï¼‰ï¼Œå³ç”¨ AI æ¨¡å‹æ¥â€œçŒœâ€æ•°æ®åœ¨å“ªï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿç´¢å¼•é‚£æ ·ä¸€æ­¥æ­¥â€œæŸ¥â€ã€‚åŒæ—¶ï¼Œå®ƒè¿˜è§£å†³äº†ä¸€ä¸ªå¤§éš¾é¢˜ï¼šå¦‚ä½•è®©è¿™ç§â€œå­¦ä¹ å‹ç´¢å¼•â€åœ¨å¾ˆå¤šäººï¼ˆå¤šæ ¸ï¼‰åŒæ—¶è¯»å†™æ•°æ®ï¼ˆå¹¶å‘ï¼‰æ—¶ä¸å‡ºé”™ï¼Œå¹¶ä¸”é€Ÿåº¦ä¾ç„¶å¾ˆå¿«ã€‚

ä¸ºäº†å¸®åŠ©ä½ é€å½»ç†è§£è¿™ç¯‡è®ºæ–‡ï¼Œä½ éœ€è¦æå‰æŒæ¡ä»¥ä¸‹å‡ ä¸ªé¢†åŸŸçš„åŸºç¡€çŸ¥è¯†ï¼š

---

### 1. æ ¸å¿ƒçŸ¥è¯†ï¼šæ•°æ®ç»“æ„ï¼ˆç´¢å¼•ï¼‰

ä½ é¦–å…ˆéœ€è¦çŸ¥é“**ä»€ä¹ˆæ˜¯ç´¢å¼•**ï¼Œä»¥åŠæœ€ç»å…¸çš„ç´¢å¼•ç»“æ„ **B-Tree (Bæ ‘)**ã€‚

* **ç´¢å¼• (Index):** å°±åƒä¸€æœ¬ä¹¦çš„ç›®å½•ã€‚æ²¡æœ‰ç›®å½•ï¼Œä½ æ‰¾ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼ˆæ•°æ®ï¼‰å°±å¾—ä»ç¬¬ä¸€é¡µç¿»åˆ°æœ€åä¸€é¡µã€‚æœ‰äº†ç›®å½•ï¼Œä½ å¯ä»¥å¿«é€Ÿå®šä½åˆ°ç« èŠ‚ï¼Œç„¶åå†æ‰¾å…·ä½“çš„é¡µç ã€‚ç´¢å¼•å°±æ˜¯æ•°æ®åº“ä¸­ç”¨æ¥åŠ é€ŸæŸ¥è¯¢çš„æ•°æ®ç»“æ„ã€‚
* **B-Tree (Bæ ‘):** è¿™æ˜¯å‡ åå¹´æ¥æ•°æ®åº“ç´¢å¼•çš„â€œæ ‡å‡†ç­”æ¡ˆâ€ã€‚å®ƒæ˜¯ä¸€ç§â€œå¤šè·¯å¹³è¡¡æœç´¢æ ‘â€ã€‚
    * **é€šä¿—ç†è§£ï¼š** æƒ³è±¡ä¸€ä¸ªå¤šå±‚çš„æ ‘çŠ¶æ–‡ä»¶æŸœã€‚
    * é¡¶å±‚ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰æœ‰å‡ ä¸ªæŠ½å±‰ï¼Œæ ‡ç­¾æ˜¯ [A-G], [H-N], [O-Z]ã€‚
    * ä½ è¦æ‰¾ "Smith"ï¼Œä½ æ‰“å¼€ [O-Z] æŠ½å±‰ã€‚
    * é‡Œé¢åˆåˆ†äº† [O-Q], [R-T], [U-Z]ã€‚
    * ä½ æ‰“å¼€ [R-T]ï¼Œæœ€ååœ¨é‡Œé¢æ‰¾åˆ°äº† "Smith" çš„æ¡£æ¡ˆã€‚
    * Bæ ‘çš„ç‰¹ç‚¹æ˜¯è¿™æ£µâ€œæ ‘â€æ€»æ˜¯ä¿æŒ**å¹³è¡¡**çš„ï¼Œæ‰€ä»¥æ— è®ºä½ æŸ¥ä»€ä¹ˆæ•°æ®ï¼Œè¦â€œå¾€ä¸‹è·³â€çš„å±‚æ•°ï¼ˆæŸ¥è¯¢æ—¶é—´ï¼‰éƒ½åŸºæœ¬ä¸€æ ·ï¼Œéå¸¸ç¨³å®šã€‚è®ºæ–‡ä¸­ä¹Ÿæåˆ°äº† B æ ‘çš„å¤šå±‚ç»“æ„  å¹¶å°†å…¶ä½œä¸ºæ€§èƒ½å¯¹æ¯”çš„åŸºå‡† ã€‚

### 2. æ ¸å¿ƒçŸ¥è¯†ï¼šå­¦ä¹ å‹ç´¢å¼• (Learned Index)

è¿™æ˜¯ XIndex çš„ç†è®ºåŸºç¡€ï¼Œæºè‡ªä¸€ç¯‡å¼€åˆ›æ€§è®ºæ–‡ ã€‚XIndex æ­£æ˜¯åŸºäºè¿™ä¸ªç†å¿µæ„å»ºçš„ ã€‚

* **æ ¸å¿ƒæ€æƒ³ï¼š** ä¼ ç»Ÿ B æ ‘æ˜¯ä¸€ä¸ªâ€œæ¨¡å‹â€ï¼Œå®ƒé€šè¿‡æ ‘å½¢ç»“æ„æ¥å¸®ä½ å®šä½æ•°æ®ã€‚è€Œâ€œå­¦ä¹ å‹ç´¢å¼•â€è®¤ä¸ºï¼Œç´¢å¼•ä¹Ÿå¯ä»¥è¢«çœ‹ä½œä¸€ä¸ª**é¢„æµ‹æ¨¡å‹**ï¼Œå®ƒèƒ½â€œå­¦ä¹ â€ä½ æ•°æ®çš„åˆ†å¸ƒè§„å¾‹ ã€‚
* **å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ**
    1.  **å­¦ä¹ åˆ†å¸ƒï¼š** æ¨¡å‹ä¼šå­¦ä¹ ä½ æ•°æ®çš„â€œç´¯ç§¯åˆ†å¸ƒå‡½æ•°â€ï¼ˆCDFï¼‰ã€‚
    2.  **é¢„æµ‹ä½ç½®ï¼š** å½“ä½ æŸ¥è¯¢ä¸€ä¸ªé”®ï¼ˆKeyï¼‰æ—¶ï¼Œæ¨¡å‹ä¸â€œæŸ¥æ‰¾â€ï¼Œè€Œæ˜¯â€œé¢„æµ‹â€è¿™ä¸ª Key åœ¨æ’å¥½åºçš„æ•°ç»„ä¸­**å¤§æ¦‚åœ¨ä»€ä¹ˆä½ç½®** ã€‚
    3.  **å¤„ç†è¯¯å·®ï¼š** é¢„æµ‹æ€»æœ‰è¯¯å·®ã€‚æ‰€ä»¥æ¨¡å‹ä¼šå‘Šè¯‰ä½ ä¸€ä¸ªâ€œè¯¯å·®èŒƒå›´â€ï¼ˆError Boundï¼‰ã€‚æ¯”å¦‚æ¨¡å‹é¢„æµ‹ "Smith" åœ¨ç¬¬ 1000 ä½ï¼Œè¯¯å·®æ˜¯ $\pm$5 ã€‚
    4.  **æœ€åæœç´¢ï¼š** ä½ åªéœ€è¦åœ¨ `[995, 1005]` è¿™ä¸ªå°èŒƒå›´å†…ç”¨ä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚äºŒåˆ†æŸ¥æ‰¾ï¼‰ç²¾ç¡®å®šä½å°±è¡Œäº† ã€‚

* **RMI (Recursive Model Indexes):** ä¸ºäº†æé«˜é¢„æµ‹ç²¾åº¦ï¼Œå­¦ä¹ å‹ç´¢å¼•é€šå¸¸ä½¿ç”¨â€œé€’å½’æ¨¡å‹ç´¢å¼•â€ï¼ˆRMIï¼‰ã€‚è¿™å°±åƒ B æ ‘çš„å¤šå±‚ç»“æ„ ï¼š
    * ç¬¬ä¸€å±‚æ¨¡å‹ï¼ˆæ ¹ï¼‰ä¸ç›´æ¥é¢„æµ‹ä½ç½®ï¼Œè€Œæ˜¯é¢„æµ‹è¯¥ç”¨**å“ªä¸ª**ç¬¬äºŒå±‚æ¨¡å‹ ã€‚
    * ç¬¬äºŒå±‚æ¨¡å‹ï¼ˆå¶ï¼‰å†æ¥é¢„æµ‹æ•°æ®åœ¨æ•°ç»„ä¸­çš„å…·ä½“ä½ç½® ã€‚
    * XIndex çš„æ ¹èŠ‚ç‚¹å°±ç”¨äº†ä¸€ä¸ª RMI æ¨¡å‹ ã€‚

### 3. æ ¸å¿ƒçŸ¥è¯†ï¼šå¹¶å‘ç¼–ç¨‹ (Concurrent Programming)

è¿™æ˜¯ç†è§£ XIndex **ä¸ºä»€ä¹ˆâ€œå¯æ‰©å±•â€(Scalable)** çš„å…³é”®ã€‚åŸç‰ˆçš„å­¦ä¹ å‹ç´¢å¼•ä¸æ”¯æŒä¿®æ”¹ï¼ˆå†™å…¥ã€åˆ é™¤ï¼‰ï¼Œæ›´åˆ«æâ€œå¹¶å‘å†™å…¥â€äº†ã€‚XIndex çš„æ ¸å¿ƒè´¡çŒ®ä¹‹ä¸€å°±æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ ã€‚

ä½ éœ€è¦äº†è§£åœ¨å¤šæ ¸ CPU (Multicore) ä¸ŠåŒæ—¶è¯»å†™æ•°æ®ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠç»å…¸çš„è§£å†³æ–¹æ¡ˆï¼š

* **å¹¶å‘å†²çª (Data Race):** æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹Aï¼‰æ­£åœ¨å¤åˆ¶ä¸€ä»½æ•°æ®ï¼Œå‡†å¤‡åšä¿®æ”¹ï¼›ä¸æ­¤åŒæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹Bï¼‰ç›´æ¥åœ¨**åŸå§‹æ•°æ®**ä¸Šè¿›è¡Œäº†ä¿®æ”¹ã€‚
    * è®ºæ–‡ä¸­çš„ **å›¾ 2 ** å®Œç¾å±•ç¤ºäº†è¿™ä¸ªé—®é¢˜ï¼š  ![pic](20251029_06_pic_001.jpg)  
    * $op_2$ ï¼ˆæ¯”å¦‚åˆå¹¶æ“ä½œï¼‰å…ˆæŠŠ $r_1$ å¤åˆ¶åˆ°æ–°æ•°ç»„ ã€‚
    * $op_1$ ï¼ˆæ¯”å¦‚æ›´æ–°æ“ä½œï¼‰ç´§æ¥ç€ä¿®æ”¹äº†**æ—§æ•°ç»„**é‡Œçš„ $r_1$ ã€‚
    * $op_2$ å®Œæˆäº†å®ƒçš„å·¥ä½œï¼Œä½†å®ƒå¤åˆ¶çš„æ˜¯**æ—§**çš„ $r_1$ ã€‚
    * ç»“æœï¼š $op_1$ çš„æ›´æ–°**ä¸¢å¤±äº†** ã€‚

* **ä½ éœ€è¦äº†è§£çš„å¹¶å‘æŠ€æœ¯ï¼š** XIndex ç»¼åˆè¿ç”¨äº†å¤šç§ç»å…¸æŠ€æœ¯ ã€‚
    * **é” (Locking):** æœ€ç®€å•çš„åŠæ³•ã€‚è°è¦ä¿®æ”¹æ•°æ®ï¼Œè°å°±å…ˆâ€œä¸Šé”â€ï¼Œåˆ«äººä¸å‡†åŠ¨ ã€‚XIndex ä½¿ç”¨äº†â€œç»†ç²’åº¦é”â€(Fine-grained locking)ï¼Œåªé”ä½è¦ä¿®æ”¹çš„é‚£ä¸€å°å—æ•°æ®ï¼ˆæ¯”å¦‚å•ä¸ªè®°å½• ï¼‰ï¼Œè€Œä¸æ˜¯é”ä½æ•´ä¸ªç´¢å¼•ï¼Œä»è€Œæé«˜æ•ˆç‡ ã€‚
    * **ä¹è§‚å¹¶å‘æ§åˆ¶ (OCC):** â€œå…ˆå¹²æ´»ï¼Œå†æ£€æŸ¥â€ã€‚çº¿ç¨‹ä»¬â€œä¹è§‚â€åœ°å‡è®¾è‡ªå·±ä¸ä¼šå’Œåˆ«äººå†²çªã€‚åœ¨æœ€åæäº¤ä¿®æ”¹æ—¶ï¼Œæ‰æ£€æŸ¥æ•°æ®ç‰ˆæœ¬å·ï¼ˆ`version` ï¼‰ã€‚å¦‚æœå‘ç°æ•°æ®å·²ç»è¢«åˆ«äººæ”¹äº†ï¼Œå°±æ”¾å¼ƒæœ¬æ¬¡ä¿®æ”¹ï¼Œä»å¤´å†è¯•ä¸€æ¬¡ ã€‚
    * **RCU (Read-Copy-Update, è¯»-å¤åˆ¶-æ›´æ–°):** è¿™æ˜¯ä¸ªå¾ˆé…·çš„æŠ€æœ¯ ã€‚å®ƒèƒ½è®©â€œè¯»â€æ“ä½œ **å®Œå…¨ä¸éœ€è¦ç­‰å¾…** â€œå†™â€æ“ä½œã€‚
        * **é€šä¿—ç†è§£ï¼š** å½“ä½ è¦ä¿®æ”¹æ•°æ®æ—¶ï¼Œä½ **ä¸**åœ¨åŸåœ°ä¿®æ”¹ã€‚
        1.  ä½ å…ˆ**å¤åˆ¶**ä¸€ä»½æ•°æ®ã€‚
        2.  åœ¨**å‰¯æœ¬**ä¸Šè¿›è¡Œä¿®æ”¹ã€‚
        3.  ä¿®æ”¹å®Œæˆåï¼Œä½ ï¼ˆåŸå­åœ°ï¼‰æŠŠæŒ‡å‘æ•°æ®çš„**æŒ‡é’ˆ**ä»æ—§æ•°æ®â€œåˆ‡æ¢â€åˆ°æ–°å‰¯æœ¬ä¸Šã€‚
        * åœ¨è¿™æœŸé—´ï¼Œè€çš„â€œè¯»â€çº¿ç¨‹å¯ä»¥ç»§ç»­è®¿é—®æ—§æ•°æ®ï¼›æ–°çš„â€œè¯»â€çº¿ç¨‹ä¼šè‡ªåŠ¨è®¿é—®æ–°æ•°æ®ã€‚ç­‰æ‰€æœ‰è®¿é—®æ—§æ•°æ®çš„çº¿ç¨‹éƒ½å®Œæˆåï¼Œç³»ç»Ÿå†å®‰å…¨åœ°åˆ é™¤æ—§æ•°æ®ã€‚XIndex çš„åˆå¹¶æ“ä½œå°±ä¸¥é‡ä¾èµ– RCU å±éšœï¼ˆRCU barrierï¼‰ã€‚

### 4. æ•°æ®åº“/å­˜å‚¨ç³»ç»Ÿæ¦‚å¿µ

æœ€åï¼Œä½ éœ€è¦äº†è§£ä¸€äº›é«˜æ€§èƒ½å­˜å‚¨ç³»ç»Ÿï¼ˆå°¤å…¶æ˜¯é”®å€¼å­˜å‚¨ï¼ŒKey-Value Storeï¼‰æ˜¯å¦‚ä½•å¤„ç†â€œå†™å…¥â€çš„ã€‚

* **Delta Index (å¢é‡ç´¢å¼•):**
    * ç›´æ¥ä¿®æ”¹ä¸€ä¸ªæ’å¥½åºçš„å¤§æ•°ç»„æ˜¯éå¸¸æ…¢çš„ï¼ˆå› ä¸ºè¦ç§»åŠ¨å¤§é‡æ•°æ®ï¼‰ã€‚
    * XIndex çš„åšæ³•æ˜¯ï¼š **æ›´æ–°æ“ä½œï¼ˆUpdateï¼‰** ç›´æ¥åœ¨åŸåœ°æ”¹ï¼ˆin-placeï¼‰ã€‚ **æ’å…¥æ“ä½œï¼ˆInsertï¼‰** åˆ™å…ˆå†™å…¥ä¸€ä¸ªå« `Delta Index`ï¼ˆå¢é‡ç´¢å¼•ï¼‰çš„â€œå°æœ¬æœ¬â€ä¸Š ã€‚
    * è¿™å¯ä»¥åœ¨è®ºæ–‡ **å›¾ 3** çš„æ¶æ„ä¸­çœ‹åˆ°ï¼Œæ¯ä¸ª `group node`ï¼ˆåˆ†ç»„èŠ‚ç‚¹ï¼‰éƒ½åŒ…å« `Data Array`ï¼ˆä¸»æ•°æ®ï¼‰å’Œ `Delta Index`ï¼ˆå¢é‡æ•°æ®ï¼‰ã€‚  ![pic](20251029_06_pic_002.jpg)  
    * æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»å…ˆæŸ¥ `Data Array`ï¼Œå¦‚æœæ²¡æŸ¥åˆ°ï¼Œå†æŸ¥ `Delta Index` ã€‚

* **Compaction (åˆå¹¶):**
    * â€œå°æœ¬æœ¬â€(`Delta Index`) ä¸èƒ½æ— é™å¢å¤§ï¼Œå¦åˆ™æŸ¥è¯¢ä¼šå˜æ…¢ã€‚
    * `Compaction`ï¼ˆåˆå¹¶ï¼‰ å°±æ˜¯ä¸€ä¸ªåå°è¿‡ç¨‹ï¼Œå®ƒä¼šå®šæœŸæŠŠ `Delta Index` é‡Œçš„æ–°æ•°æ®å’Œ `Data Array` é‡Œçš„è€æ•°æ®**åˆå¹¶**ï¼Œç”Ÿæˆä¸€ä¸ª**æ–°**çš„ã€æ’å¥½åºçš„ `Data Array` ã€‚

* **Two-Phase Compaction (ä¸¤é˜¶æ®µåˆå¹¶):**
    * è¿™æ˜¯ XIndex çš„**æ ¸å¿ƒåˆ›æ–°** ï¼Œå®ƒç”¨æ¥è§£å†³**å›¾ 2 ** ä¸­çš„â€œæ›´æ–°ä¸¢å¤±â€é—®é¢˜ã€‚  ![pic](20251029_06_pic_001.jpg)  
    * **å›¾ 4 ** å±•ç¤ºäº†è¿™ä¸ªè¿‡ç¨‹ï¼š  ![pic](20251029_06_pic_003.jpg)  
    1.  **é˜¶æ®µ 1 (Merge Phase):** åˆ›å»ºæ–°æ•°ç»„ï¼Œä½†ä¸ç›´æ¥å¤åˆ¶æ•°æ®ï¼Œè€Œæ˜¯å­˜å…¥æŒ‡å‘æ—§æ•°æ®çš„**æŒ‡é’ˆ** ã€‚
    2.  **RCU å±éšœ:** ç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½â€œçœ‹åˆ°â€è¿™ä¸ªæ–°çš„æŒ‡é’ˆæ•°ç»„ ã€‚
    3.  **é˜¶æ®µ 2 (Copy Phase):** éå†æ–°æ•°ç»„ï¼Œé€šè¿‡æŒ‡é’ˆæŠŠæ•°æ®**çœŸæ­£å¤åˆ¶**è¿‡æ¥ ã€‚
    * **å¦™å¤„ä½•åœ¨ï¼Ÿ** å¦‚æœåœ¨é˜¶æ®µ 1 å’Œé˜¶æ®µ 2 ä¹‹é—´ï¼Œæœ‰ä¸ªå¹¶å‘çº¿ç¨‹ï¼ˆå¦‚å›¾ 4 ä¸­çš„ `concurrent operations`ï¼‰ä¿®æ”¹äº† $r_1$ ï¼Œæ²¡å…³ç³»ã€‚åˆ°é˜¶æ®µ 2 å¤åˆ¶æ—¶ï¼Œå®ƒä¼šé€šè¿‡æŒ‡é’ˆè¯»åˆ°**æœ€æ–°**çš„ $r_1$ å€¼ï¼Œå¹¶å°†å…¶å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ ã€‚è¿™æ ·ï¼Œæ›´æ–°å°±ä¸ä¼šä¸¢å¤±äº† ã€‚

### æ€»ç»“

ä½ éœ€è¦çš„åŸºç¡€çŸ¥è¯†å’Œå®ƒä»¬åœ¨è®ºæ–‡ä¸­çš„åº”ç”¨å¯ä»¥ç”¨ä¸‹è¡¨æ¦‚æ‹¬ï¼š

| åŸºç¡€çŸ¥è¯†é¢†åŸŸ | å…³é”®æ¦‚å¿µ | åœ¨è®ºæ–‡ä¸­çš„åº”ç”¨ï¼ˆä¸ºä»€ä¹ˆä½ éœ€è¦æ‡‚ï¼‰ |
| :--- | :--- | :--- |
| **æ•°æ®ç»“æ„** | B-Tree (Bæ ‘) | ç´¢å¼•çš„åŸºç¡€ã€‚XIndex æ˜¯ B æ ‘çš„ä¸€ç§æ¼”è¿›ï¼Œä¹Ÿæ˜¯è®ºæ–‡çš„æ ¸å¿ƒæ€§èƒ½å¯¹æ¯”å¯¹è±¡ ã€‚ |
| **æœºå™¨å­¦ä¹ ** | çº¿æ€§æ¨¡å‹ã€CDF (ç´¯ç§¯åˆ†å¸ƒå‡½æ•°) | â€œå­¦ä¹ å‹ç´¢å¼•â€çš„æ ¸å¿ƒã€‚XIndex ç”¨è¿™äº›æ¨¡å‹æ¥**é¢„æµ‹**æ•°æ®ä½ç½® ã€‚ |
| **å¹¶å‘ç¼–ç¨‹** | é”ã€RCUã€OCCã€æ•°æ®ç«äº‰ | XIndex çš„æ ¸å¿ƒå–ç‚¹ã€‚å®ƒä¸ºâ€œå­¦ä¹ å‹ç´¢å¼•â€æä¾›äº†é«˜å¹¶å‘ã€å¯æ‰©å±•çš„è¯»å†™èƒ½åŠ› ã€‚ |
| **æ•°æ®åº“ç³»ç»Ÿ** | å¢é‡ç´¢å¼• (Delta Index)ã€åˆå¹¶ (Compaction) | XIndex å¤„ç†â€œå†™å…¥â€çš„æœºåˆ¶ã€‚å®ƒé€šè¿‡â€œä¸¤é˜¶æ®µåˆå¹¶â€è§£å†³äº†å¹¶å‘å†™å…¥æ—¶çš„â€œæ›´æ–°ä¸¢å¤±â€é—®é¢˜ ã€‚ |

æŒæ¡äº†è¿™äº›ï¼Œä½ å°±èƒ½æ˜ç™½ XIndex æ˜¯å¦‚ä½•å·§å¦™åœ°å°† AI é¢„æµ‹ã€å¹¶å‘æ§åˆ¶å’Œä¼ ç»Ÿæ•°æ®åº“æŠ€æœ¯ç»“åˆèµ·æ¥ï¼Œåˆ›é€ å‡ºä¸€ä¸ªé«˜æ€§èƒ½ç´¢å¼•çš„ã€‚

å¸Œæœ›è¿™ä»½æŒ‡å—å¯¹ä½ æœ‰å¸®åŠ©ï¼ä½ æ˜¯å¦æƒ³è®©æˆ‘æ·±å…¥è§£é‡Šä¸€ä¸‹ "RCU (è¯»-å¤åˆ¶-æ›´æ–°)" æˆ– "ä¸¤é˜¶æ®µåˆå¹¶" çš„å·¥ä½œç»†èŠ‚ï¼Ÿ
  
## 2 è§£è¯»è®ºæ–‡ 
  
å¥½çš„ï¼Œè¿™æ˜¯ä¸€ç¯‡éå¸¸ç»å…¸çš„ç³»ç»Ÿè®ºæ–‡ã€‚æˆ‘ä¼šä¸ºä½ é€šä¿—æ˜“æ‡‚åœ°è§£è¯»ã€ŠXIndexã€‹ï¼Œå¹¶é‡ç‚¹è®²è§£å®ƒçš„æ ¸å¿ƒåˆ›æ–°ã€‚

### ä¸€å¥è¯æ€»ç»“ XIndexï¼š

XIndex æ˜¯ä¸€ç§ **â€œæ—¢èªæ˜åˆçµæ´»â€** çš„æ–°å‹æ•°æ®åº“ç´¢å¼•ã€‚

  * **â€œèªæ˜â€** æ˜¯å› ä¸ºå®ƒåƒ AlphaGo ä¸€æ ·ï¼Œä½¿ç”¨**æœºå™¨å­¦ä¹ æ¨¡å‹**æ¥â€œå­¦ä¹ â€æ•°æ®çš„åˆ†å¸ƒè§„å¾‹ï¼Œä»è€Œèƒ½åƒâ€œçŒœâ€ä¸€æ ·å¿«é€Ÿå®šä½æ•°æ® ã€‚
  * **â€œçµæ´»â€** æ˜¯å› ä¸ºå®ƒè§£å†³äº†â€œå­¦ä¹ å‹ç´¢å¼•â€çš„ä¸¤ä¸ªè‡´å‘½å¼±ç‚¹ï¼šå®ƒ**æ”¯æŒé«˜å¹¶å‘çš„è¯»å†™** ï¼Œå¹¶ä¸”èƒ½**åœ¨è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´ç»“æ„**ä»¥é€‚åº”æ•°æ®å˜åŒ– ã€‚

-----

### 1\. XIndex è¦è§£å†³ä»€ä¹ˆâ€œç—›ç‚¹â€ï¼Ÿ

è¦ç†è§£ XIndexï¼Œæˆ‘ä»¬å¿…é¡»å…ˆçŸ¥é“å®ƒâ€œé©å‘½â€çš„å¯¹è±¡ï¼š

  * **ä¼ ç»Ÿç´¢å¼• (å¦‚ B-Tree)ï¼š** åƒä¸€æœ¬ä¹¦çš„â€œå¤šçº§ç›®å½•â€ã€‚å®ƒéå¸¸ç¨³å®šã€å¯é ï¼Œæ”¯æŒå¢åˆ æ”¹æŸ¥ã€‚ä½†æ— è®ºæ•°æ®é•¿ä»€ä¹ˆæ ·ï¼Œå®ƒéƒ½ä¸€å±‚ä¸€å±‚åœ°å¾€ä¸‹æŸ¥ï¼Œæœ‰ç‚¹â€œæ­»æ¿â€ã€‚
  * **å­¦ä¹ å‹ç´¢å¼• (Learned Index)ï¼š** è¿™æ˜¯ XIndex çš„â€œç†è®ºåŸºç¡€â€ã€‚å®ƒæå‡ºä¸€ä¸ªé©å‘½æ€§æƒ³æ³•ï¼šç´¢å¼•æœ¬è´¨ä¸Šä¸å°±æ˜¯ä¸ªå‡½æ•°å—ï¼Ÿ`f(key) = position`ï¼ˆè¾“å…¥ä¸€ä¸ªé”®ï¼Œè¿”å›å®ƒåœ¨ç£ç›˜ä¸Šçš„ä½ç½®ï¼‰ã€‚
      * è¿™ä¸ªå‡½æ•° `f` éš¾é“ä¸èƒ½ç”¨ä¸€ä¸ª AI æ¨¡å‹ï¼ˆæ¯”å¦‚ç¥ç»ç½‘ç»œï¼‰æ¥â€œæ‹Ÿåˆâ€å—ï¼Ÿ
      * å¦‚æœæ•°æ®å¾ˆæœ‰è§„å¾‹ï¼ˆæ¯”å¦‚ 1, 2, 3...ï¼‰ï¼Œæ¨¡å‹ä¸€ä¸‹å°±å­¦ä¼šäº†ï¼ŒæŸ¥è¯¢æ•ˆç‡è¿œè¶… B-Tree ã€‚

**ä½†æ˜¯ï¼Œè¿™ä¸ªâ€œèªæ˜â€çš„â€œå­¦ä¹ å‹ç´¢å¼•â€æœ‰ä¸¤å¤§â€œè‡´å‘½ç—›ç‚¹â€ï¼š**

1.  **â€œåªä¼šè¯»ï¼Œä¸ä¼šå†™â€ï¼ˆåªè¯»æ€§ï¼‰ï¼š**

      * æ¨¡å‹ä¸€æ—¦è®­ç»ƒå¥½ï¼Œæ˜¯åŸºäºâ€œæ’å¥½åºçš„é™æ€æ•°ç»„â€çš„ ã€‚
      * å¦‚æœä½ æƒ³æ’å…¥ä¸€æ¡æ–°æ•°æ®ï¼ˆæ¯”å¦‚åœ¨ 1 å’Œ 2 ä¹‹é—´æ’å…¥ 1.5ï¼‰ï¼Œæ•´ä¸ªæ•°ç»„å°±ä¹±äº†ï¼Œæ¨¡å‹å°±â€œå¤±æ•ˆâ€äº†ï¼Œå¿…é¡»**é‡æ’æ•°æ®å¹¶é‡æ–°è®­ç»ƒæ¨¡å‹** ã€‚è¿™åœ¨çœŸå®æ•°æ®åº“é‡Œæ˜¯ä¸å¯æ¥å—çš„ã€‚

2.  **â€œå¹¶å‘å™©æ¢¦â€ï¼ˆå¹¶å‘æ€§å·®ï¼‰ï¼š**

      * å°±ç®—æˆ‘ä»¬æƒ³åŠæ³•è®©å®ƒæ”¯æŒå†™å…¥ï¼ˆæ¯”å¦‚å…ˆå†™åˆ°æ—è¾¹çš„å°æœ¬æœ¬ä¸Šï¼‰ï¼Œåœ¨å¤šæ ¸ CPU ä¸Šï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™æ—¶ï¼Œä¼šäº§ç”Ÿæ•°æ®å†²çªã€‚
      * **è®ºæ–‡ä¸­çš„å›¾ 2**  å®Œç¾å±•ç¤ºäº†è¿™ä¸ªé—®é¢˜ï¼šä¸€ä¸ªâ€œæ›´æ–°æ“ä½œâ€ ( $op_1$ ) å¯èƒ½ä¼š**ä¸¢å¤±**ï¼  ![pic](20251029_06_pic_001.jpg)  
          * ä¸€ä¸ªåå°çº¿ç¨‹ ( $op_2$ ) æ­£åœ¨åˆå¹¶æ•°æ®ï¼Œå®ƒåˆšæŠŠæ—§æ•°æ® $r_1$ å¤åˆ¶åˆ°æ–°ä½ç½® ã€‚
          * å‡ ä¹åŒæ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çº¿ç¨‹ ( $op_1$ ) æ›´æ–°äº†**æ—§ä½ç½®**çš„ $r_1$ ã€‚
          * åå°çº¿ç¨‹ $op_2$ ä¸çŸ¥é“è¿™ä»¶äº‹ï¼Œå®ƒç»§ç»­å·¥ä½œã€‚
          * **ç»“æœï¼š** ç”¨æˆ· $op_1$ çš„æ›´æ–°æ°¸ä¹…ä¸¢å¤±äº†ã€‚

3.  **â€œçœ‹å¤©åƒé¥­â€ï¼ˆå¯¹æ•°æ®åˆ†å¸ƒæ•æ„Ÿï¼‰ï¼š**

      * æ¨¡å‹çš„é¢„æµ‹ç²¾åº¦ä¾èµ–æ•°æ®åˆ†å¸ƒã€‚å¦‚æœæ•°æ®åˆ†å¸ƒå¾ˆå‡åŒ€ï¼Œå®ƒè¡¨ç°å¾ˆå¥½ã€‚
      * **å¦‚è¡¨ 1 æ‰€ç¤º** ï¼Œåœ¨ä¸€äº›â€œçƒ­ç‚¹æ•°æ®â€é«˜åº¦é›†ä¸­çš„åœºæ™¯ä¸‹ï¼ˆSkewed 1 å’Œ Skewed 3ï¼‰ï¼Œå®ƒçš„é¢„æµ‹è¯¯å·®æå¤§ï¼Œå¯¼è‡´æ€§èƒ½åè€Œ**ä¸å¦‚**ä¼ ç»Ÿçš„ B-Tree ã€‚  ![pic](20251029_06_pic_004.jpg)  

**XIndex çš„ç›®æ ‡ï¼š** åˆ›é€ ä¸€ä¸ªç´¢å¼•ï¼Œæ—¢äº«å—â€œå­¦ä¹ å‹ç´¢å¼•â€çš„æŸ¥è¯¢é€Ÿåº¦ï¼Œåˆå½»åº•è§£å†³ä¸Šè¿°çš„â€œå†™å…¥â€ã€â€œå¹¶å‘â€å’Œâ€œæ•æ„Ÿâ€ä¸‰å¤§éš¾é¢˜ã€‚

-----

### 2\. XIndex çš„ä¸‰å¤§æ ¸å¿ƒåˆ›æ–°ï¼ˆæ³•å®ï¼‰

XIndex çš„æ¶æ„å¦‚ **å›¾ 3** æ‰€ç¤º ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸¤å±‚ç»“æ„ï¼š`root node`ï¼ˆæ ¹èŠ‚ç‚¹ï¼Œæœ¬èº«æ˜¯ä¸ªå­¦ä¹ æ¨¡å‹ï¼‰ç”¨æ¥ç´¢å¼• `group nodes`ï¼ˆåˆ†ç»„èŠ‚ç‚¹ï¼‰ã€‚æ¯ä¸ªåˆ†ç»„èŠ‚ç‚¹ç®¡ç†è‡ªå·±çš„æ•°æ® ã€‚  ![pic](20251029_06_pic_002.jpg)  

ä¸ºäº†è§£å†³ä¸Šè¿°ç—›ç‚¹ï¼ŒXIndex æ‹¿å‡ºäº†ä¸‰ä¸ªæ³•å®ï¼š

#### æ³•å®ä¸€ï¼šå¢é‡ç´¢å¼• (Delta Index) - è§£å†³â€œå†™å…¥â€é—®é¢˜

è¿™å€Ÿé‰´äº†ä¼ ç»Ÿæ•°æ®åº“çš„åšæ³•ã€‚

  * **æ›´æ–° (Update)ï¼š** XIndex å¯¹å·²å­˜åœ¨çš„æ•°æ®ï¼Œç›´æ¥åœ¨åŸåœ°ä¿®æ”¹ (in-place) ã€‚
  * **æ’å…¥ (Insert)ï¼š** æ–°æ’å…¥çš„æ•°æ®ï¼Œä¸ç›´æ¥åŠ¨ä¸»æ•°æ® (`Data Array`)ï¼Œè€Œæ˜¯å…ˆå†™å…¥ä¸€ä¸ªå« `Delta Index` çš„â€œå°æœ¬æœ¬â€ï¼ˆå¢é‡ç´¢å¼•ï¼‰é‡Œ ã€‚
  * **åˆå¹¶ (Compaction)ï¼š** å½“â€œå°æœ¬æœ¬â€å†™æ»¡äº†ï¼Œåå°çº¿ç¨‹ä¼šå¯åŠ¨â€œåˆå¹¶â€ç¨‹åºï¼ŒæŠŠ `Delta Index` å’Œ `Data Array` åˆå¹¶æˆä¸€ä¸ªæ–°çš„ã€æ’å¥½åºçš„ `Data Array`ï¼Œå¹¶é‡æ–°è®­ç»ƒè¿™ä¸ª group çš„å­¦ä¹ æ¨¡å‹ ã€‚

è¿™å°±è§£å†³äº†â€œåªèƒ½è¯»ä¸èƒ½å†™â€çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œåœ¨â€œåˆå¹¶â€æ—¶ï¼Œæ³•å®äºŒå¿…é¡»ç™»åœºäº†ã€‚

#### æ³•å®äºŒï¼šä¸¤é˜¶æ®µåˆå¹¶ (Two-Phase Compaction) - è§£å†³â€œå¹¶å‘å†™å…¥â€é—®é¢˜

è¿™æ˜¯ XIndex **æœ€æ ¸å¿ƒçš„åˆ›æ–°**ï¼Œå®ƒæ¼‚äº®åœ°è§£å†³äº† **å›¾ 2** ä¸­çš„â€œæ›´æ–°ä¸¢å¤±â€é—®é¢˜ã€‚  ![pic](20251029_06_pic_001.jpg)  

**è¯·çœ‹å›¾ 4** ï¼Œå®ƒå±•ç¤ºäº†è¿™ä¸ªç²¾å¦™çš„è¿‡ç¨‹ï¼š ![pic](20251029_06_pic_003.jpg)  

1.  **é˜¶æ®µä¸€ï¼šåˆå¹¶é˜¶æ®µ (Merge Phase)**

      * åå°çº¿ç¨‹å¼€å§‹åˆå¹¶ã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªâ€œæ–°æ•°æ®æ•°ç»„â€(`New Data Array`)ã€‚
      * **å…³é”®ï¼š** å®ƒä¸ç›´æ¥å¤åˆ¶æ•°æ®ï¼Œè€Œæ˜¯éå†æ—§æ•°æ® (`Data Array`) å’Œå¢é‡æ•°æ® (`Delta Index`)ï¼Œåœ¨æ–°æ•°ç»„é‡Œ**åªå­˜æ”¾æŒ‡å‘æ—§æ•°æ®çš„â€œæŒ‡é’ˆâ€** ( e.g., $p\_1$ ) ã€‚

2.  **ï¼ˆå¹¶å‘æ“ä½œå‘ç”Ÿï¼‰**

      * å°±åœ¨é˜¶æ®µä¸€ç»“æŸã€é˜¶æ®µäºŒå¼€å§‹å‰ï¼Œä¸€ä¸ªç”¨æˆ·çº¿ç¨‹ï¼ˆå¦‚å›¾ 4 ä¸­çš„ `concurrent operations`ï¼‰è·‘è¿‡æ¥ï¼Œ**æ›´æ–°äº†**æ—§æ•°ç»„ä¸­çš„ $r\_1$ ï¼ˆ æŠŠå®ƒå˜æˆäº† $r\_1'$ ) ã€‚
      * æ³¨æ„ï¼Œå®ƒä¿®æ”¹çš„æ˜¯æ—§æ•°æ®ï¼Œè€Œæ–°æ•°ç»„é‡Œå­˜çš„æ˜¯æŒ‡é’ˆ $p\_1$ ï¼Œ $p\_1$ ä»ç„¶æŒ‡å‘ $r\_1$ çš„å†…å­˜åœ°å€ã€‚

3.  **é˜¶æ®µäºŒï¼šå¤åˆ¶é˜¶æ®µ (Copy Phase)**

      * åå°çº¿ç¨‹æ‰§è¡Œä¸€ä¸ª RCU å±éšœï¼ˆä¸€ç§åŒæ­¥æœºåˆ¶ï¼‰ï¼Œç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½çŸ¥é“æ–°æ•°ç»„çš„å­˜åœ¨ã€‚
      * ç„¶åï¼Œå®ƒå¼€å§‹éå†æ–°æ•°ç»„ï¼ˆé‡Œé¢å…¨æ˜¯â€œæŒ‡é’ˆâ€ï¼‰ã€‚å½“å®ƒå¤„ç† $p\_1$ æ—¶ï¼Œå®ƒä¼š**é€šè¿‡æŒ‡é’ˆå»è¯»å–æ•°æ®**ã€‚
      * æ­¤æ—¶ï¼Œå®ƒè¯»åˆ°çš„æ˜¯å·²ç»è¢«ç”¨æˆ·çº¿ç¨‹**æ›´æ–°è¿‡**çš„ $r\_1'$ ã€‚
      * å®ƒå°† $r_1'$ çœŸæ­£å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ï¼Œæ›¿æ¢æ‰æŒ‡é’ˆ $p\_1$ ã€‚

**ç»“æœï¼š** å¹¶å‘çš„æ›´æ–°æ“ä½œè¢«å®Œç¾åœ°ä¿ç•™äº†ä¸‹æ¥ ï¼Œ**å›¾ 2** çš„æ•°æ®ä¸¢å¤±é—®é¢˜è¢«å½»åº•è§£å†³ã€‚  ![pic](20251029_06_pic_001.jpg)  

#### æ³•å®ä¸‰ï¼šè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´ - è§£å†³â€œæ€§èƒ½æ•æ„Ÿâ€é—®é¢˜

ä¸ºäº†è§£å†³â€œçœ‹å¤©åƒé¥­â€çš„é—®é¢˜ï¼ŒXIndex ä¼šåœ¨è¿è¡Œæ—¶â€œè‡ªæˆ‘ä½“æ£€â€å’Œâ€œåŠ¨æ€å˜å½¢â€ã€‚

**è¯·çœ‹å›¾ 5**  å’Œ **è¡¨ 2** ï¼ŒXIndex ä¼šæ ¹æ®é¢„è®¾çš„é˜ˆå€¼ï¼ˆæ¯”å¦‚æœ€å¤§é¢„æµ‹è¯¯å·® `e`ã€å¢é‡ç´¢å¼•æœ€å¤§å°ºå¯¸ `s`ï¼‰æ¥è§¦å‘ä¸åŒçš„æ“ä½œï¼š   ![pic](20251029_06_pic_005.jpg)   ![pic](20251029_06_pic_006.jpg)  

```mermaid
graph TD
    A[ç›‘æµ‹ Group] --> B{é¢„æµ‹è¯¯å·® > e ?};
    B -- æ˜¯ --> C{æ¨¡å‹æ•° < m ?};
    C -- æ˜¯ --> D["a. æ¨¡å‹æ‹†åˆ† Model Split<br>(ä¸€ä¸ªæ¨¡å‹æ‹†æˆä¿©ï¼Œæé«˜ç²¾åº¦)"];
    C -- å¦ --> E["c. åˆ†ç»„æ‹†åˆ† Group Split<br>(æ¨¡å‹å¤ªå¤šï¼Œæ‹†æˆä¿©ç»„)"];
    B -- å¦ --> F{"è¯¯å·®å¾ˆå° (<= e*f) ?"};
    F -- æ˜¯ --> G["b. æ¨¡å‹åˆå¹¶ Model Merge<br>(ä¿©æ¨¡å‹åˆæˆä¸€ä¸ªï¼Œé™ä½å¼€é”€)"];
    
    A --> H{Deltaç´¢å¼•å¤§å° > s ?};
    H -- æ˜¯ --> I["d. åˆ†ç»„æ‹†åˆ† Group Split<br>(å°æœ¬æœ¬å¤ªæ»¡ï¼Œæ‹†æˆä¿©ç»„)"];
    
    A --> J{"...å…¶ä»–åˆå¹¶æ¡ä»¶..."};
    J --> K["e. åˆ†ç»„åˆå¹¶ Group Merge"];

    D & E & I & K --> L["f. æ ¹èŠ‚ç‚¹æ›´æ–° Root Update<br>(é‡æ–°è®­ç»ƒRMIæ ¹æ¨¡å‹)"];
```

  * **(a, c) æ¨¡å‹/åˆ†ç»„æ‹†åˆ†ï¼š** å½“ XIndex å‘ç°æŸä¸ª group çš„â€œçƒ­ç‚¹æ•°æ®â€å¤ªå¤šï¼Œå¯¼è‡´æ¨¡å‹é¢„æµ‹è¯¯å·®å¤ªå¤§ï¼ˆå¤§äºé˜ˆå€¼ `e`ï¼‰ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨è¿›è¡Œâ€œæ‹†åˆ†â€ï¼ˆModel Split æˆ– Group Splitï¼‰ã€‚æŠŠä¸€ä¸ªå¤§é—®é¢˜æ‹†æˆå‡ ä¸ªå°é—®é¢˜ï¼Œæ¯ä¸ªå°æ¨¡å‹å°±èƒ½å­¦å¾—æ›´å‡†ã€‚
  * **\_ (d) åˆ†ç»„æ‹†åˆ†ï¼š\_** å½“ `Delta Index`ï¼ˆå°æœ¬æœ¬ï¼‰å¤ªå¤§æ—¶ï¼Œä¹Ÿä¼šè§¦å‘æ‹†åˆ† ã€‚
  * **\_ (b, e) æ¨¡å‹/åˆ†ç»„åˆå¹¶ï¼š\_** åä¹‹ï¼Œå¦‚æœæ•°æ®å˜å¾—ç¨€ç–ï¼Œè¯¯å·®å¾ˆå°ï¼Œå®ƒä¼šâ€œåˆå¹¶â€ï¼ˆMergeï¼‰æ¨¡å‹æˆ–åˆ†ç»„ï¼Œå‡å°‘ç®¡ç†å¼€é”€ ã€‚

é€šè¿‡è¿™å¥—åŠ¨æ€è°ƒæ•´æœºåˆ¶ï¼ŒXIndex å§‹ç»ˆèƒ½å°†å…¶ç»“æ„é€‚é…äºå½“å‰çš„æ•°æ®åˆ†å¸ƒï¼Œä»è€Œä¿æŒé«˜æ€§èƒ½ã€‚

-----

### 3\. å®éªŒæ•ˆæœï¼šXIndex çœŸçš„å¿«å—ï¼Ÿ

æ˜¯çš„ï¼Œå®éªŒæ•°æ®è¯æ˜äº† XIndex çš„å…¨é¢èƒœåˆ©ã€‚

1.  **é«˜å¹¶å‘æ€§ (å›¾ 6, å›¾ 8)ï¼š**  ![pic](20251029_06_pic_007.jpg)  

      * åœ¨ TPC-Cï¼ˆæ¨¡æ‹ŸçœŸå®æ•°æ®åº“è´Ÿè½½ï¼‰å’Œ 10% å†™å…¥çš„åŸºå‡†æµ‹è¯•ä¸­ï¼ŒXIndexï¼ˆæ©™çº¿ï¼‰çš„æ€§èƒ½éšç€ CPU æ ¸å¿ƒæ•°ï¼ˆçº¿ç¨‹æ•°ï¼‰çš„å¢åŠ **å‡ ä¹çº¿æ€§å¢é•¿** ã€‚
      * è€Œå…¶ä»–æ–¹æ¡ˆï¼ˆå¦‚ Masstreeã€Learned+Î”ï¼‰å¾ˆå¿«å°±è¾¾åˆ°äº†ç“¶é¢ˆã€‚è¿™è¯æ˜äº† XIndex çš„å¹¶å‘æ§åˆ¶ï¼ˆç‰¹åˆ«æ˜¯ä¸¤é˜¶æ®µåˆå¹¶ï¼‰éå¸¸é«˜æ•ˆã€‚

2.  **é«˜åå (å›¾ 7, å›¾ 9)ï¼š**

      * åœ¨ YCSBï¼ˆæ ‡å‡†é”®å€¼å­˜å‚¨æµ‹è¯•ï¼‰ä¸­ï¼ŒXIndex åœ¨è¯»å†™æ··åˆï¼ˆA, Bï¼‰ã€åªè¯»ï¼ˆCï¼‰å’Œè¯»æ”¹å†™ï¼ˆFï¼‰è´Ÿè½½ä¸‹å‡è¡¨ç°ä¼˜å¼‚ ã€‚
      * åœ¨**å›¾ 9** ä¸­ï¼Œæ— è®ºå†™å…¥æ¯”ä¾‹æ˜¯ 10% è¿˜æ˜¯ 50%ï¼ŒXIndex çš„ååé‡ï¼ˆThroughputï¼‰å§‹ç»ˆæœ€é«˜ï¼Œä¸”è¯»å–å»¶è¿Ÿï¼ˆRead Latencyï¼‰å§‹ç»ˆæœ€ä½ ã€‚

3.  **å¼ºé€‚åº”æ€§ (å›¾ 11)ï¼š**  ![pic](20251029_06_pic_008.jpg)  

      * è¿™æ˜¯æœ€å…³é”®çš„å®éªŒã€‚ç ”ç©¶è€…æµ‹è¯•äº†ä¸€ä¸ªâ€œåŠ¨æ€å˜åŒ–â€çš„è´Ÿè½½ï¼š
      * åœ¨ç¬¬ 20 ç§’ï¼Œä»–ä»¬çªç„¶æ”¹å˜äº†æ•°æ®åˆ†å¸ƒï¼ˆä»æ­£æ€åˆ†å¸ƒåˆ‡æ¢åˆ°çº¿æ€§åˆ†å¸ƒï¼‰ã€‚
      * **Baseline (è“çº¿ï¼Œå…³é—­äº†åŠ¨æ€è°ƒæ•´)ï¼š** æ€§èƒ½ç«‹åˆ»å´©æºƒï¼Œå¹¶ä¸”ä¸€ç›´æ— æ³•æ¢å¤ã€‚
      * **XIndex (æ©™çº¿)ï¼š** æ€§èƒ½çŸ­æš‚ä¸‹é™åï¼Œåå°çº¿ç¨‹å¼€å§‹ç–¯ç‹‚è¿›è¡Œ `group split` å’Œ `group merge`ï¼ˆå¦‚å›¾ä¸­ä¸‹åŠéƒ¨åˆ†æ‰€ç¤ºï¼‰ã€‚
      * **ç»“æœï¼š** XIndex è¿…é€Ÿâ€œé€‚åº”â€äº†æ–°çš„æ•°æ®åˆ†å¸ƒï¼Œæ€§èƒ½åœ¨ç¬¬ 30 ç§’å°±å¼€å§‹å›å‡ï¼Œå¹¶æœ€ç»ˆ**å®ç°äº† 140% çš„æ€§èƒ½æå‡** ã€‚è¿™å®Œç¾è¯æ˜äº†å…¶â€œåŠ¨æ€è°ƒæ•´â€æœºåˆ¶çš„æœ‰æ•ˆæ€§ã€‚

### æ€»ç»“

XIndex é€šè¿‡ä¸‰å¤§åˆ›æ–°ï¼š**å¢é‡ç´¢å¼•**ã€**ä¸¤é˜¶æ®µåˆå¹¶** å’Œ **è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´**ï¼ŒæˆåŠŸåœ°å°†â€œå­¦ä¹ å‹ç´¢å¼•â€ä»ä¸€ä¸ªâ€œç†è®ºä¸Šå¾ˆå¿«çš„ç©å…·â€å˜æˆäº†ä¸€ä¸ªâ€œå¯åœ¨å¤šæ ¸ CPU ä¸Šç”¨äºçœŸå®æ•°æ®åº“çš„é«˜æ€§èƒ½ã€é«˜å¹¶å‘ç´¢å¼•â€ã€‚
  
## 3 æœ¯è¯­ 
  
ä»¥ä¸‹æ˜¯ä»ã€ŠXIndex: A Scalable Learned Index for Multicore Data Storageã€‹è¿™ç¯‡è®ºæ–‡ä¸­æå–çš„é‡è¦æœ¯è¯­åŠå…¶é€šä¿—è®²è§£ã€‚

-----

### 1\. æ ¸å¿ƒæ¦‚å¿µï¼šå­¦ä¹ å‹ç´¢å¼•

#### ğŸ”¹ Learned Index (å­¦ä¹ å‹ç´¢å¼•)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯ä¸€ç§â€œé¢ è¦†æ€§â€çš„ç´¢å¼•æ€æƒ³ ã€‚ä¼ ç»Ÿçš„ B-Tree ç´¢å¼•åƒä¸€æœ¬â€œå¤šçº§ç›®å½•â€ï¼Œä½ å¿…é¡»ä¸€å±‚å±‚å¾€ä¸‹ç¿»ï¼ˆA-G, H-N, O-Z...ï¼‰æ‰èƒ½æ‰¾åˆ°æ•°æ®ã€‚
    è€Œâ€œå­¦ä¹ å‹ç´¢å¼•â€æ›´åƒä¸€ä¸ªâ€œèªæ˜çš„é¢„è¨€å®¶â€ã€‚å®ƒé€šè¿‡**æœºå™¨å­¦ä¹ æ¨¡å‹**ï¼ˆæ¯”å¦‚çº¿æ€§å›å½’æˆ–ç¥ç»ç½‘ç»œï¼‰æ¥â€œå­¦ä¹ â€ä½ æ•°æ®çš„åˆ†å¸ƒè§„å¾‹ ã€‚
  * **å·¥ä½œæ–¹å¼ï¼š**
    å½“ä½ æŸ¥è¯¢ä¸€ä¸ªé”®ï¼ˆKeyï¼‰æ—¶ï¼Œå®ƒ**ä¸â€œæŸ¥æ‰¾â€ï¼Œè€Œæ˜¯â€œé¢„æµ‹â€** ã€‚â€œå˜¿ï¼Œæ ¹æ®æˆ‘çš„å­¦ä¹ ï¼Œä½ è¦æ‰¾çš„ 'Smith' åº”è¯¥åœ¨æ•°æ®æ•°ç»„çš„ç¬¬ 1000 ä¸ªä½ç½®é™„è¿‘ã€‚â€ è¿™ä¸€æ­¥åˆ°ä½ï¼Œå¯èƒ½æ¯” B-Tree çˆ¬å¥½å‡ å±‚æ¥¼å¿«å¾—å¤š ã€‚
  * **ç›¸å…³æœ¯è¯­ï¼šCDF (ç´¯ç§¯åˆ†å¸ƒå‡½æ•°)**
    è¿™æ˜¯â€œå­¦ä¹ â€çš„æ•°å­¦åŸç†ã€‚æ¨¡å‹å­¦ä¹ çš„å°±æ˜¯é”®çš„â€œç´¯ç§¯åˆ†å¸ƒå‡½æ•°â€ï¼ˆCDFï¼‰ï¼Œè¿™ä¸ªå‡½æ•°èƒ½å‘Šè¯‰ä½ â€œå°äºç­‰äºæŸä¸ªé”®çš„æ•°æ®å äº†æ€»æ•°æ®çš„ç™¾åˆ†ä¹‹å‡ â€ï¼Œä»è€Œç›´æ¥æ˜ å°„åˆ°ä½ç½® ã€‚

#### ğŸ”¹ RMI (Recursive Model Indexes - é€’å½’æ¨¡å‹ç´¢å¼•)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯â€œå­¦ä¹ å‹ç´¢å¼•â€çš„ä¸€ç§å…·ä½“å®ç°æ¶æ„ï¼Œå®ƒæ¨¡ä»¿äº† B-Tree çš„å¤šå±‚ç»“æ„ ã€‚
  * **å·¥ä½œæ–¹å¼ï¼š**
    ä¸€ä¸ªæ¨¡å‹ï¼ˆâ€œé¢„è¨€å®¶â€ï¼‰å¯èƒ½æ— æ³•â€œçœ‹é€â€æ‰€æœ‰æ•°æ® ã€‚RMI å°±å»ºç«‹äº†ä¸€ä¸ªâ€œé¢„è¨€å®¶â€çš„å±‚çº§ä½“ç³»ï¼š
    1.  **é¡¶å±‚æ¨¡å‹ï¼ˆæ ¹ï¼‰ï¼š** å®ƒä¸é¢„æµ‹æœ€ç»ˆä½ç½®ï¼Œè€Œæ˜¯é¢„æµ‹â€œè¿™ä»¶äº‹è¯¥å½’å“ªä¸ªäºŒå±‚æ¨¡å‹ç®¡â€ ã€‚
    2.  **äºŒå±‚æ¨¡å‹ï¼ˆå¶ï¼‰ï¼š** å®ƒåªè´Ÿè´£ä¸€å°éƒ¨åˆ†æ•°æ®ï¼Œå› æ­¤é¢„æµ‹å¾—æ›´å‡†ï¼Œç›´æ¥ç»™å‡ºæ•°æ®åœ¨æ•°ç»„ä¸­çš„ä½ç½® ã€‚
  * **åœ¨ XIndex ä¸­ï¼š** XIndex çš„â€œæ ¹èŠ‚ç‚¹â€ï¼ˆ`root node`ï¼‰å°±ä½¿ç”¨äº†ä¸€ä¸ª RMI æ¨¡å‹æ¥ç´¢å¼•å®ƒä¸‹é¢çš„â€œåˆ†ç»„èŠ‚ç‚¹â€ï¼ˆ`group nodes`ï¼‰ã€‚

#### ğŸ”¹ Error Bound (è¯¯å·®èŒƒå›´)

  * **é€šä¿—è®²è§£ï¼š**
    â€œé¢„è¨€å®¶â€æ€»æœ‰ç®—é”™çš„æ—¶å€™ã€‚`Error Bound` å°±æ˜¯æ¨¡å‹ç»™å‡ºçš„â€œçº é”™ä¿è¯â€ ã€‚
  * **å·¥ä½œæ–¹å¼ï¼š**
    æ¨¡å‹é¢„æµ‹ä¸€ä¸ªä½ç½® `pred(key)` åï¼Œä¼šåŒæ—¶å‘Šè¯‰ä½ ä¸€ä¸ªâ€œè¯¯å·®èŒƒå›´â€ï¼š`[min_err, max_err]` ã€‚
    å®ƒä¿è¯çœŸå®æ•°æ®ä¸€å®šåœ¨è¿™ä¸ª `[pred(key) + min_err, pred(key) + max_err]` çš„å°åŒºé—´å†… ã€‚
    ä½ åªéœ€è¦åœ¨è¿™ä¸ª**æå°çš„èŒƒå›´**å†…ä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚äºŒåˆ†æŸ¥æ‰¾ï¼‰å°±èƒ½ç²¾ç¡®å®šä½ ã€‚
  * **æ„ä¹‰ï¼š** è¯¯å·®èŒƒå›´è¶Šå°ï¼Œæœ€ç»ˆçš„äºŒåˆ†æŸ¥æ‰¾å°±è¶Šå¿«ï¼ŒæŸ¥è¯¢æ€§èƒ½è¶Šå¥½ ã€‚

-----

### 2\. æ ¸å¿ƒéš¾é¢˜ï¼šå¦‚ä½•å¤„ç†â€œå†™å…¥â€

#### ğŸ”¹ Delta Index (å¢é‡ç´¢å¼•)

  * **é€šä¿—è®²è§£ï¼š**
    å­¦ä¹ å‹ç´¢å¼•æ˜¯åŸºäºâ€œæ’å¥½åºçš„é™æ€æ•°ç»„â€è®­ç»ƒçš„ï¼Œä¸€æ—¦æ’å…¥æ–°æ•°æ®ï¼Œæ•´ä¸ªæ•°ç»„å°±ä¹±äº†ï¼Œæ¨¡å‹å°±â€œå¤±æ•ˆâ€äº† ã€‚
    `Delta Index` å°±æ˜¯ä¸€ä¸ªâ€œ**å°æœ¬æœ¬**â€æˆ–â€œ**ç¼“å†²åŒº**â€ ã€‚
  * **å·¥ä½œæ–¹å¼ï¼š**
    XIndex è§„å®šï¼Œ **æ›´æ–°ï¼ˆUpdateï¼‰** æ“ä½œå¯ä»¥ç›´æ¥åœ¨åŸæ•°æ®ä¸Šæ”¹ã€‚ä½† **æ’å…¥ï¼ˆInsertï¼‰** æ“ä½œï¼Œä¸€å¾‹å…ˆå†™åˆ°è¿™ä¸ª `Delta Index`ï¼ˆå°æœ¬æœ¬ï¼‰ä¸Š ã€‚
    æŸ¥è¯¢æ—¶ï¼Œå…ˆæŸ¥ä¸»æ•°æ® (`Data Array`)ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå†æŸ¥è¿™ä¸ª `Delta Index` ã€‚
  * **ä½ç½®ï¼š** åœ¨ **å›¾ 3** çš„æ¶æ„ä¸­ï¼Œæ¯ä¸ª `group node`ï¼ˆåˆ†ç»„èŠ‚ç‚¹ï¼‰éƒ½è‡ªå¸¦ä¸€ä¸ª `Data Array` å’Œä¸€ä¸ª `Delta Index` ã€‚  ![pic](20251029_06_pic_002.jpg)  

#### ğŸ”¹ Compaction (åˆå¹¶)

  * **é€šä¿—è®²è§£ï¼š**
    â€œå°æœ¬æœ¬â€ï¼ˆ`Delta Index`ï¼‰ä¸èƒ½æ— é™å¢å¤§ï¼Œå¦åˆ™æŸ¥è¯¢æ—¶æ¯æ¬¡éƒ½è¦ç¿»â€œå°æœ¬æœ¬â€ï¼Œæ€§èƒ½ä¼šå˜å·® ã€‚
    `Compaction` å°±æ˜¯ä¸€ä¸ª**åå°æ•´ç†**çš„è¿‡ç¨‹ï¼Œå®ƒå®šæœŸæŠŠâ€œå°æœ¬æœ¬â€é‡Œçš„æ–°æ•°æ®å’Œâ€œä¸»æ•°æ®â€åˆå¹¶ï¼Œç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„ã€æ’å¥½åºçš„â€œä¸»æ•°æ®â€ (`Data Array`)ï¼Œå¹¶ä¸ºè¿™ä¸ªæ–°æ•°ç»„é‡æ–°è®­ç»ƒæ¨¡å‹ ã€‚
  * **éš¾é¢˜ï¼š** è¿™ä¸ªâ€œåˆå¹¶â€è¿‡ç¨‹å¾ˆæ…¢ ï¼Œè€Œä¸”å¦‚æœæ­¤æ—¶æœ‰å¹¶å‘å†™å…¥ï¼Œå°±ä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ï¼Œå¦‚ **å›¾ 2** æ‰€ç¤º ã€‚ ![pic](20251029_06_pic_001.jpg)  

-----

### 3\. XIndex çš„æ ¸å¿ƒåˆ›æ–°ï¼šå¹¶å‘ä¸è‡ªé€‚åº”

#### ğŸŒŸ Two-Phase Compaction (ä¸¤é˜¶æ®µåˆå¹¶)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯ XIndex **æœ€æ ¸å¿ƒçš„åˆ›æ–°**ï¼Œç”¨äºè§£å†³ **å›¾ 2** ä¸­çš„â€œå¹¶å‘æ›´æ–°ä¸¢å¤±â€é—®é¢˜ ã€‚å®ƒæŠŠâ€œåˆå¹¶â€è¿™ä¸ªå±é™©æ“ä½œæ‹†æˆäº†ä¸¤ä¸ªå®‰å…¨çš„é˜¶æ®µã€‚  ![pic](20251029_06_pic_001.jpg)  

  * **è¯·çœ‹å›¾ 4 (Figure 4) çš„æ¼”ç¤ºï¼š**  ![pic](20251029_06_pic_003.jpg)  

      * **é˜¶æ®µä¸€ï¼šåˆå¹¶é˜¶æ®µ (Merge Phase)**
        åå°çº¿ç¨‹åˆ›å»ºâ€œæ–°æ•°ç»„â€ï¼Œä½†**ä¸**ç›´æ¥å¤åˆ¶æ•°æ®ã€‚å®ƒåœ¨æ–°æ•°ç»„é‡Œåªå­˜æ”¾æŒ‡å‘æ—§æ•°æ®ï¼ˆ`Data Array` æˆ– `Delta Index` ä¸­ï¼‰çš„ **â€œæŒ‡é’ˆâ€** ã€‚
      * **é˜¶æ®µäºŒï¼šå¤åˆ¶é˜¶æ®µ (Copy Phase)**
        åå°çº¿ç¨‹å…ˆè®¾ç½®ä¸€ä¸ªâ€œå±éšœâ€ï¼ˆRCU barrierï¼‰ï¼Œç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½â€œçœ‹åˆ°â€è¿™ä¸ªæ–°æ•°ç»„äº† ã€‚ç„¶åï¼Œå®ƒæ‰å¼€å§‹éå†æ–°æ•°ç»„ï¼Œ**é€šè¿‡â€œæŒ‡é’ˆâ€æŠŠæ•°æ®çœŸæ­£å¤åˆ¶è¿‡æ¥** ã€‚

  * **ä¸ºä»€ä¹ˆèƒ½è¡Œï¼Ÿ**

      * å¦‚æœåœ¨é˜¶æ®µä¸€å’Œé˜¶æ®µäºŒä¹‹é—´ï¼Œä¸€ä¸ªç”¨æˆ·çº¿ç¨‹ï¼ˆå¦‚å›¾ 4 ä¸­çš„ `concurrent operations`ï¼‰æ›´æ–°äº†æ—§æ•°æ® $r\_1$ ï¼ˆ æŠŠå®ƒå˜æˆäº† $r\_1'$ ) ã€‚
      * æ²¡å…³ç³»ï¼åˆ°é˜¶æ®µäºŒå¤åˆ¶æ—¶ï¼Œåå°çº¿ç¨‹é€šè¿‡æŒ‡é’ˆ $p_1$ è¯»åˆ°çš„æ˜¯**å·²ç»è¢«æ›´æ–°è¿‡çš„** $r\_1'$ ã€‚
      * **ç»“æœï¼š** å¹¶å‘æ›´æ–°è¢«å®Œç¾ä¿ç•™ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤± ã€‚

#### ğŸ”¹ RCU (Read-Copy-Update - è¯»-å¤åˆ¶-æ›´æ–°)

  * **é€šä¿—è®²è§£ï¼š**
    ä¸€ç§ç»å…¸çš„å¹¶å‘æ§åˆ¶æŠ€æœ¯ï¼ŒXIndex ç”¨å®ƒæ¥é…åˆâ€œä¸¤é˜¶æ®µåˆå¹¶â€ ã€‚
  * **æ ¸å¿ƒæ€æƒ³ï¼š**
    â€œè¯»â€æ“ä½œï¼ˆReaderï¼‰å¯ä»¥ä¸åŠ é”ï¼Œè‡ªç”±è¿›è¡Œã€‚
    â€œå†™â€æ“ä½œï¼ˆWriterï¼‰é€šè¿‡â€œ**å¤åˆ¶**â€æ¥å®Œæˆï¼š
    1.  **Copyï¼š** å¤åˆ¶ä¸€ä»½ä½ è¦ä¿®æ”¹çš„æ•°æ®ã€‚
    2.  **Updateï¼š** åœ¨**å‰¯æœ¬**ä¸Šä¿®æ”¹ã€‚
    3.  **Publishï¼š** ä¿®æ”¹å®Œæˆåï¼Œç”¨ä¸€ä¸ªåŸå­æ“ä½œï¼ˆæ¯”å¦‚æ”¹æŒ‡é’ˆï¼‰æŠŠå‰¯æœ¬â€œå‘å¸ƒâ€ä¸ºæ­£å¼ç‰ˆæœ¬ã€‚
    4.  æ—§ç‰ˆæœ¬è¦ç­‰åˆ°æ‰€æœ‰æ­£åœ¨è¯»å®ƒçš„â€œè¯»â€çº¿ç¨‹éƒ½ç¦»å¼€åï¼Œæ‰èƒ½å®‰å…¨é”€æ¯ ã€‚
  * **åœ¨ XIndex ä¸­ï¼š** RCU å±éšœï¼ˆbarrierï¼‰è¢«ç”¨åœ¨ä¸¤é˜¶æ®µåˆå¹¶çš„ä¸­é—´ï¼Œç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½ä»â€œæ—§æŒ‡é’ˆæ•°ç»„â€åˆ‡æ¢åˆ°â€œæ–°æŒ‡é’ˆæ•°ç»„â€ ã€‚

#### ğŸ”¹ Structure Update (ç»“æ„æ›´æ–°)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯ XIndex çš„â€œ**è‡ªé€‚åº”**â€èƒ½åŠ›ï¼Œç”¨æ¥è§£å†³å®ƒå¯¹æ•°æ®åˆ†å¸ƒæ•æ„Ÿçš„é—®é¢˜ï¼ˆå¦‚ **è¡¨ 1** æ‰€ç¤ºçš„æ€§èƒ½æ³¢åŠ¨ï¼‰ã€‚  ![pic](20251029_06_pic_004.jpg)  
  * **å·¥ä½œæ–¹å¼ï¼š**
    XIndex ä¼šåœ¨**è¿è¡Œæ—¶**ï¼ˆRuntimeï¼‰ç›‘æ§è‡ªå·±çš„æ€§èƒ½ã€‚å¦‚æœå‘ç°æŸä¸ªâ€œåˆ†ç»„â€ï¼ˆgroupï¼‰çš„é¢„æµ‹è¯¯å·®å¤ªå¤§ï¼ˆ`Error Bound` \> é˜ˆå€¼ `e`ï¼‰ï¼Œæˆ–è€…â€œå°æœ¬æœ¬â€ï¼ˆ`Delta Index`ï¼‰å¤ªæ»¡äº†ï¼ˆ`buf` \> é˜ˆå€¼ `s`ï¼‰ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨â€œå˜å½¢â€ ã€‚
  * **å…·ä½“æ“ä½œï¼ˆè§ å›¾ 5 å’Œ è¡¨ 2ï¼‰ï¼š**   ![pic](20251029_06_pic_005.jpg)  ![pic](20251029_06_pic_006.jpg)  
      * `Model Split` (æ¨¡å‹æ‹†åˆ†): æŠŠä¸€ä¸ªä¸å‡†çš„å¤§æ¨¡å‹æ‹†æˆå¤šä¸ªæ›´å‡†çš„å°æ¨¡å‹ ã€‚
      * `Group Split` (åˆ†ç»„æ‹†åˆ†): å¦‚æœæ¨¡å‹å¤ªå¤šï¼Œå°±æŠŠä¸€ä¸ªâ€œåˆ†ç»„â€æ‹†æˆä¸¤ä¸ª ã€‚
      * `Model Merge` / `Group Merge` (æ¨¡å‹/åˆ†ç»„åˆå¹¶): åä¹‹ï¼Œå¦‚æœæ•°æ®å˜å°‘äº†ï¼Œå°±æŠŠå¤šä½™çš„æ¨¡å‹æˆ–åˆ†ç»„â€œåˆå¹¶â€èµ·æ¥ï¼Œå‡å°‘å¼€é”€ ã€‚

è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨ä¸‹é¢çš„æµç¨‹å›¾æ¥æ¦‚æ‹¬ï¼š

```mermaid
graph TD
    subgraph è¿è¡Œæ—¶ç›‘æ§
        A(ç›‘æµ‹ Group æ€§èƒ½)
    end
    
    A --> B{é¢„æµ‹è¯¯å·®æ˜¯å¦è¿‡å¤§?};
    B -- æ˜¯ --> C["æ‰§è¡Œ Model / Group Split<br> (a, c) æ‹†åˆ†ä»¥æé«˜ç²¾åº¦"];
    B -- å¦ --> D{"Delta ç´¢å¼•æ˜¯å¦è¿‡æ»¡?"};
    D -- æ˜¯ --> E["æ‰§è¡Œ Group Split<br> (d) æ‹†åˆ†ä»¥åˆ†æ‹…å†™å…¥"];
    D -- å¦ --> F{è¯¯å·®å’Œè´Ÿè½½æ˜¯å¦è¿‡ä½?};
    F -- æ˜¯ --> G["æ‰§è¡Œ Model / Group Merge<br> (b, e) åˆå¹¶ä»¥é™ä½å¼€é”€"];
    F -- å¦ --> A;
    
    C & E & G --> H(f. æ›´æ–° Root æ ¹æ¨¡å‹);
    H --> A;
```
  
## å‚è€ƒ        
         
https://dl.acm.org/doi/pdf/10.1145/3332466.3374547    
        
<b> ä»¥ä¸Šå†…å®¹åŸºäºDeepSeekã€Qwenã€GeminiåŠè¯¸å¤šAIç”Ÿæˆ, è½»å¾®äººå·¥è°ƒæ•´, æ„Ÿè°¢æ­å·æ·±åº¦æ±‚ç´¢äººå·¥æ™ºèƒ½ã€é˜¿é‡Œäº‘ã€Googleç­‰å…¬å¸. </b>        
        
<b> AI ç”Ÿæˆçš„å†…å®¹è¯·è‡ªè¡Œè¾¨åˆ«æ­£ç¡®æ€§, å½“ç„¶ä¹Ÿå¤šäº†äº›è®¸è¸©å‘çš„ä¹è¶£, æ¯•ç«Ÿå†’é™©æ˜¯æ¯ä¸ªç”·äººçš„å¤©æ€§.  </b>        
    
#### [æœŸæœ› PostgreSQL|å¼€æºPolarDB å¢åŠ ä»€ä¹ˆåŠŸèƒ½?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB å¼€æºæ•°æ®åº“](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB å­¦ä¹ å›¾è°±](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [PostgreSQL è§£å†³æ–¹æ¡ˆé›†åˆ](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [å¾·å“¥ / digoal's Github - å…¬ç›Šæ˜¯ä¸€è¾ˆå­çš„äº‹.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About å¾·å“¥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
