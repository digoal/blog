## AIè®ºæ–‡è§£è¯» | Calvin: Fast Distributed Transactions For Partitioned Database Systems
        
### ä½œè€…        
digoal        
        
### æ—¥æœŸ        
2025-11-03        
        
### æ ‡ç­¾        
PostgreSQL , PolarDB , DuckDB , AI , è®ºæ–‡è§£è¯»        
        
----        
        
## èƒŒæ™¯  
      
https://dl.acm.org/doi/pdf/10.1145/2213836.2213838        
  
æç¤º:          
```          
è¯»æ‡‚ã€ŠCalvin: Fast Distributed Transactions For Partitioned Database Systemsã€‹è¿™ç¯‡è®ºæ–‡éœ€è¦æå‰æŒæ¡å“ªäº›åŸºç¡€çŸ¥è¯†, è¯·ä½¿ç”¨ä¸­æ–‡é€šç†Ÿæ˜“æ‡‚çš„è®²è§£è¿™äº›åŸºç¡€çŸ¥è¯†, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§. 
  
ä½¿ç”¨ä¸­æ–‡é€šç†Ÿæ˜“æ‡‚çš„è§£è¯»ã€ŠCalvin: Fast Distributed Transactions For Partitioned Database Systemsã€‹è¿™ç¯‡è®ºæ–‡, å…¶ä¸­çš„å…³é”®å†…å®¹è¯·ç€é‡è®²è§£, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§. 
  
æå–ã€ŠCalvin: Fast Distributed Transactions For Partitioned Database Systemsã€‹è¿™ç¯‡è®ºæ–‡ä¸­çš„é‡è¦æœ¯è¯­, ä½¿ç”¨ä¸­æ–‡å¯¹è¿™äº›æœ¯è¯­è¿›è¡Œé€šç†Ÿæ˜“æ‡‚çš„è®²è§£, å¯ä»¥å¼•ç”¨è®ºæ–‡ä¸­çš„å›¾ã€è¡¨æˆ–ä½¿ç”¨Markdownæ”¯æŒçš„å›¾å½¢(text,mermaidç­‰)å¢åŠ è§£é‡Šæ€§. 
```     
  
## 1 å‰ç½®çŸ¥è¯† 
  
è¦è¯»æ‡‚ã€ŠCalvinã€‹è¿™ç¯‡è®ºæ–‡ï¼Œä½ éœ€è¦å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå’Œæ•°æ®åº“çš„åŸºç¡€çŸ¥è¯†æœ‰ä¸€äº›äº†è§£ã€‚è¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ªéå¸¸å·§å¦™çš„æ–¹æ¡ˆï¼Œæ¥è§£å†³ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„â€œè€å¤§éš¾â€é—®é¢˜ï¼šå¦‚ä½•è®©åˆ†å¸ƒå¼æ•°æ®åº“æ—¢æ”¯æŒè·¨å¤šä¸ªæœåŠ¡å™¨çš„å¤æ‚äº‹åŠ¡ï¼Œåˆèƒ½å®ç°é«˜æ€§èƒ½å’Œé«˜æ‰©å±•æ€§ã€‚

ä¸‹é¢æˆ‘å°†ç”¨é€šä¿—çš„è¯­è¨€ï¼Œä¸ºä½ è®²è§£ç†è§£è¿™ç¯‡è®ºæ–‡æ‰€éœ€çš„æ ¸å¿ƒåŸºç¡€çŸ¥è¯†ã€‚

-----

### 1\. æ•°æ®åº“çš„æ ¸å¿ƒè¿½æ±‚ï¼šACID äº‹åŠ¡

é¦–å…ˆï¼Œä½ éœ€è¦æ˜ç™½ä»€ä¹ˆæ˜¯â€œäº‹åŠ¡â€ï¼ˆTransactionï¼‰ä»¥åŠä¸ºä»€ä¹ˆå®ƒå¾ˆé‡è¦ã€‚

  * **ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ**
    æƒ³è±¡ä¸€ä¸‹é“¶è¡Œè½¬è´¦ï¼šä½ ä»Aè´¦æˆ·è½¬100å…ƒåˆ°Bè´¦æˆ·ã€‚è¿™ä¸ªæ“ä½œåŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼š

    1.  Aè´¦æˆ·å‡100å…ƒã€‚
    2.  Bè´¦æˆ·åŠ 100å…ƒã€‚
        â€œäº‹åŠ¡â€å°±æ˜¯æŠŠè¿™ä¸¤ä¸ªæ­¥éª¤â€œæ‰“åŒ…â€æˆä¸€ä¸ªå•ä¸€ã€ä¸å¯åˆ†å‰²çš„æ“ä½œå•å…ƒã€‚

  * **ä»€ä¹ˆæ˜¯ ACIDï¼Ÿ**
    ACID æ˜¯ä¼ ç»Ÿæ•°æ®åº“ï¼ˆå°¤å…¶æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼‰çš„â€œé»„é‡‘æ ‡å‡†â€ï¼Œå®ƒç¡®ä¿äº‹åŠ¡çš„å¯é æ€§ ï¼š

      * **A - åŸå­æ€§ (Atomicity):** äº‹åŠ¡è¦ä¹ˆå…¨éƒ¨å®Œæˆï¼ˆAå‡100ï¼ŒBåŠ 100ï¼‰ï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼ˆä¸¤ä¸ªæ“ä½œéƒ½ä¸åšï¼‰ã€‚ç»ä¸èƒ½å‡ºç°Aå‡äº†é’±ï¼ŒBæ²¡æ”¶åˆ°çš„æƒ…å†µã€‚
      * **C - ä¸€è‡´æ€§ (Consistency):** äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€è½¬ç§»åˆ°å¦ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ã€‚
      * **I - éš”ç¦»æ€§ (Isolation):** å¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡ï¼ˆæ¯”å¦‚Cä¹Ÿåœ¨ç»™Bè½¬è´¦ï¼‰äº’ä¸å¹²æ‰° ã€‚
      * **D - æŒä¹…æ€§ (Durability):** ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œæ‰€åšçš„æ›´æ”¹å°†æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚

**Calvin çš„ç›®æ ‡ä¹‹ä¸€ï¼Œå°±æ˜¯åœ¨â€œåˆ†å¸ƒå¼â€ç¯å¢ƒä¸‹ï¼Œä¾ç„¶æä¾›å®Œæ•´çš„ ACID äº‹åŠ¡æ”¯æŒ ã€‚**

-----

### 2\. èµ°å‘åˆ†å¸ƒå¼ï¼šåˆ†åŒºä¸å¤åˆ¶

å½“æ•°æ®é‡å¤ªå¤§æˆ–è¯·æ±‚å¤ªå¤šï¼Œä¸€å°æœåŠ¡å™¨æ‰›ä¸ä½æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦â€œåˆ†å¸ƒå¼ç³»ç»Ÿâ€ã€‚

  * **åˆ†åŒº (Partitioning):**
    ä¹Ÿå¸¸è¢«ç§°ä¸ºâ€œåˆ†ç‰‡â€(Sharding)ã€‚å°±æ˜¯æŠŠæ•°æ®â€œåˆ‡â€æˆå¤šä»½ï¼Œå­˜æ”¾åœ¨ä¸åŒçš„æœåŠ¡å™¨ï¼ˆèŠ‚ç‚¹ï¼‰ä¸Š ã€‚

      * **ä¾‹å­ï¼š** 1å·æœåŠ¡å™¨å­˜Aè´¦æˆ·ï¼Œ2å·æœåŠ¡å™¨å­˜Bè´¦æˆ·ã€‚

  * **å¤åˆ¶ (Replication):**
    ä¸ºäº†â€œé«˜å¯ç”¨æ€§â€ï¼ˆHigh Availabilityï¼Œå³ä¸€å°æœºå™¨æŒ‚äº†ï¼ŒæœåŠ¡è¿˜èƒ½ç”¨ï¼‰ï¼Œæˆ‘ä»¬æŠŠåŒä¸€ä»½æ•°æ®å¤åˆ¶å¤šä»½ï¼Œå­˜åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Š ã€‚

      * **ä¾‹å­ï¼š** Aè´¦æˆ·çš„æ•°æ®ï¼Œåœ¨1å·ã€2å·ã€3å·æœåŠ¡å™¨ä¸Šå„å­˜ä¸€ä»½ã€‚

ä½ å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªç®€å•çš„ç¤ºæ„å›¾æ¥ç†è§£ï¼š

```mermaid
graph TD
    subgraph "è®¡ç®—æœºé›†ç¾¤ (Cluster)"
        direction LR
        subgraph "èŠ‚ç‚¹1 (Partition 1)"
            A(æ•°æ® A)
            B(æ•°æ® B)
        end
        subgraph "èŠ‚ç‚¹2 (Partition 2)"
            C(æ•°æ® C)
            D(æ•°æ® D)
        end
        subgraph "èŠ‚ç‚¹3 (Partition 3)"
            E(æ•°æ® E)
            F(æ•°æ® F)
        end
    end
```

> **åˆ†åŒº (Partitioning):** æ•°æ® A/Bã€C/Dã€E/F è¢«åˆ†æ•£å­˜å‚¨åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šã€‚
> **å¤åˆ¶ (Replication) (æœªç”»å‡º):** èŠ‚ç‚¹1çš„æ•°æ®ï¼Œå¯ä»¥è¢«å®Œæ•´å¤åˆ¶åˆ°å¦ä¸€ä¸ªâ€œå¤‡èƒâ€èŠ‚ç‚¹ï¼ˆæ¯”å¦‚èŠ‚ç‚¹4ï¼‰ä¸Šã€‚

Calvin çš„è®¾è®¡å°±æ˜¯è¿è¡Œåœ¨è¿™æ ·â€œåˆ†åŒºâ€å’Œâ€œå¤åˆ¶â€çš„ç³»ç»Ÿä¹‹ä¸Šçš„ ã€‚

-----

### 3\. åˆ†å¸ƒå¼çš„å™©æ¢¦ï¼šä¸¤é˜¶æ®µæäº¤ (2PC)

ç°åœ¨ï¼Œé—®é¢˜æ¥äº†ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡ï¼ˆæ¯”å¦‚Aè½¬è´¦ç»™Cï¼‰éœ€è¦åŒæ—¶æ“ä½œ**åˆ†åŒº1**ï¼ˆAè´¦æˆ·ï¼‰å’Œ**åˆ†åŒº2**ï¼ˆCè´¦æˆ·ï¼‰ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªâ€œåˆ†å¸ƒå¼äº‹åŠ¡â€ã€‚

  * **ä¼ ç»Ÿæ–¹æ¡ˆï¼šä¸¤é˜¶æ®µæäº¤ (Two-Phase Commit, 2PC)**
    ä¸ºäº†ä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡çš„â€œåŸå­æ€§â€ï¼ˆè¦ä¹ˆéƒ½åšï¼Œè¦ä¹ˆéƒ½ä¸åšï¼‰ï¼Œä¼ ç»Ÿæ•°æ®åº“ä½¿ç”¨äº† 2PC åè®® ã€‚

    1.  **é˜¶æ®µä¸€ï¼ˆæŠ•ç¥¨/å‡†å¤‡ï¼‰ï¼š** åè°ƒè€…ï¼ˆä¸€ä¸ªæœåŠ¡å™¨ï¼‰é—®æ‰€æœ‰å‚ä¸è€…ï¼ˆèŠ‚ç‚¹1å’ŒèŠ‚ç‚¹2ï¼‰ï¼šâ€œä½ ä»¬èƒ½æäº¤è¿™ä¸ªäº‹åŠ¡å—ï¼Ÿâ€ å‚ä¸è€…ä¼šé”å®š (Lock) å®ƒä»¬éœ€è¦çš„æ•°æ®ï¼ˆAå’ŒCï¼‰ï¼Œç„¶åå›ç­”â€œå‡†å¤‡å¥½äº†â€æˆ–â€œå¤±è´¥â€ã€‚
    2.  **é˜¶æ®µäºŒï¼ˆæäº¤/å›æ»šï¼‰ï¼š**
          * å¦‚æœæ‰€æœ‰äººéƒ½è¯´â€œå‡†å¤‡å¥½äº†â€ï¼Œåè°ƒè€…å°±è¯´ï¼šâ€œå¥½ï¼Œéƒ½æäº¤ï¼â€
          * åªè¦æœ‰ä¸€ä¸ªäººè¯´â€œå¤±è´¥â€ï¼Œåè°ƒè€…å°±è¯´ï¼šâ€œå¤§å®¶å…¨éƒ¨å›æ»šï¼ˆæ’¤é”€ï¼‰ï¼â€

  * **2PC çš„è‡´å‘½ç¼ºé™·ï¼šé«˜â€œäº‰ç”¨â€ (Contention)**
    2PC çš„æœ€å¤§é—®é¢˜æ˜¯ï¼Œåœ¨æ•´ä¸ªæŠ•ç¥¨å’Œç­‰å¾…æäº¤çš„è¿‡ç¨‹ä¸­ï¼Œ**æ•°æ®å¿…é¡»ä¸€ç›´è¢«é”å®š** ã€‚å¦‚æœè¿™ä¸ªè¿‡ç¨‹å› ä¸ºç½‘ç»œå»¶è¿Ÿè€Œå˜æ…¢ï¼Œå…¶ä»–æƒ³è¦è®¿é—®Aæˆ–Cè´¦æˆ·çš„äº‹åŠ¡å°±åªèƒ½å¹²ç­‰ç€ ã€‚

    **è¿™å°±æ˜¯è®ºæ–‡ä¸­åå¤æåˆ°çš„â€œäº‰ç”¨æˆæœ¬â€ (Contention Costs) ã€‚** åœ¨å¤§è§„æ¨¡ç³»ç»Ÿä¸­ï¼Œè¿™ç§é”å®šå’Œç­‰å¾…ä¼šå¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œç³»ç»Ÿæ— æ³•æ‰©å±• ã€‚

-----

### 4\. Calvin çš„â€œJULIAâ€ï¼šç¡®å®šæ€§ (Determinism)

ä¸ºäº†ç»•å¼€ 2PC åŠå…¶é«˜æ˜‚çš„äº‰ç”¨æˆæœ¬ï¼ŒCalvin æå‡ºäº†ä¸€ä¸ªé©å‘½æ€§çš„æƒ³æ³•ï¼š**ç¡®å®šæ€§æ‰§è¡Œ (Deterministic Execution)**ã€‚

  * **ä¼ ç»Ÿç³»ç»Ÿï¼ˆéç¡®å®šæ€§ï¼‰ï¼š** äº‹åŠ¡çš„æ‰§è¡Œé¡ºåºå–å†³äºå®ƒä»¬åˆ°è¾¾çš„æ—¶æœºã€çº¿ç¨‹è°ƒåº¦ç­‰ ã€‚ç³»ç»Ÿå¿…é¡»åœ¨â€œè¿è¡Œæ—¶â€é€šè¿‡ 2PC å’Œé”æ¥è§£å†³å†²çªã€‚
  * **Calvinï¼ˆç¡®å®šæ€§ï¼‰ï¼š** Calvin è¯´ï¼Œæˆ‘ä»¬ä¸å¦‚**åœ¨æ‰§è¡Œäº‹åŠ¡ä¹‹å‰ï¼Œå…ˆæŠŠæ‰€æœ‰äº‹åŠ¡æ’ä¸ªé˜Ÿï¼Œå®šä¸€ä¸ªâ€œå…¨çƒå”¯ä¸€çš„æ€»é¡ºåºâ€** ã€‚

**è¿™å°±æ˜¯ Calvin æ¶æ„çš„æ ¸å¿ƒâ€”â€”å®šåºå±‚ (Sequencing Layer) ã€‚**

ä½ å¯ä»¥æŠŠè¿™ä¸ªâ€œå®šåºå™¨â€æƒ³è±¡æˆé“¶è¡Œçš„â€œå«å·æœºâ€ã€‚

1.  **æ”¶é›†è¾“å…¥ï¼š** æ‰€æœ‰äº‹åŠ¡è¯·æ±‚ï¼ˆâ€œæˆ‘è¦è½¬è´¦â€ã€â€œæˆ‘è¦æŸ¥è¯¢â€ï¼‰éƒ½å…ˆå‘é€ç»™â€œå®šåºå±‚â€ ã€‚
2.  **å…¨å±€æ’åºï¼š** å®šåºå±‚ï¼ˆé€šè¿‡ Paxos ç­‰å…±è¯†ç®—æ³•  æˆ–å…¶ä»–æ–¹å¼ï¼‰ä¸ºæ‰€æœ‰äº‹åŠ¡æ’ä¸€ä¸ª**å…¨çƒç»Ÿä¸€çš„é¡ºåº**ï¼ˆæ¯”å¦‚ï¼Œäº‹åŠ¡1ã€äº‹åŠ¡2ã€äº‹åŠ¡3...ï¼‰ã€‚
3.  **ç¡®å®šæ€§æ‰§è¡Œï¼š** æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥æ‰§è¡Œäº‹åŠ¡ ã€‚

**è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ**

  * **ä¸å†éœ€è¦ 2PC æäº¤åè®®ï¼** 
    å› ä¸ºæ‰€æœ‰äººéƒ½æŒ‰åŒä¸€ä¸ªé¡ºåºæ‰§è¡Œï¼Œç³»ç»Ÿå¯ä»¥ä¿è¯ï¼šå¦‚æœäº‹åŠ¡Aåœ¨äº‹åŠ¡Bä¹‹å‰ï¼Œé‚£ä¹ˆåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šï¼ŒAå¯¹æ•°æ®çš„å½±å“ä¸€å®šåœ¨Bä¹‹å‰è¢«çœ‹åˆ°ã€‚å¤§å®¶â€œå¤©ç”Ÿâ€å°±æ˜¯ä¸€è‡´çš„ï¼Œæ ¹æœ¬ä¸éœ€è¦åœ¨äº‹åŠ¡æ‰§è¡Œ*å®Œ*ä¹‹åï¼Œå†é€šè¿‡ 2PC å»â€œæ£€æŸ¥â€å¤§å®¶æ˜¯å¦ä¸€è‡´ã€‚
  * **å¤§å¤§å‡å°‘äº†â€œäº‰ç”¨â€ï¼** 
    é”å®šçš„æ—¶é—´è¢«ä¸¥æ ¼æ§åˆ¶åœ¨äº‹åŠ¡æ‰§è¡Œçš„ç¬é—´ï¼Œè€Œä¸æ˜¯åƒ 2PC é‚£æ ·åœ¨æ¼«é•¿çš„æŠ•ç¥¨å’Œç½‘ç»œé€šä¿¡ä¸­ä¸€ç›´å ç€é” ã€‚

-----

### æ€»ç»“ï¼šä½ éœ€è¦çœ‹æ‡‚çš„â€œæ ¸å¿ƒå¯¹å†³â€

ä¸ºäº†å¸®åŠ©ä½ ç†è§£è¿™ç¯‡è®ºæ–‡ï¼Œä½ å¯ä»¥å…³æ³¨è®ºæ–‡ä¸­çš„ **Figure 1** å’Œ **Figure 6**ã€‚  

  * **Figure 1 (ç³»ç»Ÿæ¶æ„):**  ![pic](20251103_03_pic_001.jpg)   
    è¿™å¼ å›¾å±•ç¤ºäº† Calvin çš„ä¸‰å±‚æ¶æ„ ã€‚ä½ éœ€è¦é‡ç‚¹å…³æ³¨æœ€ä¸Šå±‚çš„ **Sequencer (å®šåºå™¨)** ã€‚å®ƒå°±æ˜¯æˆ‘ä»¬ä¸Šé¢è¯´çš„â€œå«å·æœºâ€ï¼Œæ˜¯å®ç°â€œç¡®å®šæ€§â€çš„æ ¸å¿ƒã€‚å®ƒè´Ÿè´£æ¥æ”¶äº‹åŠ¡ã€æ’åºã€å¹¶æŠŠæ’å¥½åºçš„äº‹åŠ¡æ—¥å¿—å¤åˆ¶ (replication) ç»™æ‰€æœ‰å‰¯æœ¬ ã€‚

  * **Figure 6 (æ€§èƒ½å¯¹æ¯”):**  ![pic](20251103_03_pic_002.jpg)   
    è¿™å¼ å›¾æ˜¯ Calvin â€œç§€è‚Œè‚‰â€çš„åœ°æ–¹ã€‚å®ƒå¯¹æ¯”äº† Calvin å’Œä¼ ç»Ÿ 2PC ç³»ç»Ÿï¼ˆå›¾ä¸­çš„ "System R\*-style system w/ 2PC" ï¼‰åœ¨â€œé«˜äº‰ç”¨â€ (contention factor)  ä¸‹çš„æ€§èƒ½â€œå‡é€Ÿâ€ (slowdown)  æƒ…å†µã€‚

    > **çœ‹å›¾ç»“è®ºï¼š**  
    > * **è™šçº¿ (ä¼ ç»Ÿ 2PC ç³»ç»Ÿ):** éšç€â€œäº‰ç”¨â€ (contention) å˜é«˜ï¼ˆæ¨ªåæ ‡å‘å³ç§»åŠ¨ï¼‰ï¼Œæ€§èƒ½ä¸‹é™ï¼ˆâ€œå‡é€Ÿâ€ï¼‰å¾—éå¸¸å¿«ï¼Œå‘ˆæŒ‡æ•°çº§æ¶åŒ– ã€‚  
    > * **å®çº¿ (Calvin):** å³ä½¿åœ¨éå¸¸é«˜çš„äº‰ç”¨ä¸‹ï¼ŒCalvin çš„æ€§èƒ½ä¸‹é™ä¹Ÿå¹³ç¼“å¾—å¤š ã€‚  

    > è¿™å¼ å›¾æœ‰åŠ›åœ°è¯æ˜äº† Calvin çš„æ ¸å¿ƒè®ºç‚¹ï¼šé€šè¿‡â€œç¡®å®šæ€§æ’åºâ€æ¥æ¶ˆé™¤â€œåˆ†å¸ƒå¼æäº¤åè®®â€ (2PC)ï¼Œå¯ä»¥æå¤§åœ°å‡å°‘äº‰ç”¨æˆæœ¬ï¼Œä»è€Œåœ¨åˆ†å¸ƒå¼äº‹åŠ¡ä¸Šå®ç°é«˜æ‰©å±•æ€§ ã€‚  

**ç®€è€Œè¨€ä¹‹ï¼Œè¦è¯»æ‡‚ Calvinï¼Œä½ éœ€è¦å¸¦ç€ä»¥ä¸‹é—®é¢˜ï¼š**

1.  ä»€ä¹ˆæ˜¯ ACID äº‹åŠ¡ï¼Ÿ
2.  ä¸ºä»€ä¹ˆåœ¨â€œåˆ†åŒºâ€å’Œâ€œå¤åˆ¶â€çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šå®ç° ACID äº‹åŠ¡è¿™ä¹ˆéš¾ï¼Ÿ
3.  ä¼ ç»Ÿæ–¹æ¡ˆ 2PC çš„ç“¶é¢ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç­”æ¡ˆï¼šé«˜äº‰ç”¨/Contentionï¼‰
4.  Calvin æ˜¯å¦‚ä½•â€œç»•è¿‡â€è¿™ä¸ªç“¶é¢ˆçš„ï¼Ÿï¼ˆç­”æ¡ˆï¼šé€šè¿‡â€œå®šåºå±‚â€å®ç°â€œç¡®å®šæ€§æ‰§è¡Œâ€ï¼‰

å¸Œæœ›è¿™äº›åŸºç¡€çŸ¥è¯†çš„é“ºå«èƒ½å¸®åŠ©ä½ é¡ºåˆ©é˜…è¯»è¿™ç¯‡ç»å…¸çš„è®ºæ–‡ï¼

æ‚¨å¸Œæœ›æˆ‘æ·±å…¥è®²è§£ä¸€ä¸‹è¿™äº›æ¦‚å¿µä¸­çš„æŸä¸€ä¸ªå—ï¼Ÿä¾‹å¦‚ 2PC çš„å…·ä½“æµç¨‹ï¼Œæˆ–è€… Calvin çš„å®šåºå±‚æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ
  
## 2 è§£è¯»è®ºæ–‡ 
  
å¥½çš„ï¼Œè¿™æ˜¯ä¸€ç¯‡åˆ†å¸ƒå¼æ•°æ®åº“é¢†åŸŸéå¸¸ç»å…¸çš„è®ºæ–‡ã€‚Calvin é€šè¿‡ä¸€ä¸ªéå¸¸å·§å¦™çš„è®¾è®¡ï¼Œè§£å†³äº†â€œåˆ†å¸ƒå¼äº‹åŠ¡â€å’Œâ€œç³»ç»Ÿæ‰©å±•æ€§â€è¿™å¯¹é•¿æœŸå­˜åœ¨çš„çŸ›ç›¾ã€‚

æˆ‘å°†ä¸ºä½ é€šä¿—åœ°è§£è¯»è¿™ç¯‡è®ºæ–‡ï¼Œå¸¦ä½ ç†è§£å®ƒçš„æ ¸å¿ƒæ€æƒ³å’Œå…³é”®æŠ€æœ¯ã€‚

-----

### 1\. è®ºæ–‡çš„æ ¸å¿ƒæ€æƒ³ï¼ˆä¸€å¥è¯æ¦‚æ‹¬ï¼‰

Calvin çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š **â€œå…ˆæ’åºï¼Œå†æ‰§è¡Œâ€** ã€‚

å®ƒé€šè¿‡ä¸€ä¸ªå…¨å±€ç»Ÿä¸€çš„â€œå®šåºå™¨â€ï¼ˆSequencerï¼‰ï¼Œ **åœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰ï¼Œå°±ä¸ºæ‰€æœ‰äº‹åŠ¡æ’å®šä¸€ä¸ªå…¨çƒå”¯ä¸€çš„â€œæ‰§è¡Œé¡ºåºâ€** ã€‚æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹éƒ½ä¸¥æ ¼éµå®ˆè¿™ä¸ªé¡ºåºæ¥æ‰§è¡Œäº‹åŠ¡ï¼Œä»è€Œå½»åº•æ¶ˆç­äº†ä¼ ç»Ÿåˆ†å¸ƒå¼äº‹åŠ¡ä¸­ä¸ºäº†â€œè¾¾æˆä¸€è‡´â€è€Œäº§ç”Ÿçš„æ˜‚è´µç½‘ç»œé€šä¿¡å’Œé”ç­‰å¾…ï¼ˆå¦‚ä¸¤é˜¶æ®µæäº¤ï¼‰ï¼Œå®ç°äº†æé«˜çš„æ€§èƒ½å’Œæ‰©å±•æ€§ ã€‚

-----

### 2\. é—®é¢˜çš„æ ¹æºï¼šä¼ ç»Ÿåˆ†å¸ƒå¼äº‹åŠ¡ä¸ºä»€ä¹ˆè¿™ä¹ˆâ€œæ…¢â€ï¼Ÿ

åœ¨ Calvin ä¹‹å‰ï¼Œäººä»¬æ™®éè®¤ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿè¦å®ç°é«˜æ‰©å±•æ€§ï¼Œå°±å¿…é¡»æ”¾å¼ƒæˆ–å‰Šå¼±äº‹åŠ¡ï¼ˆACIDï¼‰ã€‚ä¸ºä»€ä¹ˆï¼Ÿ

**æ ¹æºåœ¨äºâ€œé”â€å’Œâ€œä¸€è‡´æ€§åè®®â€ï¼ˆå¦‚ä¸¤é˜¶æ®µæäº¤, 2PCï¼‰ã€‚**

æƒ³è±¡ä¸€ä¸ªè·¨é“¶è¡Œè½¬è´¦ï¼ˆä¸€ä¸ªâ€œåˆ†å¸ƒå¼äº‹åŠ¡â€ï¼‰ï¼š

1.  äº‹åŠ¡å¼€å§‹ã€‚
2.  é”å®šAé“¶è¡Œçš„è´¦æˆ·ã€‚
3.  é”å®šBé“¶è¡Œçš„è´¦æˆ·ã€‚
4.  æ‰§è¡Œè½¬è´¦è®¡ç®—ã€‚
5.  **ï¼ˆé—®é¢˜æ¥äº†ï¼‰** Aé“¶è¡Œå’ŒBé“¶è¡Œå¿…é¡»é€šè¿‡ç½‘ç»œè¾¾æˆä¸€è‡´ï¼šâ€œæˆ‘ä»¬æ˜¯éƒ½æˆåŠŸäº†ï¼Œè¿˜æ˜¯ä¸€èµ·å¤±è´¥ï¼Ÿâ€ è¿™å°±æ˜¯ **2PC (Two-Phase Commit)** ã€‚
6.  åœ¨è¿™ä¸ªâ€œäº’ç›¸ç¡®è®¤â€çš„è¿‡ç¨‹ä¸­ï¼ŒAå’ŒBçš„è´¦æˆ·å¿…é¡»**å…¨ç¨‹é”å®š** ã€‚

è¿™ä¸ªâ€œé”å®šæ—¶é•¿â€åŒ…å«äº†æ‰€æœ‰ç½‘ç»œé€šä¿¡çš„å»¶è¿Ÿ ã€‚å¦‚æœæœ‰100ä¸ªäº‹åŠ¡éƒ½åœ¨ç­‰è¿™ä¸¤ä¸ªè´¦æˆ·ï¼Œç³»ç»Ÿå°±ä¼šè¢«æ´»æ´»å¡æ­»ã€‚

è®ºæ–‡å°†è¿™ä¸ªâ€œé”å®šæ—¶é•¿â€ç§°ä¸º **â€œäº‰ç”¨è¶³è¿¹â€ (Contention Footprint)** ã€‚ä¼ ç»Ÿ 2PC æ–¹æ¡ˆçš„â€œäº‰ç”¨è¶³è¿¹â€éå¸¸å¤§ï¼Œå¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™ ã€‚

-----

### 3\. Calvin çš„â€œJULIAâ€ï¼šç¡®å®šæ€§æ‰§è¡Œ (Determinism)

Calvin è¯´ï¼š **â€œå¦‚æœæˆ‘ä»¬èƒ½åœ¨æ‰§è¡Œäº‹åŠ¡å‰ï¼Œå°±è®©æ‰€æœ‰äººéƒ½çŸ¥é“è¯¥æŒ‰ä»€ä¹ˆé¡ºåºæ¥åšï¼Œä¸å°±ä¸éœ€è¦äº‹åå†å¼€ä¼šï¼ˆ2PCï¼‰äº†å—ï¼Ÿâ€** 

è¿™å°±æ˜¯ **â€œç¡®å®šæ€§â€ (Determinism)** çš„å«ä¹‰ ã€‚

  * **ä¼ ç»Ÿï¼ˆéç¡®å®šæ€§ï¼‰æ–¹æ¡ˆï¼š** å…ˆæ‰§è¡Œï¼Œå†å¼€ä¼šï¼ˆ2PCï¼‰æ¥è§£å†³å†²çªå’Œè¾¾æˆä¸€è‡´ã€‚
  * **Calvinï¼ˆç¡®å®šæ€§ï¼‰æ–¹æ¡ˆï¼š** å…ˆå¼€ä¼šï¼ˆæ’åºï¼‰ï¼Œå†æ‰§è¡Œã€‚æ‰€æœ‰äººéƒ½æŒ‰é¢„å®šçš„é¡ºåºæ‰§è¡Œï¼Œä¿è¯ä¸ä¼šå‡ºé”™ ã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒCalvin å°†æ˜‚è´µçš„â€œä¸€è‡´æ€§â€å¼€é”€ï¼Œä»â€œäº‹åŠ¡æ‰§è¡Œä¸­â€ï¼ˆæŒé”é˜¶æ®µï¼‰ç§»åˆ°äº†â€œäº‹åŠ¡æ‰§è¡Œå‰â€ï¼ˆæ’åºé˜¶æ®µï¼‰ã€‚è¿™æå¤§åœ°ç¼©çŸ­äº†â€œäº‰ç”¨è¶³è¿¹â€ã€‚

-----

### 4\. æ ¸å¿ƒæ¶æ„ï¼šä¸‰å±‚è§£è€¦ï¼ˆè§è®ºæ–‡ Figure 1ï¼‰

Calvin çš„ç³»ç»Ÿæ¶æ„è¢«æ¸…æ™°åœ°åˆ†ä¸ºä¸‰å±‚ ï¼Œå¦‚ä¸‹å›¾ï¼ˆè®ºæ–‡ Figure 1 ç®€åŒ–ç‰ˆï¼‰æ‰€ç¤º ï¼š  ![pic](20251103_03_pic_001.jpg)   

```mermaid
graph TD
    subgraph Client Application [å®¢æˆ·ç«¯]
        T(äº‹åŠ¡è¯·æ±‚)
    end

    subgraph Calvin Layer [Calvin äº‹åŠ¡å±‚]
        direction TB
        Seq(1\. å®šåºå±‚ Sequencer)
        Sch(2\. è°ƒåº¦å±‚ Scheduler)
    end

    subgraph Storage Layer [å­˜å‚¨å±‚]
        Store(3\. å­˜å‚¨å±‚ Storage)
    end

    T --> Seq
    Seq -- "1\. æ”¶é›†ã€æ’åºã€å¤åˆ¶æ—¥å¿—" --> Seq
    Seq -- "2\. æŠ•å–‚æ’å¥½åºçš„äº‹åŠ¡" --> Sch
    Sch -- "3\. æŒ‰é¡ºåºè·å–é”" --> Sch
    Sch -- "4\. å¹¶å‘æ‰§è¡Œ, è¯»/å†™æ•°æ®" --> Store
```

#### 1\. ğŸ¥‡ å®šåºå±‚ (Sequencing Layer)

è¿™æ˜¯ Calvin çš„â€œå¤§è„‘â€å’Œâ€œå«å·æœºâ€ã€‚

  * **åŠŸèƒ½ï¼š** æ‹¦æˆªæ‰€æœ‰å®¢æˆ·ç«¯çš„äº‹åŠ¡è¯·æ±‚ ï¼Œå¹¶ä¸ºå®ƒä»¬æ’å®šä¸€ä¸ª**å…¨çƒå”¯ä¸€çš„ä¸²è¡Œé¡ºåº** ã€‚
  * **å®ç°ï¼š** å®ƒå°†æ—¶é—´åˆ‡åˆ†ä¸º 10 æ¯«ç§’çš„â€œæ‰¹æ¬¡â€ (Epochs) ã€‚æ”¶é›†è¿™ä¸ªæ‰¹æ¬¡å†…çš„æ‰€æœ‰è¯·æ±‚ï¼Œç„¶åå°†è¿™ä¸ªâ€œäº‹åŠ¡æ‰¹æ¬¡â€æ—¥å¿—å¤åˆ¶åˆ°æ‰€æœ‰å‰¯æœ¬ ã€‚
  * **å¤åˆ¶ï¼š** è¿™ä¸€å±‚å°±å¤„ç†äº†æ•°æ®å¤åˆ¶ã€‚å®ƒå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŸºäº Paxos çš„åŒæ­¥å¤åˆ¶ ã€‚

#### 2\. ğŸ¥ˆ è°ƒåº¦å±‚ (Scheduling Layer)

è¿™æ˜¯ Calvin çš„â€œè°ƒåº¦ä¸­å¿ƒâ€å’Œâ€œé”ç®¡ç†å™¨â€ã€‚

  * **åŠŸèƒ½ï¼š** æ¥æ”¶æ¥è‡ªâ€œå®šåºå±‚â€çš„ã€æ’å¥½åºçš„äº‹åŠ¡æµ ã€‚
  * **æ ¸å¿ƒæŠ€æœ¯ (Deterministic Locking)ï¼š** è°ƒåº¦å±‚æ˜¯**å¹¶å‘**æ‰§è¡Œäº‹åŠ¡çš„ ï¼Œä½†å®ƒé€šè¿‡ä¸€ä¸ªå·§å¦™çš„â€œç¡®å®šæ€§é”ç®¡ç†å™¨â€æ¥*ä¿è¯*æ‰§è¡Œç»“æœç­‰ä»·äºå®šåºå±‚ç»™å‡ºçš„*ä¸²è¡Œ*é¡ºåºã€‚
  * **å®ç°ï¼š**
    1.  ä¸€ä¸ªä¸“æœ‰çº¿ç¨‹ä¼šä¸¥æ ¼æŒ‰ç…§ä¸²è¡Œé¡ºåºï¼Œ**æå‰**ä¸ºäº‹åŠ¡ç”³è¯·å®ƒéœ€è¦çš„æ‰€æœ‰é” ã€‚
    2.  é”ç®¡ç†å™¨ä¹Ÿå¿…é¡»ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªç”³è¯·é¡ºåºæ¥**æˆäºˆ**é” ã€‚
    3.  ä¸€æ—¦ä¸€ä¸ªäº‹åŠ¡æ‹¿åˆ°äº†å®ƒéœ€è¦çš„æ‰€æœ‰é”ï¼Œå®ƒå°±å¯ä»¥è¢«äº¤ç»™ä¸€ä¸ªâ€œå·¥ä½œçº¿ç¨‹â€å»å¹¶å‘æ‰§è¡Œäº† ã€‚
  * **å‰æï¼š** è¿™ä¸ªè®¾è®¡è¦æ±‚æ‰€æœ‰äº‹åŠ¡å¿…é¡»**æå‰å£°æ˜**å®ƒä»¬çš„â€œè¯»/å†™é›†â€ï¼ˆå³å®ƒä»¬ä¼šè¯»å†™å“ªäº›æ•°æ®ï¼‰ã€‚

#### 3\. ğŸ¥‰ å­˜å‚¨å±‚ (Storage Layer)

è¿™æ˜¯ Calvin çš„â€œä»“åº“â€å’Œâ€œè‚Œè‚‰â€ã€‚

  * **åŠŸèƒ½ï¼š** å®ƒæ˜¯ä¸€ä¸ªâ€œè¢«åŠ¨â€çš„å­˜å‚¨å¼•æ“ï¼Œåªè´Ÿè´£æ‰§è¡Œæœ€åŸºæœ¬çš„ `CRUD` æ“ä½œï¼ˆå¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰ã€‚
  * **è§£è€¦ï¼š** äº‹åŠ¡é€»è¾‘ã€å¹¶å‘æ§åˆ¶ã€å¤åˆ¶ç­‰åŠŸèƒ½éƒ½ä¸Šç§»åˆ°äº†ä¸Šé¢ä¸¤å±‚ã€‚è¿™ä½¿å¾— Calvin å¯ä»¥â€œæ’å…¥â€åˆ°ä»»ä½•ç°æœ‰çš„éäº‹åŠ¡æ€§å­˜å‚¨ç³»ç»Ÿï¼ˆå¦‚é”®å€¼å­˜å‚¨ï¼‰ä¹‹ä¸Š ã€‚

-----

### 5\. å…³é”®æŠ€æœ¯ç‚¹ï¼ˆCalvin çš„â€œJULIAâ€ï¼‰

#### 1\. å¤åˆ¶ï¼šå»¶è¿Ÿé«˜ï¼Œä½†ååé‡ä¸å—å½±å“ï¼ˆè§ Figure 2ï¼‰

Calvin éœ€è¦åœ¨â€œå®šåºå±‚â€é€šè¿‡ Paxos ç­‰åè®®åœ¨å‰¯æœ¬é—´åŒæ­¥â€œäº‹åŠ¡æ—¥å¿—â€ã€‚å¦‚æœå‰¯æœ¬åˆ†å¸ƒåœ¨ä¸åŒçš„å¤§æ´²ï¼ˆä¾‹å¦‚ç¾å›½ã€æ¬§æ´²ã€äºšæ´²ï¼‰ï¼Œè¿™ä¸ªåŒæ­¥å»¶è¿Ÿå¯èƒ½é«˜è¾¾å‡ ç™¾æ¯«ç§’ã€‚

**è®ºæ–‡ Figure 2** å°±å±•ç¤ºäº†è¿™ä¸€ç‚¹ï¼š  ![pic](20251103_03_pic_003.jpg)   

  * **Async (å¼‚æ­¥)ï¼š** å»¶è¿Ÿå‡ ä¹ä¸º0ã€‚
  * **Paxos (1ä¸ªæ•°æ®ä¸­å¿ƒ)ï¼š** å»¶è¿Ÿçº¦ 100ms ã€‚
  * **Paxos (3ä¸ªæ•°æ®ä¸­å¿ƒ)ï¼š** å»¶è¿Ÿé«˜è¾¾ 500ms ä»¥ä¸Š ã€‚

**ä½† Calvin çš„ç¥å¥‡ä¹‹å¤„åœ¨äºï¼š** æ— è®ºè¿™ä¸ªå»¶è¿Ÿæœ‰å¤šé«˜ï¼ˆ500ms æˆ– 1000msï¼‰ï¼Œå®ƒ **åªå½±å“å•ä¸ªäº‹åŠ¡çš„â€œå“åº”æ—¶é—´â€ï¼Œè€Œå®Œå…¨ä¸å½±å“ç³»ç»Ÿçš„â€œæ€»ååé‡â€ (Throughput)** ã€‚

ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºè¿™ä¸ªå»¶è¿Ÿå‘ç”Ÿåœ¨â€œäº‰ç”¨è¶³è¿¹â€ **ä¹‹å¤–** ï¼ç³»ç»Ÿä¸éœ€è¦æŒé”ç­‰å¾…è¿™ä¸ªå¤åˆ¶å®Œæˆã€‚å®šåºå™¨åœ¨ç­‰å¾… Paxos ç¡®è®¤çš„åŒæ—¶ï¼Œå¯ä»¥ç»§ç»­æ¥æ”¶å’Œå¤„ç†*åç»­*çš„äº‹åŠ¡è¯·æ±‚ã€‚

#### 2\. å¤„ç†ç£ç›˜ I/Oï¼šåŒ–â€œéç¡®å®šæ€§â€ä¸ºâ€œç¡®å®šæ€§â€

â€œç¡®å®šæ€§â€æ¨¡å‹æœ‰ä¸€ä¸ªå¤©æ•Œï¼š**ç£ç›˜ I/O**ã€‚
ç£ç›˜è¯»å†™æ˜¯ä¸€ä¸ªå»¶è¿Ÿä¸ç¡®å®šçš„â€œéç¡®å®šæ€§â€äº‹ä»¶ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§è¡Œä¸­çªç„¶è¦è¯»ç£ç›˜ï¼Œå®ƒå°±ä¼šå¡ä½ï¼Œè€Œå®ƒæŒæœ‰çš„é”ä¼šé˜»å¡åé¢æ‰€æœ‰æŒ‰é¡ºåºæ’é˜Ÿçš„äº‹åŠ¡ ã€‚

Calvin çš„è§£å†³æ–¹æ¡ˆéå¸¸å·§å¦™ï¼Œå«åš **â€œé¢„çƒ­â€ (Warm up)**  ï¼š

1.  å½“â€œå®šåºå±‚â€æ”¶åˆ°ä¸€ä¸ªéœ€è¦è¯»ç£ç›˜çš„äº‹åŠ¡æ—¶ï¼Œå®ƒ**ä¸ä¼š**ç«‹åˆ»æŠŠå®ƒäº¤ç»™â€œè°ƒåº¦å±‚â€ã€‚
2.  ç›¸åï¼Œå®šåºå±‚ä¼šâ€œæ‰£ä¸‹â€è¿™ä¸ªäº‹åŠ¡ï¼ŒåŒæ—¶å‘â€œå­˜å‚¨å±‚â€å‘é€ä¸€ä¸ª**å¼‚æ­¥çš„â€œé¢„çƒ­â€è¯·æ±‚**ï¼Œè®©å­˜å‚¨å±‚æå‰æŠŠæ•°æ®ä»ç£ç›˜åŠ è½½åˆ°å†…å­˜ä¸­ ã€‚
3.  å®šåºå±‚ä¼šâ€œå‡è£…â€è¿™ä¸ªäº‹åŠ¡åœ¨æ’é˜Ÿï¼Œç­‰å¾…ä¸€ä¸ªå®ƒä¼°è®¡çš„ç£ç›˜å»¶è¿Ÿæ—¶é—´ï¼ˆä¾‹å¦‚ 40msï¼‰ã€‚
4.  ç­‰æ—¶é—´åˆ°äº†ï¼Œå®šåºå±‚å†æŠŠè¿™ä¸ªäº‹åŠ¡äº¤ç»™è°ƒåº¦å±‚ã€‚æ­¤æ—¶ï¼Œæ•°æ®å¤§æ¦‚ç‡å·²ç»åœ¨å†…å­˜ä¸­äº†ï¼Œäº‹åŠ¡å¯ä»¥â€œé›¶å»¶è¿Ÿâ€åœ°æ‰§è¡Œï¼Œè€Œä¸ä¼šé˜»å¡ç³»ç»Ÿ ã€‚

è¿™ä¸ªæ–¹æ³•æˆåŠŸåœ°å°†â€œç£ç›˜ I/O å»¶è¿Ÿâ€ä¹Ÿç§»å‡ºäº†â€œäº‰ç”¨è¶³è¿¹â€ï¼ 

-----

### 6\. æ€§èƒ½è¯æ˜ï¼ˆè§ Figure 4 å’Œ Figure 6ï¼‰

Calvin çš„è®¾è®¡æ˜¯å¦çœŸçš„æœ‰æ•ˆï¼Ÿè®ºæ–‡ç»™å‡ºäº†å¼ºåŠ›çš„æ•°æ®è¯æ˜ã€‚

#### è¯æ˜ä¸€ï¼šçº¿æ€§æ‰©å±•èƒ½åŠ›ï¼ˆè§ Figure 4ï¼‰

Figure 4  å±•ç¤ºäº† Calvin åœ¨ TPC-Cï¼ˆä¸€ä¸ªæ ‡å‡†çš„æ•°æ®åº“åŸºå‡†æµ‹è¯•ï¼‰ä¸Šçš„è¡¨ç°ï¼š  ![pic](20251103_03_pic_004.jpg)   

  * **ä¸Šå›¾ï¼ˆæ€»ååé‡ï¼‰ï¼š** éšç€æœºå™¨æ•°é‡ä»1å¢åŠ åˆ°100ï¼Œç³»ç»Ÿçš„æ€»ååé‡**å‡ ä¹å‘ˆä¸€æ¡ç›´çº¿**å‘ä¸Šå¢é•¿ ã€‚è¿™å°±æ˜¯â€œï¼ˆè¿‘ï¼‰çº¿æ€§æ‰©å±•æ€§â€ã€‚
  * **ä¸‹å›¾ï¼ˆå•æœºååé‡ï¼‰ï¼š** åœ¨é›†ç¾¤è§„æ¨¡è¶…è¿‡10å°æœºå™¨åï¼Œæ¯å°æœºå™¨çš„ååé‡åŸºæœ¬ç¨³å®šåœ¨ 5000 txns/sec å·¦å³ ã€‚

**ç»“è®ºï¼š** Calvin å®ç°äº†â€œåŠ æœºå™¨å°±èƒ½æå‡æ€§èƒ½â€çš„ç†æƒ³çŠ¶æ€ã€‚åœ¨ 100 å°æ™®é€šçš„äº‘ä¸»æœºä¸Šï¼Œå®ƒå®ç°äº†è¿‘ 50 ä¸‡ TPC-C äº‹åŠ¡æ¯ç§’çš„æƒŠäººæˆç»©ï¼Œè¿™åœ¨å½“æ—¶æ¥è¿‘äº†ä½¿ç”¨é«˜ç«¯ç¡¬ä»¶åˆ›é€ çš„ä¸–ç•Œçºªå½• ã€‚

#### è¯æ˜äºŒï¼šç¢¾å‹ 2PCï¼ˆè§ Figure 6ï¼‰

**Figure 6  æ˜¯è¿™ç¯‡è®ºæ–‡çš„â€œDNFâ€ã€‚** å®ƒå¯¹æ¯”äº†åœ¨é«˜â€œäº‰ç”¨â€ (Contention) æƒ…å†µä¸‹ï¼ŒCalvin å’Œä¼ ç»Ÿ 2PC ç³»ç»Ÿçš„æ€§èƒ½â€œå‡é€Ÿâ€ (Slowdown) å¯¹æ¯”ã€‚  ![pic](20251103_03_pic_002.jpg)   

  * **æ¨ªåæ ‡ (Contention Factor)ï¼š** äº‰ç”¨ç¨‹åº¦ã€‚è¶Šå¾€å³ï¼Œä»£è¡¨æ•°æ®â€œè¶Šçƒ­â€ï¼Œå†²çªè¶Šä¸¥é‡ã€‚
  * **çºµåæ ‡ (Slowdown)ï¼š** æ€§èƒ½ä¸‹é™çš„å€æ•°ã€‚
  * **è™šçº¿ (System R\*-style w/ 2PC)ï¼š** ä¼ ç»Ÿçš„ 2PC ç³»ç»Ÿ ã€‚
  * **å®çº¿ (Calvin)ï¼š** Calvin ç³»ç»Ÿ (4 èŠ‚ç‚¹å’Œ 8 èŠ‚ç‚¹) ã€‚

**ç»“è®ºï¼š** æˆ‘ä»¬å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°ï¼Œéšç€äº‰ç”¨åŠ å‰§ï¼ˆæ¨ªåæ ‡å‘å³ç§»åŠ¨ï¼‰ï¼Œä¼ ç»Ÿ 2PC çš„æ€§èƒ½ï¼ˆè™šçº¿ï¼‰ **å‘ˆæŒ‡æ•°çº§å´©æºƒ** ï¼Œæ€§èƒ½ä¸‹é™äº† 100 å¤šå€ ã€‚è€Œ Calvinï¼ˆå®çº¿ï¼‰çš„æ€§èƒ½ä¸‹é™åˆ™**éå¸¸å¹³ç¼“**ï¼Œå‡ ä¹ä¸å—é«˜äº‰ç”¨çš„å½±å“ ã€‚

**è¿™æ— å¯è¾©é©³åœ°è¯æ˜äº†ï¼šCalvin çš„â€œç¡®å®šæ€§â€è®¾è®¡ï¼ŒæˆåŠŸåœ°è§£å†³äº†åˆ†å¸ƒå¼äº‹åŠ¡åœ¨é«˜äº‰ç”¨ä¸‹çš„æ€§èƒ½é›ªå´©é—®é¢˜ã€‚**

-----

### æ€»ç»“

Calvin æ˜¯ä¸€ç¯‡å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰çš„è®ºæ–‡ã€‚å®ƒé€šè¿‡å¼•å…¥â€œç¡®å®šæ€§æ‰§è¡Œâ€æ¨¡å‹ï¼Œå°†äº‹åŠ¡å¤„ç†æµç¨‹åˆ›æ–°åœ°é‡æ„ä¸º **â€œæ’åº -\> è°ƒåº¦ -\> å­˜å‚¨â€** ä¸‰å±‚ï¼Œå½»åº•æ¶ˆé™¤äº†ä¼ ç»Ÿ 2PC åè®®å¸¦æ¥çš„â€œäº‰ç”¨è¶³è¿¹â€ ã€‚å®ƒè¯æ˜äº†åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒACID äº‹åŠ¡å’Œè¿‘çº¿æ€§æ‰©å±•æ€§ä¸ä»…å¯ä»¥å…¼å¾—ï¼Œè¿˜èƒ½åœ¨ç£ç›˜å­˜å‚¨å’Œè·¨å¤§æ´²å¤åˆ¶ç­‰ä¸¥è‹›åœºæ™¯ä¸‹ä¾ç„¶ä¿æŒæé«˜çš„ååé‡ã€‚
  
## 3 æœ¯è¯­ 
  
ä»¥ä¸‹æ˜¯å¯¹ã€ŠCalvin: Fast Distributed Transactions For Partitioned Database Systemsã€‹è¿™ç¯‡è®ºæ–‡ä¸­å…³é”®æœ¯è¯­çš„æå–å’Œé€šä¿—è®²è§£ã€‚

-----

### 1\. åˆ†å¸ƒå¼äº‹åŠ¡ (Distributed Transaction)

  * **é€šä¿—è®²è§£ï¼š**
    æƒ³è±¡ä¸€ä¸‹ä½ çš„æ•°æ®è¢«â€œåˆ†åŒºâ€ï¼ˆåˆ‡åˆ†ï¼‰å­˜å‚¨åœ¨ 100 å°ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚ä¸€ä¸ªâ€œåˆ†å¸ƒå¼äº‹åŠ¡â€å°±æ˜¯ä¸€ä¸ªéœ€è¦åŒæ—¶è¯»å–æˆ–ä¿®æ”¹**å¤šå°æœåŠ¡å™¨**ä¸Šæ•°æ®çš„æ“ä½œ ã€‚
  * **ä¾‹å­ï¼š**
    é“¶è¡Œè½¬è´¦ã€‚ç”¨æˆ· Aï¼ˆæ•°æ®åœ¨æœåŠ¡å™¨1ï¼‰ç»™ç”¨æˆ· Bï¼ˆæ•°æ®åœ¨æœåŠ¡å™¨2ï¼‰è½¬è´¦ã€‚è¿™ä¸ªæ“ä½œå¿…é¡»åŒæ—¶ä¿®æ”¹ä¸¤å°æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼Œå¹¶ä¸”è¦ä¿è¯â€œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥â€ï¼ˆå³åŸå­æ€§ï¼‰ã€‚
  * **è®ºæ–‡ä¸­çš„æŒ‘æˆ˜ï¼š**
    ä¼ ç»Ÿçš„åˆ†å¸ƒå¼äº‹åŠ¡å¾ˆéš¾åœ¨ä¿è¯ ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰çš„åŒæ—¶ï¼Œè¿˜èƒ½å®ç°é«˜ååé‡å’Œé«˜æ‰©å±•æ€§ ã€‚

### 2\. ä¸¤é˜¶æ®µæäº¤ (Two-Phase Commit, 2PC)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯å®ç°åˆ†å¸ƒå¼äº‹åŠ¡â€œåŸå­æ€§â€çš„ä¼ ç»Ÿâ€œæŠ•ç¥¨â€æœºåˆ¶ã€‚
    1.  **é˜¶æ®µä¸€ï¼ˆå‡†å¤‡/æŠ•ç¥¨ï¼‰ï¼š** åè°ƒè€…é—®æ‰€æœ‰å‚ä¸çš„æœåŠ¡å™¨ï¼šâ€œä½ ä»¬èƒ½æäº¤è¿™ä¸ªäº‹åŠ¡å—ï¼Ÿâ€æ‰€æœ‰æœåŠ¡å™¨ä¼šé”å®šå®ƒä»¬éœ€è¦çš„æ•°æ®ï¼Œç„¶åå›å¤â€œå‡†å¤‡å¥½äº†â€æˆ–â€œå¤±è´¥â€ã€‚
    2.  **é˜¶æ®µäºŒï¼ˆæäº¤/ä¸­æ­¢ï¼‰ï¼š** å¦‚æœæ‰€æœ‰äººéƒ½è¯´â€œå‡†å¤‡å¥½äº†â€ï¼Œåè°ƒè€…å°±è¯´â€œå…¨éƒ¨æäº¤ï¼â€ï¼›åªè¦æœ‰ä¸€ä¸ªè¯´â€œå¤±è´¥â€ï¼Œåè°ƒè€…å°±è¯´â€œå…¨éƒ¨ä¸­æ­¢ï¼â€ ã€‚
  * **è®ºæ–‡ä¸­çš„æŒ‘æˆ˜ï¼š**
    2PC çš„è‡´å‘½é—®é¢˜åœ¨äºï¼Œ**åœ¨æ•´ä¸ªæŠ•ç¥¨å’Œç­‰å¾…æœ€ç»ˆå†³å®šçš„è¿‡ç¨‹ä¸­ï¼Œäº‹åŠ¡å¿…é¡»ä¸€ç›´æŒæœ‰é”** ã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠå¤šæ¬¡ç½‘ç»œå¾€è¿”ï¼Œé€Ÿåº¦å¾ˆæ…¢ ã€‚

### 3\. äº‰ç”¨è¶³è¿¹ (Contention Footprint)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„æœ¯è¯­ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºâ€œ**ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹å ç”¨èµ„æºï¼ˆåŠ é”ï¼‰åˆ°é‡Šæ”¾èµ„æºï¼ˆè§£é”ï¼‰çš„æ€»æ—¶é•¿**â€ ã€‚
  * **ä¸ºä»€ä¹ˆé‡è¦ï¼š**
    ä¸€ä¸ªäº‹åŠ¡çš„â€œäº‰ç”¨è¶³è¿¹â€è¶Šå¤§ï¼Œå®ƒâ€œéœ¸å â€èµ„æºçš„æ—¶é—´å°±è¶Šé•¿ï¼Œå…¶ä»–éœ€è¦ç›¸åŒèµ„æºçš„äº‹åŠ¡å°±åªèƒ½æ’é˜Ÿç­‰å¾…ã€‚
  * **è®ºæ–‡ä¸­çš„è§‚ç‚¹ï¼š**
    ä¼ ç»Ÿ 2PC æ–¹æ¡ˆçš„â€œäº‰ç”¨è¶³è¿¹â€ **éå¸¸å¤§** ï¼Œå› ä¸ºå®ƒæŠŠç½‘ç»œé€šä¿¡å»¶è¿Ÿï¼ˆæŠ•ç¥¨ã€ç­‰å¾…æäº¤ï¼‰çš„æ—¶é—´ä¹Ÿç®—è¿›äº†æŒé”æ—¶é—´ ã€‚Calvin çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯**é€šè¿‡æ¶ˆé™¤ 2PC æ¥æ˜¾è‘—ç¼©å°è¿™ä¸ªâ€œäº‰ç”¨è¶³è¿¹â€** ã€‚

### 4\. ç¡®å®šæ€§ (Determinism) / ç¡®å®šæ€§æ•°æ®åº“ç³»ç»Ÿ

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯ Calvin çš„æ ¸å¿ƒé­”æ³•ã€‚ä¸€ä¸ªç³»ç»Ÿæ˜¯â€œç¡®å®šæ€§â€çš„ï¼Œæ„å‘³ç€â€œ**åªè¦ç»™å®šç›¸åŒçš„è¾“å…¥å’Œç›¸åŒçš„é¡ºåºï¼Œæ— è®ºä½•æ—¶ä½•åœ°è¿è¡Œï¼Œå®ƒéƒ½å¿…é¡»äº§ç”Ÿå®Œå…¨ç›¸åŒçš„ç»“æœ**â€ ã€‚
  * **å¯¹æ¯”ï¼š**
    ä¼ ç»Ÿæ•°æ®åº“æ˜¯â€œéç¡®å®šæ€§â€çš„ã€‚ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶è¿è¡Œï¼Œä»Šå¤©å¯èƒ½æ˜¯Aå…ˆæ‰§è¡Œï¼Œæ˜å¤©å› ä¸ºçº¿ç¨‹è°ƒåº¦æˆ–ç½‘ç»œå»¶è¿Ÿï¼Œå¯èƒ½æ˜¯Bå…ˆæ‰§è¡Œï¼Œå¯¼è‡´ç»“æœçš„ç‰©ç†é¡ºåºä¸ç¡®å®š ã€‚
  * **Calvin çš„åšæ³•ï¼š**
    Calvin é€šè¿‡â€œå®šåºå±‚â€å¼ºåˆ¶è§„å®šäº†æ‰€æœ‰äº‹åŠ¡çš„**å”¯ä¸€æ‰§è¡Œé¡ºåº** ã€‚æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹éƒ½å¿…é¡»ä¸¥æ ¼éµå®ˆè¿™ä¸ªé¡ºåºã€‚

### 5\. Calvin çš„ä¸‰å±‚æ¶æ„ (System Architecture)

Calvin å°†äº‹åŠ¡å¤„ç†åˆ†è§£ä¸ºä¸‰ä¸ªç‹¬ç«‹çš„å±‚æ¬¡ ï¼Œä½ å¯ä»¥é€šè¿‡è®ºæ–‡çš„ Figure 1ï¼ˆä¸‹å›¾ç®€åŒ–ç‰ˆï¼‰æ¥ç†è§£ï¼š  ![pic](20251103_03_pic_001.jpg)   

```mermaid
graph TD
    A(å®¢æˆ·ç«¯åº”ç”¨) --> B(1\. å®šåºå±‚ Sequencer);
    B -- "1\. æ’åºå¹¶å¤åˆ¶äº‹åŠ¡" --> B;
    B -- "2\. å–‚é€æ’å¥½åºçš„äº‹åŠ¡æµ" --> C(2\. è°ƒåº¦å±‚ Scheduler);
    C -- "3\. æŒ‰é¡ºåºè·å–é”å¹¶å¹¶å‘æ‰§è¡Œ" --> D(3\. å­˜å‚¨å±‚ Storage);
```

  * **1. å®šåºå±‚ (Sequencing Layer / Sequencer):**
    è¿™æ˜¯ Calvin çš„â€œå¤§è„‘â€ ã€‚å®ƒ **åªè´Ÿè´£ä¸€ä»¶äº‹ï¼šç»™æ‰€æœ‰è¿›æ¥çš„äº‹åŠ¡â€œæ’é˜Ÿâ€** ï¼Œç”Ÿæˆä¸€ä¸ªå…¨çƒç»Ÿä¸€çš„â€œäº‹åŠ¡è¾“å…¥åºåˆ—â€ï¼ˆå°±åƒé“¶è¡Œçš„å«å·æœºï¼‰ã€‚å®ƒä¸æ‰§è¡Œäº‹åŠ¡ï¼Œä½†å®ƒè´Ÿè´£å°†è¿™ä¸ªæ’å¥½åºçš„â€œåºåˆ—æ—¥å¿—â€å¤åˆ¶åˆ°æ‰€æœ‰å‰¯æœ¬ ã€‚
  * **2. è°ƒåº¦å±‚ (Scheduling Layer / Scheduler):**
    è¿™æ˜¯ Calvin çš„â€œæŒ‡æŒ¥å®˜â€ ã€‚å®ƒä»å®šåºå±‚è·å–æ’å¥½åºçš„â€œä»»åŠ¡æ¸…å•â€ï¼Œç„¶åä½¿ç”¨â€œç¡®å®šæ€§é”åè®®â€æ¥**å¹¶å‘åœ°æ‰§è¡Œ**è¿™äº›äº‹åŠ¡ï¼ŒåŒæ—¶ä¿è¯æ‰§è¡Œç»“æœåœ¨é€»è¾‘ä¸Šç­‰åŒäºâ€œä»»åŠ¡æ¸…å•â€çš„ä¸²è¡Œé¡ºåº ã€‚
  * **3. å­˜å‚¨å±‚ (Storage Layer):**
    è¿™æ˜¯ Calvin çš„â€œä»“åº“â€ã€‚å®ƒæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å­˜å‚¨å¼•æ“ï¼Œåªéœ€è¦æä¾› `CRUD`ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰æ¥å£ ã€‚æ‰€æœ‰çš„äº‹åŠ¡ã€å¹¶å‘ã€å¤åˆ¶é€»è¾‘éƒ½ç”±ä¸Šä¸¤å±‚å¤„ç†äº† ã€‚

### 6\. ç¡®å®šæ€§é”åè®® (Deterministic Locking Protocol)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯â€œè°ƒåº¦å±‚â€ç”¨æ¥ä¿è¯â€œç¡®å®šæ€§â€çš„è§„åˆ™ã€‚å®ƒè§„å®šï¼š
    1.  äº‹åŠ¡**å¿…é¡»**æŒ‰ç…§â€œå®šåºå±‚â€ç»™å‡ºçš„å…¨å±€é¡ºåºæ¥**è¯·æ±‚**é” ã€‚
    2.  é”ç®¡ç†å™¨ä¹Ÿ**å¿…é¡»**ä¸¥æ ¼æŒ‰ç…§äº‹åŠ¡çš„è¯·æ±‚é¡ºåºæ¥**æˆäºˆ**é” ã€‚
  * **æ•ˆæœï¼š**
    å¦‚æœäº‹åŠ¡ A æ’åœ¨äº‹åŠ¡ B å‰é¢ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½éœ€è¦é” Rï¼Œé‚£ä¹ˆ B å¿…é¡»ç­‰åˆ° A æ‰§è¡Œå®Œæ¯•å¹¶é‡Šæ”¾ R ä¹‹åï¼Œæ‰èƒ½è·å¾— R çš„é” ã€‚è¿™å°±ç¡®ä¿äº†æ‰§è¡Œç»“æœå’Œå…¨å±€æ’åºä¸€è‡´ã€‚

### 7\. è¯»/å†™é›† (Read/Write Sets)

  * **é€šä¿—è®²è§£ï¼š**
    ä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§è¡Œå‰ï¼Œéœ€è¦è®¿é—®çš„ **æ‰€æœ‰æ•°æ®ï¼ˆè¯»ï¼‰** å’Œéœ€è¦ä¿®æ”¹çš„ **æ‰€æœ‰æ•°æ®ï¼ˆå†™ï¼‰** çš„æ¸…å•ã€‚
  * **è®ºæ–‡ä¸­çš„è¦æ±‚ï¼š**
    Calvin çš„â€œç¡®å®šæ€§é”åè®®â€è¦æ±‚æ‰€æœ‰äº‹åŠ¡å¿…é¡»**æå‰å£°æ˜**å®ƒä»¬å®Œæ•´çš„è¯»/å†™é›† ã€‚è¿™æ˜¯ä¸ºäº†è®©â€œè°ƒåº¦å±‚â€èƒ½åœ¨äº‹åŠ¡æ‰§è¡Œå‰å°±ä¸ºå®ƒç”³è¯·æ‰€æœ‰éœ€è¦çš„é”ã€‚

### 8\. ä¹è§‚é”å®šä½é¢„æµ‹ (OLLP - Optimistic Lock Location Prediction)

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯é’ˆå¯¹â€œè¯»/å†™é›†â€æå‰æœªçŸ¥çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼šéœ€è¦å…ˆè¯»ç´¢å¼•ï¼Œæ‰èƒ½çŸ¥é“è¦æ”¹å“ªæ¡æ•°æ®ï¼‰çš„ä¸€ä¸ªè¡¥ä¸æ–¹æ¡ˆ ã€‚
  * **åšæ³•ï¼š**
    1.  å®¢æˆ·ç«¯å…ˆå‘é€ä¸€ä¸ªå»‰ä»·çš„ã€ä½éš”ç¦»æ€§çš„â€œ**ä¾¦å¯ŸæŸ¥è¯¢**â€(reconnaissance query)ï¼Œå…ˆæ‰¾å‡ºå®Œæ•´è¯»/å†™é›† ã€‚
    2.  ç„¶åï¼Œå†æŠŠè¿™ä¸ªâ€œä¾¦å¯Ÿâ€åˆ°çš„è¯»/å†™é›†å’ŒçœŸæ­£çš„äº‹åŠ¡é€»è¾‘ï¼Œä¸€èµ·æäº¤ç»™ Calvin çš„â€œå®šåºå±‚â€ ã€‚
    3.  åœ¨â€œè°ƒåº¦å±‚â€çœŸæ­£æ‰§è¡Œæ—¶ï¼Œä¼šï¼ˆç¡®å®šæ€§åœ°ï¼‰ **é‡æ–°æ£€æŸ¥** è¿™ä¸ªè¯»/å†™é›†æ˜¯å¦ä»ç„¶æœ‰æ•ˆï¼Œå¦‚æœå¤±æ•ˆåˆ™é‡å¯ ã€‚

### 9\. æ•°æ®é¢„å– / é¢„çƒ­ (Data Prefetching / "Warm up")

  * **é€šä¿—è®²è§£ï¼š**
    è¿™æ˜¯ Calvin ç”¨æ¥å¤„ç†**ç£ç›˜å­˜å‚¨**ï¼ˆè€Œä¸ä»…ä»…æ˜¯å†…å­˜ï¼‰çš„å…³é”®æŠ€æœ¯ ã€‚
  * **é—®é¢˜ï¼š**
    ç£ç›˜ I/O å»¶è¿Ÿéå¸¸é«˜ä¸”â€œéç¡®å®šæ€§â€ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§è¡Œä¸­ï¼ˆæŒé”æ—¶ï¼‰å»è¯»ç£ç›˜ï¼Œå®ƒä¼šå¡ä½ï¼Œè¿›è€Œé˜»å¡åé¢æ‰€æœ‰æ’é˜Ÿçš„äº‹åŠ¡ ã€‚
  * **Calvin çš„æ–¹æ¡ˆï¼š**
    â€œå®šåºå±‚â€åœ¨æ”¶åˆ°ä¸€ä¸ªéœ€è¦è¯»ç›˜çš„äº‹åŠ¡æ—¶ï¼Œä¼š **â€œæ‰£ä½â€** è¿™ä¸ªäº‹åŠ¡ ã€‚å®ƒå…ˆå‘â€œå­˜å‚¨å±‚â€å‘é€ä¸€ä¸ªå¼‚æ­¥çš„ **â€œé¢„çƒ­â€è¯·æ±‚** ï¼Œè®©å­˜å‚¨å±‚æå‰æŠŠæ•°æ®ä»ç£ç›˜åŠ è½½åˆ°å†…å­˜ ã€‚å®šåºå±‚ä¼šç­‰å¾…ä¸€ä¸ªâ€œä¼°è®¡çš„ I/O å»¶è¿Ÿæ—¶é—´â€ï¼Œç„¶åå†æŠŠäº‹åŠ¡äº¤ç»™â€œè°ƒåº¦å±‚â€ ã€‚
  * **æ•ˆæœï¼š**
    å½“äº‹åŠ¡çœŸæ­£æ‰§è¡Œæ—¶ï¼Œæ•°æ®å·²ç»åœ¨å†…å­˜ä¸­äº†ã€‚**ç£ç›˜ I/O å»¶è¿Ÿè¢«æˆåŠŸåœ°ç§»å‡ºäº†â€œäº‰ç”¨è¶³è¿¹â€** ã€‚

### 10\. (æ€§èƒ½å¯¹æ¯”) Figure 6

è¿™ä¸ªå›¾æ˜¯ Calvin è®ºæ–‡æœ€æœ‰è¯´æœåŠ›çš„è¯æ®ä¹‹ä¸€ï¼Œå®ƒå±•ç¤ºäº† Calvin å¦‚ä½•åœ¨é«˜â€œäº‰ç”¨â€ (Contention) ä¸‹å®Œèƒœ 2PCã€‚  ![pic](20251103_03_pic_002.jpg)   

> **å›¾ 6 è§£è¯»ï¼š**  
>  
>   * **æ¨ªåæ ‡ (Contention Factor):** äº‰ç”¨ç¨‹åº¦ã€‚è¶Šå¾€å³ï¼Œæ•°æ®è¶Šâ€œçƒ­â€ï¼Œå†²çªè¶Šä¸¥é‡ã€‚  
>   * **çºµåæ ‡ (Slowdown):** æ€§èƒ½ä¸‹é™çš„å€æ•°ã€‚  
>     * **è™šçº¿ (System R\*-style w/ 2PC):** ä¼ ç»Ÿ 2PC ç³»ç»Ÿ ã€‚  
>     * **å®çº¿ (Calvin):** Calvin ç³»ç»Ÿ ã€‚  
>  
> **ç»“è®ºï¼š** éšç€äº‰ç”¨åŠ å‰§ï¼Œ2PC ç³»ç»Ÿï¼ˆè™šçº¿ï¼‰çš„æ€§èƒ½å‘ˆæŒ‡æ•°çº§å´©æºƒ ã€‚è€Œ Calvinï¼ˆå®çº¿ï¼‰çš„æ€§èƒ½åˆ™éå¸¸ç¨³å®šï¼Œå—é«˜äº‰ç”¨çš„å½±å“æå° ã€‚è¿™è¯æ˜äº† Calvin çš„â€œç¡®å®šæ€§â€è®¾è®¡æˆåŠŸè§£å†³äº†â€œäº‰ç”¨è¶³è¿¹â€é—®é¢˜ã€‚  
  
## å‚è€ƒ        
         
https://dl.acm.org/doi/pdf/10.1145/2213836.2213838    
        
<b> ä»¥ä¸Šå†…å®¹åŸºäºDeepSeekã€Qwenã€GeminiåŠè¯¸å¤šAIç”Ÿæˆ, è½»å¾®äººå·¥è°ƒæ•´, æ„Ÿè°¢æ­å·æ·±åº¦æ±‚ç´¢äººå·¥æ™ºèƒ½ã€é˜¿é‡Œäº‘ã€Googleç­‰å…¬å¸. </b>        
        
<b> AI ç”Ÿæˆçš„å†…å®¹è¯·è‡ªè¡Œè¾¨åˆ«æ­£ç¡®æ€§, å½“ç„¶ä¹Ÿå¤šäº†äº›è®¸è¸©å‘çš„ä¹è¶£, æ¯•ç«Ÿå†’é™©æ˜¯æ¯ä¸ªç”·äººçš„å¤©æ€§.  </b>        
    
#### [æœŸæœ› PostgreSQL|å¼€æºPolarDB å¢åŠ ä»€ä¹ˆåŠŸèƒ½?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB å¼€æºæ•°æ®åº“](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB å­¦ä¹ å›¾è°±](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [PostgreSQL è§£å†³æ–¹æ¡ˆé›†åˆ](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [å¾·å“¥ / digoal's Github - å…¬ç›Šæ˜¯ä¸€è¾ˆå­çš„äº‹.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About å¾·å“¥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
