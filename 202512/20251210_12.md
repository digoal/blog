## å¤§å­¦ç”Ÿæ•°æ®åº“å®è·µè¯¾: 6 RAG æ¦‚å¿µ     
      
### ä½œè€…      
digoal      
      
### æ—¥æœŸ      
2025-12-10      
      
### æ ‡ç­¾      
PostgreSQL , DuckDB , è¯­ä¹‰æœç´¢ , å‘é‡æœç´¢ , å…³é”®è¯æ£€ç´¢ , å…¨æ–‡æ£€ç´¢ , æ ‡é‡æ£€ç´¢ , æ··åˆæœç´¢ , å¤šæ¨¡æ€æœç´¢ , é‡æ’åº , embedding , document split , ORC , å¤§æ¨¡å‹ , å¤šæ¨¡æ€å¤§æ¨¡å‹ , Dify , å‹åŠ›æµ‹è¯• , ç´¢å¼•ä¼˜åŒ– , å€’æ’å‘é‡ç´¢å¼• , Ivfflat , å›¾å‘é‡ç´¢å¼• , HNSW , DiskANN , é‡åŒ– , rabitq , sbq , äºŒå€¼é‡åŒ– , bm25 , ç›¸å…³æ€§ , ç›¸ä¼¼æ€§ , å¬å›ç‡ , pgbench , æ•°æ®é›† , ann-benchmarks , å›¾æœç´¢ , PGQ , é€’å½’ , æ·±åº¦ä¼˜å…ˆ , å¹¿åº¦ä¼˜å…ˆ , æœ€çŸ­è·¯å¾„ , Nåº¦å…³ç³» , LLM , Ollama      
      
----      
      
## èƒŒæ™¯      
  
é¢å‘å¤§å­¦ç”Ÿ, é€šä¿—æ˜“æ‡‚çš„è§£è¯»è¿™ç¯‡æ–‡ç« : https://github.com/digoal/blog/blob/master/202504/20250414_04.md     
  
é’ˆå¯¹ä»¥ä¸Šæ–‡ç« , å¾ªåºæ¸è¿›çš„æå‡ºå‡ ä¸ªé—®é¢˜, å¸®åŠ©åŠ æ·±å¯¹æ–‡ç« çš„ç†è§£;    
  
æµ…æ˜¾æ˜“æ‡‚çš„å›ç­”è¿™å‡ ä¸ªé—®é¢˜;    
    
-----  
  
## ğŸ¤– ä¸ºä»€ä¹ˆç”¨äº† RAGï¼Œæˆ‘çš„ AI è¿˜æ˜¯â€œç¬¨â€ï¼Ÿï¼ˆRAG æ•ˆæœè¯„æµ‹ä¸ä¼˜åŒ–ï¼‰  
  
### 1. æ ¸å¿ƒé—®é¢˜ï¼šRAG æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ  
  
#### ğŸ“Œ RAG æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰  
  
æƒ³è±¡ä¸€ä¸‹ï¼Œå¤§æ¨¡å‹ï¼ˆæ¯”å¦‚ GPT-4, Geminiï¼‰å°±åƒä¸€ä¸ª**è®°å¿†åŠ›è¶…å¼ºçš„â€œå­¦éœ¸â€** ï¼Œå®ƒçŸ¥é“æ‰€æœ‰æ•™ç§‘ä¹¦ä¸Šçš„çŸ¥è¯†ï¼ˆè®­ç»ƒæ•°æ®ï¼‰ã€‚  
  
* **RAG çš„å·¥ä½œåŸç†ï¼š** å½“ä½ é—®å®ƒä¸€ä¸ªå…³äº**æ–°çŸ¥è¯†**æˆ–**ä¸“ä¸šç§æœ‰æ•°æ®**ï¼ˆæ¯”å¦‚ä½ å…¬å¸æœ€æ–°çš„å†…éƒ¨æ–‡ä»¶ã€ä½ ä¸ªäººçš„ç—…å†æ•°æ®ï¼‰çš„é—®é¢˜æ—¶ï¼ŒRAG æœºåˆ¶ä¼šè®©å­¦éœ¸**å…ˆå»â€œæŸ¥é˜…â€** ä½ ç»™çš„è¿™äº›å¤–éƒ¨èµ„æ–™ï¼Œç„¶åæ ¹æ®æŸ¥åˆ°çš„èµ„æ–™æ¥å›ç­”ä½ çš„é—®é¢˜ã€‚  
    * **æœ¬è´¨ï¼š** ç»“åˆäº† **æ£€ç´¢ï¼ˆRetrievalï¼ŒæŸ¥èµ„æ–™ï¼‰** å’Œ **ç”Ÿæˆï¼ˆGenerationï¼Œå†™ç­”æ¡ˆï¼‰** ä¸¤ç§èƒ½åŠ›ã€‚  
  
  
  
#### ğŸ“Œ ä¸ºä»€ä¹ˆéœ€è¦ RAGï¼Ÿï¼ˆè§£å†³â€œå¹»è§‰â€å’ŒçŸ¥è¯†ç›²åŒºï¼‰  
  
1.  **çŸ¥è¯†ç›²åŒºï¼š** å¤§æ¨¡å‹è®­ç»ƒæ—¶æ²¡ç”¨åˆ°çš„çŸ¥è¯†ï¼ˆä¾‹å¦‚ä¼ä¸šå†…éƒ¨æ–‡æ¡£ã€æœ€æ–°çš„æ—¶äº‹ã€ä¿å¯†æ•°æ®ï¼‰ï¼Œå®ƒå°±ä¸çŸ¥é“ã€‚  
2.  **æˆæœ¬/æ—¶æ•ˆæ€§ï¼š** é‡æ–°è®­ç»ƒæˆ–å¾®è°ƒå¤§æ¨¡å‹è€—è´¹å·¨å¤§ã€è€—æ—¶æ¼«é•¿ã€‚RAG ç›¸å½“äºç»™å®ƒä¸€ä¸ª **â€œæ´»å­—å…¸â€** ï¼Œæˆæœ¬ä½ã€æ›´æ–°å¿«ã€‚  
3.  **â€œå¹»è§‰â€ï¼š** å¤§æ¨¡å‹åœ¨ä¸çŸ¥é“ç­”æ¡ˆæ—¶ä¼š **â€œä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“â€** ã€‚RAG æä¾›äº†äº‹å®ä¾æ®ï¼Œå‡å°‘äº†è¿™ç§â€œèƒ¡è¯´â€ç°è±¡ã€‚  
  
  
  
### 2. ä¸ºä»€ä¹ˆ AI è¿˜æ˜¯â€œç¬¨â€ï¼Ÿâ€”â€” ç³»ç»Ÿçš„è¯„ä¼°æ‰æ˜¯å…³é”®ï¼  
  
ä½œè€…æŒ‡å‡ºï¼Œä¸èƒ½å‡­æ„Ÿè§‰è¯´ AI ç¬¨ï¼Œéœ€è¦**ç§‘å­¦åœ°é‡åŒ–è¯„ä¼°**ã€‚  
  
æ–‡ç« é‡ç‚¹æ¨èäº†å¼€æºé¡¹ç›® **Ragas**ï¼ˆä¸€ä¸ªè¯„æµ‹å·¥å…·ï¼‰ï¼Œå®ƒå°† RAG çš„æ•ˆæœæ‹†è§£æˆä¸‰ä¸ªå…³é”®æŒ‡æ ‡æ¥è¡¡é‡ï¼Œå°±åƒç»™ AI åšäº†ä¸ªâ€œæœŸæœ«è€ƒè¯•â€ã€‚  
  
| è¯„ä¼°æŒ‡æ ‡ | è¡¡é‡ç›®æ ‡ | é€šä¿—ç†è§£ |  
| :--- | :--- | :--- |  
| **1. å›ç­”å‡†ç¡®ç‡ (Answer Correctness)** | æœ€ç»ˆç­”æ¡ˆä¸æ ‡å‡†ç­”æ¡ˆçš„ç›¸ä¼¼åº¦å’Œäº‹å®å‡†ç¡®åº¦ã€‚ | **ä½ ç­”å¯¹äº†å—ï¼Ÿ** (0.25 è¯­ä¹‰ç›¸ä¼¼åº¦ + 0.75 äº‹å®å‡†ç¡®åº¦ F1 Score) |  
| **2. å¬å›è¦†ç›–ç‡ (Context Recall)** | æ£€ç´¢åˆ°çš„å¤–éƒ¨èµ„æ–™ï¼ˆContextsï¼‰æ˜¯å¦æ¶µç›–äº†æ­£ç¡®ç­”æ¡ˆæ‰€æ¶‰åŠçš„**æ‰€æœ‰å…³é”®ä¿¡æ¯ç‚¹**ã€‚ | **ä½ æŸ¥å…¨äº†å—ï¼Ÿ** (æŸ¥åˆ°çš„å…³é”®ç‚¹æ•°é‡ / æ­£ç¡®ç­”æ¡ˆæ€»å…³é”®ç‚¹æ•°é‡) |  
| **3. å¬å›ç²¾åº¦ (Context Precision)** | æ£€ç´¢åˆ°çš„å¤–éƒ¨èµ„æ–™æœ‰å¤šå°‘æ˜¯**çœŸæ­£ç›¸å…³çš„**ï¼Œä»¥åŠæœ€ç›¸å…³çš„èµ„æ–™æ˜¯å¦æ’åœ¨å‰é¢ã€‚ | **ä½ æŸ¥å‡†äº†å—ï¼Ÿ** (æ— å…³èµ„æ–™å¤ªå¤šæˆ–å…³é”®ä¿¡æ¯æ’åœ¨åé¢ï¼Œéƒ½ä¼šæ‰£åˆ†) |  
  
#### ğŸ”‘ â€œç¬¨â€çš„å››ä¸ªåŸå› è¯Šæ–­è¡¨ï¼ˆé‡ç‚¹ï¼‰  
  
| å›ç­”æ­£ç¡®æ€§ | å¬å›è¦†ç›–ç‡ | å¬å›ç²¾åº¦ | **æ ¸å¿ƒé—®é¢˜æ‰€åœ¨** | **é€šä¿—çš„æ¯”å–»** |  
| :---: | :---: | :---: | :--- | :--- |  
| ä½ | é«˜ | é«˜ | **æ¨¡å‹ä¸è¡Œ**ï¼ˆç»™äº†æ­£ç¡®ä¿¡æ¯ï¼Œå¤§æ¨¡å‹ä¹Ÿä¸ä¼šç”¨ï¼‰ | è€å¸ˆæŠŠæ‰€æœ‰ç­”æ¡ˆéƒ½å†™åœ¨é»‘æ¿ä¸Šäº†ï¼Œä½ è¿˜æ˜¯ç­”é”™äº†ã€‚ |  
| ä½ | é«˜ | ä½ | **å¬å›å¹²æ‰°å¤ªå¤š**ï¼ˆæ— å…³ä¿¡æ¯æ’åœ¨å‰é¢ï¼Œå¤§æ¨¡å‹è¢«è¯¯å¯¼ï¼‰ | è€å¸ˆç»™ä½ ä¸€å †å‚è€ƒä¹¦ï¼Œå…¶ä¸­ 90% æ˜¯ä¸ç›¸å…³çš„ï¼Œä½ è¢«å¸¦åäº†ã€‚ |  
| ä½ | ä½ | é«˜ | **å¬å›ä¿¡æ¯ä¸å…¨**ï¼ˆæ¼æ‰äº†å…³é”®ä¿¡æ¯ï¼‰ | è€å¸ˆåªç»™äº†ä½ ä¸€åŠç­”æ¡ˆï¼Œä½ å½“ç„¶ç­”ä¸å…¨ã€‚ |  
| ä½ | ä½ | ä½ | **å…¨æ–¹ä½é—®é¢˜**ï¼ˆè§£æã€åˆ‡åˆ†ã€å¬å›éƒ½æœ‰é—®é¢˜ï¼‰ | ä½ ç”¨çš„å‚è€ƒä¹¦æ˜¯ä¹±ç çš„ï¼Œè€Œä¸”æŸ¥åˆ°çš„éƒ½æ˜¯é”™çš„ã€‚ |  
  
  
  
### 3. å¦‚ä½•è®© AI å˜â€œèªæ˜â€ï¼Ÿâ€”â€” RAG çš„ç³»ç»Ÿä¼˜åŒ–  
  
é’ˆå¯¹ä¸Šé¢çš„è¯Šæ–­ï¼Œä½œè€…æå‡ºäº†ä¸€ä¸ªå®Œæ•´çš„ RAG ä¼˜åŒ–æµç¨‹ï¼Œè¿™æ˜¯ä¸€ä¸ª**å¤šé˜¶æ®µçš„ç³»ç»Ÿå·¥ç¨‹**ã€‚  
  
  
  
#### ğŸ’¡ ä¼˜åŒ–æ€è·¯æ¦‚è§ˆï¼ˆä»æºå¤´åˆ°ç»“æœï¼‰  
  
| é˜¶æ®µ | å‡ºç°çš„é—®é¢˜ | è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ä½•æ”¹è¿›ï¼‰ |  
| :--- | :--- | :--- |  
| **1. æ–‡æ¡£å¤„ç† (Chunking)** | æ–‡æ¡£åˆ‡åˆ†å¤ªç²—æˆ–å¤ªç»†ï¼Œå¯¼è‡´ä¿¡æ¯ä¸¢å¤±æˆ–å™ªéŸ³è¿‡å¤šã€‚ | **æ”¹è¿›åˆ‡åˆ†æ–¹æ³•ï¼š** æŒ‰å›ºå®š tokensã€æŒ‰å¥å­ã€æŒ‰è¯­ä¹‰ï¼Œç”šè‡³ä½¿ç”¨ **â€œçˆ¶å­æ¨¡å¼â€** ï¼ˆç”¨çˆ¶æ–‡æœ¬è·å–ä¸Šä¸‹æ–‡ï¼Œå­æ–‡æœ¬ç²¾å‡†åŒ¹é…é—®é¢˜ï¼‰ã€‚ |  
| **2. å‘é‡åŒ– (Embedding)** | è½¬æ¢å‡ºçš„å‘é‡ä¸å¤Ÿç²¾ç¡®ï¼Œç›¸ä¼¼åº¦è®¡ç®—ä¸å‡†ç¡®ã€‚ | **å‡çº§ Embedding æ¨¡å‹ï¼š** æ›´æ¢æ–°çš„ã€å¯¹ä¸­æ–‡æ”¯æŒæ›´å¥½çš„æ¨¡å‹ï¼Œå¹¶é‡æ–°ç”Ÿæˆæ‰€æœ‰æ–‡æ¡£å‘é‡ã€‚ |  
| **3. å¬å› (Retrieval)** | å¬å›ä¸å‡†æˆ–ä¸å…¨ã€‚ | **å¤šè·¯å¬å›ï¼š** ä¸åªç”¨å‘é‡æœç´¢ï¼Œç»“åˆ**æ¨¡ç³ŠæŸ¥è¯¢**ã€**å…³é”®è¯åŒ¹é… (å¦‚ BM25)** ã€**æ ‡ç­¾æœç´¢**ï¼ˆå¯¹å†…å®¹æ‰“ä¸Šäººç‰©ã€åœ°ç‚¹ç­‰æ ‡ç­¾ï¼‰ã€‚ |  
| **4. æ’åº (Rerank)** | å¬å›ç»“æœè™½ç„¶å…¨ï¼Œä½†æ— å…³ä¿¡æ¯æ’åœ¨å‰é¢ï¼ˆå³å¬å›ç²¾åº¦ä½ï¼‰ã€‚ | **å¼•å…¥ Rerank æ¨¡å‹ï¼š** å¯¹å¤šè·¯å¬å›çš„ç»“æœè¿›è¡Œ**äºŒæ¬¡æ’åº**ï¼ŒæŠŠæœ€ç›¸å…³çš„æ¡ç›®æåˆ°æœ€å‰é¢ã€‚ |  
| **5. ä¸Šä¸‹æ–‡ (Context)** | å¬å›çš„ç‰‡æ®µå¤ªçŸ­ï¼Œç¼ºä¹èƒŒæ™¯ä¿¡æ¯ã€‚ | **æ»‘åŠ¨çª—å£/ä¸Šä¸‹æ–‡æ‰©å±•ï¼š** åœ¨å¬å›æœ€ç›¸å…³çš„ç‰‡æ®µåï¼ŒåŒæ—¶å¸¦å‡ºå®ƒå‰åç›¸é‚»çš„æ®µè½ï¼Œè¡¥é½ä¸Šä¸‹æ–‡ã€‚ |  
| **6. ç”Ÿæˆ (Generation)** | å¬å›ä¿¡æ¯å¾ˆå®Œç¾ï¼Œä½†å¤§æ¨¡å‹ä»ç„¶ç­”ä¸å¥½ã€‚ | **æ›´æ¢æ›´å¼ºå¤§çš„å¤§æ¨¡å‹ï¼ˆLLMï¼‰ã€‚** |  
  
#### ğŸŒŸ ç‰¹åˆ«æåˆ°äº† BM25  
  
BM25 æ˜¯ä¸€ç§ç»å…¸çš„æ–‡æœ¬ç›¸å…³æ€§æ‰“åˆ†ç®—æ³•ï¼Œå®ƒè€ƒè™‘äº†è¯è¯­çš„ **â€œç¨€æœ‰åº¦â€** å’Œ **â€œå‡ºç°é¢‘ç‡â€** ã€‚åœ¨ RAG æµç¨‹ä¸­ï¼Œå®ƒéå¸¸é€‚åˆä½œä¸º**å¤šè·¯å¬å›**æˆ–**é‡æ’åºï¼ˆRerankï¼‰** çš„ä¸€ç§æ‰‹æ®µï¼Œå› ä¸ºå®ƒèƒ½æœ‰æ•ˆåœ°æŠŠåŒ…å«ç¨€æœ‰ã€æ ¸å¿ƒå…³é”®è¯çš„æ–‡æ¡£ç‰‡æ®µæ’åˆ°å‰é¢ï¼Œå¼¥è¡¥çº¯å‘é‡æœç´¢çš„ä¸è¶³ã€‚  
  
  
### 4. æ€»ç»“  
  
ä½œè€…é€šè¿‡è¿™ç¯‡è§£è¯»å‘Šè¯‰æˆ‘ä»¬ï¼š  
  
1.  **RAG ä¸æ˜¯ä¸‡èƒ½è¯ï¼š** åªæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œæ•ˆæœå¥½åå–å†³äºä½ åœ¨æ¯ä¸ªç¯èŠ‚ï¼ˆä»æ•°æ®å¤„ç†åˆ°å¬å›ã€å†åˆ°æ’åºå’Œç”Ÿæˆï¼‰çš„å·¥ç¨‹ä¼˜åŒ–æ°´å¹³ã€‚  
2.  **æ•°æ®é©±åŠ¨ä¼˜åŒ–ï¼š** å¿…é¡»ä½¿ç”¨ **Ragas** è¿™ç±»å·¥å…·è¿›è¡Œé‡åŒ–è¯„æµ‹ï¼Œæ‰¾åˆ°åˆ°åº•æ˜¯ **â€œæŸ¥ä¸å…¨â€** ï¼ˆå¬å›è¦†ç›–ç‡ä½ï¼‰ã€ **â€œæŸ¥ä¸å‡†â€** ï¼ˆå¬å›ç²¾åº¦ä½ï¼‰ã€è¿˜æ˜¯ **â€œæ¨¡å‹ç¬¨â€** çš„é—®é¢˜ï¼Œç„¶åå¯¹ç—‡ä¸‹è¯ã€‚  
3.  **æŠ€æœ¯æ ˆæ˜¯åŸºçŸ³ï¼š** æ–‡ç« æ ‡ç­¾ä¸­æåˆ°äº† PostgreSQL/PolarDB/DuckDBï¼Œè¯´æ˜é«˜æ•ˆçš„æ•°æ®åº“ï¼ˆç‰¹åˆ«æ˜¯æ”¯æŒå‘é‡ã€å…¨æ–‡æ£€ç´¢ã€æ¨¡ç³ŠæŸ¥è¯¢çš„æ•°æ®åº“ï¼‰æ˜¯å®ç°å¤æ‚å¤šè·¯å¬å›å’Œ Rerank çš„æŠ€æœ¯åŸºç¡€ã€‚  
  
  
-----  
  
## ğŸ’¡ å¾ªåºæ¸è¿›çš„ RAG æ·±åº¦ç†è§£é—®é¢˜  
  
### é˜¶æ®µä¸€ï¼šåŸºç¡€æ¦‚å¿µä¸èƒŒæ™¯ï¼ˆWhat & Whyï¼‰  
  
1.  **RAG çš„æ ¸å¿ƒç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ** æ–‡ç« æåˆ°ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¤§æ¨¡å‹ä¼šâ€œä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“â€ï¼ˆå¹»è§‰ï¼‰ï¼ŸRAG å¦‚ä½•ä»æ ¹æœ¬ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ  
2.  **RAG ä¸æ¨¡å‹å¾®è°ƒï¼ˆFine-tuningï¼‰ç›¸æ¯”ï¼Œæœ€å¤§çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ** æ–‡ç« ä¸ºä»€ä¹ˆè¯´ RAG æ˜¯ä¸€ç§æ›´é€‚åˆå¤„ç†ä¼ä¸š**ç§æœ‰çŸ¥è¯†**å’Œ**æœ€æ–°ä¿¡æ¯**çš„è§£å†³æ–¹æ¡ˆï¼Ÿ  
3.  **è¯·ç”¨è‡ªå·±çš„è¯æ¦‚æ‹¬ RAG çš„å®Œæ•´å·¥ä½œæµç¨‹**ï¼ˆä»ç”¨æˆ·æé—®åˆ°è·å¾—æœ€ç»ˆç­”æ¡ˆï¼‰ï¼Œè¿™ä¸ªæµç¨‹å¯ä»¥åˆ†æˆå“ªä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼Ÿ  
  
### é˜¶æ®µäºŒï¼šé‡åŒ–è¯„ä¼°ï¼ˆHow to Measureï¼‰  
  
1.  **ä¸ºä»€ä¹ˆéœ€è¦é‡åŒ–è¯„ä¼° RAG æ•ˆæœï¼Ÿ** æ–‡ç« æ¨èçš„ Ragas è¯„æµ‹ä½“ç³»å°† RAG æ•ˆæœæ‹†è§£ä¸ºå“ªä¸¤å¤§æ–¹å‘ï¼Ÿ  
2.  **è¯·è§£é‡Šâ€œå¬å›è¦†ç›–ç‡ (Context Recall)â€å’Œâ€œå¬å›ç²¾åº¦ (Context Precision)â€è¿™ä¸¤ä¸ªæŒ‡æ ‡çš„åŒºåˆ«ã€‚** å“ªä¸ªæŒ‡æ ‡å…³æ³¨çš„æ˜¯â€œ**æŸ¥å…¨**â€ï¼ˆä¸é—æ¼å…³é”®ä¿¡æ¯ï¼‰ï¼Œå“ªä¸ªæŒ‡æ ‡å…³æ³¨çš„æ˜¯â€œ**æŸ¥å‡†**â€ï¼ˆåªè¿”å›ç›¸å…³ä¿¡æ¯ä¸”æ’åé å‰ï¼‰ï¼Ÿ  
3.  **åœ¨ Ragas çš„ Answer Correctness (å›ç­”å‡†ç¡®ç‡) è®¡ç®—ä¸­ï¼Œä¸ºä»€ä¹ˆâ€œäº‹å®å‡†ç¡®åº¦å¾—åˆ†â€çš„æƒé‡ï¼ˆ0.75ï¼‰è¦é«˜äºâ€œè¯­ä¹‰ç›¸ä¼¼åº¦å¾—åˆ†â€ï¼ˆ0.25ï¼‰ï¼Ÿ** è¿™ä½“ç°äº† RAG åº”ç”¨å¯¹å“ªä¸€æ–¹é¢çš„æœ€é«˜è¦æ±‚ï¼Ÿ  
  
### é˜¶æ®µä¸‰ï¼šè¯Šæ–­ä¸ä¼˜åŒ–ï¼ˆHow to Fixï¼‰  
  
1.  **æ ¹æ®æ–‡ç« æä¾›çš„â€œç¬¨â€çš„åŸå› è¯Šæ–­è¡¨ï¼Œå¦‚æœä¸€ä¸ª RAG ç³»ç»Ÿçš„å›ç­”å‡†ç¡®ç‡ä½ã€å¬å›è¦†ç›–ç‡é«˜ã€å¬å›ç²¾åº¦ä½ï¼Œè¿™è¯´æ˜ä¸»è¦é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ** é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œä½œè€…ç»™å‡ºäº†ä»€ä¹ˆæ ¸å¿ƒçš„ä¼˜åŒ–å»ºè®®ï¼Ÿ  
2.  **åœ¨ RAG æµç¨‹ä¸­ï¼Œâ€œæ–‡æœ¬åˆ‡åˆ†ï¼ˆChunkingï¼‰â€æ˜¯ä¸€ä¸ªå…³é”®æ­¥éª¤ã€‚** å¦‚æœåˆ‡åˆ†å¤ªå°ï¼Œä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿå¦‚æœåˆ‡åˆ†å¤ªå¤§ï¼Œåˆä¼šå¼•å…¥ä»€ä¹ˆé—®é¢˜ï¼Ÿæ–‡ç« ä¸­æåˆ°çš„â€œçˆ¶å­æ¨¡å¼â€åˆ‡åˆ†æ³•çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ  
3.  **ä»€ä¹ˆæ˜¯â€œå¤šè·¯å¬å›â€ï¼Ÿ** é™¤äº†æœ€å¸¸ç”¨çš„**å‘é‡æ£€ç´¢**å¤–ï¼Œæ–‡ç« è¿˜å»ºè®®ç»“åˆå“ªäº›ä¼ ç»Ÿçš„æ£€ç´¢æ–¹æ³•æ¥æé«˜å¬å›æ•ˆæœï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å¤šç§æ–¹æ³•ï¼Ÿ  
4.  **è¯·è§£é‡Šâ€œRerankï¼ˆé‡æ’åºï¼‰â€çš„ä½œç”¨ã€‚** å®ƒä¸»è¦è§£å†³çš„æ˜¯ RAG æµç¨‹ä¸­å“ªä¸€ä¸ªé‡åŒ–æŒ‡æ ‡ä½çš„é—®é¢˜ï¼Ÿæ–‡ç« æåˆ°äº†å“ªç§ç»å…¸çš„æ£€ç´¢ç®—æ³•å¯ä»¥ç”¨äº Rerankï¼Ÿ  
5.  **åœ¨æ•´ä¸ª RAG ä¼˜åŒ–æµç¨‹ä¸­ï¼Œæ•°æ®åº“ï¼ˆå¦‚ PostgreSQL/PolarDBï¼‰ä¸»è¦æ‰®æ¼”äº†ä»€ä¹ˆè§’è‰²ï¼Ÿ** ä¸ºä»€ä¹ˆé«˜æ€§èƒ½çš„æ•°æ®åº“å¯¹äºå®ç°å¤šè·¯å¬å›éå¸¸é‡è¦ï¼Ÿ  
  
-----  
  
    
## é˜¶æ®µä¸€ï¼šåŸºç¡€æ¦‚å¿µä¸èƒŒæ™¯ï¼ˆWhat & Whyï¼‰  
  
### 1. RAG çš„æ ¸å¿ƒç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ  
  
* **RAG çš„æ ¸å¿ƒç›®æ ‡ï¼š** è®©å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼Œæ¯”å¦‚ AI åŠ©æ‰‹ï¼‰èƒ½å¤Ÿå›ç­”**å®ƒè®­ç»ƒæ—¶ä¸çŸ¥é“çš„æ–°é—®é¢˜**ï¼ŒåŒæ—¶å‡å°‘å®ƒ **â€œçç¼–â€** ï¼ˆå³å¹»è§‰ï¼‰çš„æƒ…å†µã€‚  
  
* **å¹»è§‰å‡ºç°çš„æƒ…å†µï¼š** å½“ä½ é—® AI ä¸€ä¸ªå®ƒä¸çŸ¥é“ã€ä½†åˆå¿…é¡»å›ç­”çš„é—®é¢˜æ—¶ï¼Œå®ƒä¼šåˆ©ç”¨è‡ªå·±å­¦åˆ°çš„è¯­è¨€æ¨¡å¼å’Œæ¦‚ç‡ï¼Œ**ä¸€æœ¬æ­£ç»åœ°æé€ ä¸€ä¸ªç­”æ¡ˆ**ã€‚  
    * **ä¾‹å­ï¼š** é—® AI â€œä½ è€æ¿æ˜¨å¤©åƒäº†ä»€ä¹ˆï¼Ÿâ€ å¦‚æœè¿™ä¸ªé—®é¢˜ä¸åœ¨å®ƒçš„è®­ç»ƒæ•°æ®é‡Œï¼Œå®ƒå¯èƒ½ä¼šæ ¹æ®â€œè€æ¿ã€åƒé¥­â€ç­‰å…³é”®è¯ï¼Œç¼–é€ ä¸€ä¸ªå¬èµ·æ¥åˆç†çš„å›ç­”ï¼šâ€œæ®æˆ‘æ‰€çŸ¥ï¼Œä»–å¯èƒ½åƒäº†å¥åº·åˆé¤ã€‚â€  
  
* **RAG å¦‚ä½•è§£å†³ï¼š** RAG å°±åƒç»™ AI å¢åŠ äº†ä¸€ä¸ªâ€œæœç´¢å¼•æ“â€å’Œ **â€œå‚è€ƒèµ„æ–™â€** ã€‚å½“ AI æ‹¿åˆ°é—®é¢˜åï¼Œå®ƒä¼šå…ˆå»ä½ æä¾›çš„èµ„æ–™åº“ï¼ˆæ¯”å¦‚å…¬å¸çš„æ–‡æ¡£ï¼‰é‡Œ**ç²¾ç¡®æŸ¥æ‰¾**ç­”æ¡ˆï¼Œç„¶å**å¼•ç”¨è¿™äº›æ‰¾åˆ°çš„èµ„æ–™**æ¥ç”Ÿæˆå›ç­”ã€‚æœ‰èµ„æ–™ä½œè¯ï¼Œå®ƒå°±æ²¡å¿…è¦â€œçç¼–â€äº†ã€‚  
      
  
### 2. RAG ä¸æ¨¡å‹å¾®è°ƒï¼ˆFine-tuningï¼‰ç›¸æ¯”ï¼Œæœ€å¤§çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ  
  
æŠŠå¤§æ¨¡å‹çœ‹ä½œä¸€ä¸ªâ€œå¨å¸ˆâ€ï¼ŒRAG å’Œå¾®è°ƒå°±æ˜¯ä¸¤ç§ä¸åŒçš„â€œå‡çº§â€æ–¹å¼ã€‚  
  
| æ–¹å¼ | ä½œç”¨ | RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ) | å¾®è°ƒ (Fine-tuning) |  
| :--- | :--- | :--- | :--- |  
| **å‡çº§ç‚¹** | **çŸ¥è¯†æ¥æº** | **æŸ¥èµ„æ–™**ï¼ˆæä¾›é£Ÿè°±ï¼‰ | **æå‡æ‰‹è‰º**ï¼ˆæ”¹å˜è®­ç»ƒï¼‰ |  
| **ä¼˜åŠ¿** | 1. **å¿«ä¸”ä¾¿å®œï¼š** åªéœ€è¦ä¸Šä¼ æ–°æ–‡æ¡£ï¼Œæ— éœ€é‡æ–°è®­ç»ƒæ¨¡å‹ã€‚ 2. **éšç§å®‰å…¨ï¼š** ä¼ä¸šç§æœ‰æ•°æ®æ— éœ€ä¸Šä¼ åˆ°å¤§æ¨¡å‹è®­ç»ƒæ–¹ã€‚ 3. **çŸ¥è¯†æ—¶æ•ˆæ€§ï¼š** å¯ä»¥å³æ—¶æ›´æ–°æœ€æ–°çŸ¥è¯†ã€‚ | 1. **æ·±åº¦å®šåˆ¶ï¼š** æ”¹å˜æ¨¡å‹å›ç­”çš„é£æ ¼ã€è¯­æ°”æˆ–éµå¾ªç‰¹å®šæ ¼å¼ã€‚ 2. **æé«˜æ•ˆç‡ï¼š** å¯¹äºç‰¹å®šä»»åŠ¡ï¼Œç”Ÿæˆé€Ÿåº¦å¯èƒ½æ›´å¿«ã€‚ |  
| **åŠ£åŠ¿** | **æ€§èƒ½ä¸Šé™ï¼š** æ¨¡å‹æœ¬èº«èƒ½åŠ›ä¸å˜ï¼Œå¦‚æœç»™çš„èµ„æ–™å¤ªå·®ï¼Œå›ç­”è¿˜æ˜¯ä¼šå—å½±å“ã€‚ | **æ˜‚è´µä¸”æ…¢ï¼š** éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œé«˜è´¨é‡æ•°æ®ï¼ŒçŸ¥è¯†æ›´æ–°å‘¨æœŸé•¿ã€‚ |  
  
**ç»“è®ºï¼š** RAG æ˜¯å¤„ç†**å¤§é‡ã€æ˜“å˜ã€ç§æœ‰çŸ¥è¯†**ï¼ˆå¦‚å…¬å¸æ‰‹å†Œã€æœ€æ–°æŠ¥å‘Šï¼‰çš„æœ€ä½³é€‰æ‹©ã€‚  
  
### 3. è¯·ç”¨è‡ªå·±çš„è¯æ¦‚æ‹¬ RAG çš„å®Œæ•´å·¥ä½œæµç¨‹  
  
ä½ å¯ä»¥æŠŠ RAG æƒ³è±¡æˆä¸€ä¸ªå­¦ç”Ÿ**å†™ä¸€ç¯‡å¼€æ”¾æ€§è®ºæ–‡**çš„è¿‡ç¨‹ï¼š  
  
1.  **å‡†å¤‡é˜¶æ®µï¼ˆæ•°æ®å¤„ç†ï¼‰ï¼š** å­¦ç”Ÿéœ€è¦å…ˆæŠŠå›¾ä¹¦é¦†é‡Œæ‰€æœ‰çš„ä¹¦ï¼ˆçŸ¥è¯†åº“ï¼‰ **æ‹†åˆ†** æˆä¸€å¼ å¼ **ç´¢å¼•å¡ç‰‡**ï¼ˆåˆ‡åˆ†æ–‡æ¡£ï¼‰ï¼Œå¹¶åœ¨æ¯å¼ å¡ç‰‡ä¸Šå†™ä¸‹**å…³é”®è¯**ï¼ˆå‘é‡åŒ–ï¼‰ï¼Œå­˜å…¥å¡ç‰‡æŸœï¼ˆå‘é‡æ•°æ®åº“ï¼‰ã€‚  
2.  **æ£€ç´¢é˜¶æ®µï¼ˆRetrievalï¼‰ï¼š** è€å¸ˆå¸ƒç½®äº†è®ºæ–‡é¢˜ç›®ï¼ˆç”¨æˆ·è¾“å…¥é—®é¢˜ï¼‰ã€‚å­¦ç”Ÿæ ¹æ®é¢˜ç›®ï¼Œåœ¨å¡ç‰‡æŸœé‡Œ**å¿«é€Ÿæœç´¢**å¹¶**æ‰¾å‡º**å‡ å¼ æœ€ç›¸å…³çš„å¡ç‰‡ï¼ˆå¬å›ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µï¼‰ã€‚  
3.  **ç”Ÿæˆé˜¶æ®µï¼ˆGenerationï¼‰ï¼š** å­¦ç”ŸæŠŠæ‰¾åˆ°çš„è¿™äº›å¡ç‰‡ï¼ˆå¬å›çš„ä¸Šä¸‹æ–‡ï¼‰æ”¾åœ¨æ¡Œä¸Šï¼Œ**å‚è€ƒ**ä¸Šé¢çš„ä¿¡æ¯ï¼Œç”¨è‡ªå·±çš„çŸ¥è¯†å’Œè¯­è¨€**ç»„ç»‡**æˆä¸€ç¯‡å®Œæ•´çš„è®ºæ–‡ï¼ˆç”Ÿæˆæœ€ç»ˆç­”æ¡ˆï¼‰ã€‚  
  
  
  
## é˜¶æ®µäºŒï¼šé‡åŒ–è¯„ä¼°ï¼ˆHow to Measureï¼‰  
  
### 1. ä¸ºä»€ä¹ˆéœ€è¦é‡åŒ–è¯„ä¼° RAG æ•ˆæœï¼Ÿ  
  
* **ç›®çš„ï¼š** ä¸ºäº†ç§‘å­¦åœ°æ‰¾å‡º RAG **å˜â€œç¬¨â€** çš„çœŸæ­£åŸå› ï¼Œè€Œä¸æ˜¯å‡­æ„Ÿè§‰çŒœæµ‹ã€‚  
* **ä¸¤å¤§æ–¹å‘ï¼š** Ragas ä½“ç³»å°†è¯„ä¼°æ‹†è§£ä¸ºï¼š  
    1.  **æ£€ç´¢ï¼ˆæŸ¥èµ„æ–™ï¼‰æ•ˆæœï¼š** å³**å¬å›**ï¼ˆæœ‰æ²¡æœ‰æ‰¾åˆ°ï¼‰  
    2.  **ç”Ÿæˆï¼ˆå†™ç­”æ¡ˆï¼‰æ•ˆæœï¼š** å³**å›ç­”**ï¼ˆæœ‰æ²¡æœ‰ç­”å¯¹ï¼‰  
    * åªæœ‰è¿™ä¸¤æ–¹é¢éƒ½ä¼˜ç§€ï¼ŒRAG æ‰æ˜¯çœŸæ­£â€œèªæ˜â€çš„ã€‚  
  
### 2. è¯·è§£é‡Šâ€œå¬å›è¦†ç›–ç‡ (Context Recall)â€å’Œâ€œå¬å›ç²¾åº¦ (Context Precision)â€çš„åŒºåˆ«ã€‚  
  
* **å¬å›è¦†ç›–ç‡ (Recall) = æŸ¥å…¨äº†å—ï¼Ÿ**  
    * å®ƒå…³æ³¨çš„æ˜¯ï¼šæ­£ç¡®ç­”æ¡ˆä¸­çš„æ‰€æœ‰å…³é”®ä¿¡æ¯ç‚¹ï¼Œä½ æ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µ**æ˜¯å¦éƒ½åŒ…æ‹¬äº†**ï¼Ÿ  
    * **ä¾‹å­ï¼š** æ­£ç¡®ç­”æ¡ˆéœ€è¦æåˆ°â€œå¼ ä¼Ÿæ˜¯æ•™ç ”éƒ¨çš„**å¹¶ä¸”**è´Ÿè´£å¤§æ•°æ®â€ã€‚å¦‚æœä½ åªæ£€ç´¢åˆ°äº†â€œå¼ ä¼Ÿæ˜¯æ•™ç ”éƒ¨çš„â€è¿™ä¸ªä¿¡æ¯ï¼Œé‚£ä¹ˆå¬å›è¦†ç›–ç‡å°±ä¸å¤Ÿé«˜ã€‚  
  
* **å¬å›ç²¾åº¦ (Precision) = æŸ¥å‡†äº†å—ï¼Ÿ**  
    * å®ƒå…³æ³¨çš„æ˜¯ï¼šä½ æ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µä¸­ï¼Œ**æœ‰å¤šå°‘æ˜¯çœŸæ­£ç›¸å…³çš„**ï¼Ÿå¹¶ä¸”æœ€ç›¸å…³çš„ç‰‡æ®µæ˜¯å¦è¢«æ’åœ¨äº†**æœ€å‰é¢**ï¼Ÿ  
    * **ä¾‹å­ï¼š** ä¸ºäº†å›ç­”â€œå¼ ä¼Ÿçš„éƒ¨é—¨â€ï¼Œä½ æ£€ç´¢åˆ°äº†ä¸¤æ¡ä¿¡æ¯ï¼šâ€œå¼ ä¼Ÿæ˜¯æ•™ç ”éƒ¨çš„â€å’Œâ€œç‰›é¡¿å‘ç°äº†ä¸‡æœ‰å¼•åŠ›â€ã€‚ç¬¬äºŒæ¡å°±æ˜¯**æ— å…³ä¿¡æ¯ï¼ˆå™ªéŸ³ï¼‰** ï¼Œä¼šé™ä½ä½ çš„å¬å›ç²¾åº¦ã€‚  
  
### 3. åœ¨ Ragas çš„ Answer Correctness (å›ç­”å‡†ç¡®ç‡) è®¡ç®—ä¸­ï¼Œä¸ºä»€ä¹ˆâ€œäº‹å®å‡†ç¡®åº¦å¾—åˆ†â€çš„æƒé‡ï¼ˆ0.75ï¼‰è¦é«˜äºâ€œè¯­ä¹‰ç›¸ä¼¼åº¦å¾—åˆ†â€ï¼ˆ0.25ï¼‰ï¼Ÿ  
  
* **RAG çš„æœ€é«˜è¦æ±‚ï¼š** **äº‹å®æ­£ç¡®æ€§ã€‚**  
    * RAG å­˜åœ¨çš„æ ¹æœ¬åŸå› å°±æ˜¯ä¸ºäº†è§£å†³å¤§æ¨¡å‹çš„â€œå¹»è§‰â€å’ŒçŸ¥è¯†é”™è¯¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ€å…³å¿ƒçš„ä¸æ˜¯ AI å›ç­”å¾—æ˜¯ä¸æ˜¯â€œæ–‡è‰ºâ€æˆ–â€œåƒäººè¯â€ï¼ˆè¯­ä¹‰ç›¸ä¼¼åº¦ï¼‰ï¼Œè€Œæ˜¯å®ƒæä¾›çš„**äº‹å®æ˜¯ä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾å‡†ç¡®**ã€‚  
    * **æƒé‡åˆ†é… (0.75 vs 0.25)ï¼š** è¿™ç§åˆ†é…æ¸…æ™°åœ°è¡¨è¾¾äº†è¯„ä¼°è€…çš„å€¾å‘â€”â€”**å³ä½¿ä½ å›ç­”å¾—æ–‡ç¬”ä¸å¥½ï¼Œåªè¦äº‹å®æ˜¯å¯¹çš„ï¼Œåˆ†æ•°å°±é«˜ï¼›å¦‚æœä½ äº‹å®é”™äº†ï¼Œå³ä½¿è¯­ä¹‰ä¸Šå†åƒæ­£ç¡®ç­”æ¡ˆï¼Œåˆ†æ•°ä¹Ÿä¼šè¢«ä¸¥é‡æ‹‰ä½ã€‚**  
  
  
## é˜¶æ®µä¸‰ï¼šè¯Šæ–­ä¸ä¼˜åŒ–ï¼ˆHow to Fixï¼‰  
  
### 1. å¦‚æœä¸€ä¸ª RAG ç³»ç»Ÿçš„å›ç­”å‡†ç¡®ç‡ä½ã€å¬å›è¦†ç›–ç‡é«˜ã€å¬å›ç²¾åº¦ä½ï¼Œè¿™è¯´æ˜ä¸»è¦é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ  
  
* **è¯Šæ–­ç»“æœï¼š** é—®é¢˜å‡ºåœ¨â€œ**å¬å›å¹²æ‰°å¤ªå¤š**â€ã€‚  
* **é€šä¿—ç†è§£ï¼š** â€œå¬å›è¦†ç›–ç‡é«˜â€è¯´æ˜ä½ **æŸ¥å…¨äº†**ï¼ˆæ‰€æœ‰æ­£ç¡®ä¿¡æ¯éƒ½æ‰¾åˆ°äº†ï¼‰ã€‚ä½†æ˜¯â€œå¬å›ç²¾åº¦ä½â€è¯´æ˜ä½ åŒæ—¶æ‰¾åˆ°äº†**å¤ªå¤šæ— å…³çš„å™ªéŸ³ä¿¡æ¯**ï¼Œè€Œä¸”è¿™äº›å™ªéŸ³å¯èƒ½æ’åœ¨äº†å‰é¢ã€‚  
* **ä¼˜åŒ–å»ºè®®ï¼š** é’ˆå¯¹è¿™ç§â€œæŸ¥å…¨äº†ä½†å¤ªæ‚â€çš„æƒ…å†µï¼Œæ ¸å¿ƒè§£å†³åŠæ³•å°±æ˜¯å¼•å…¥ **Rerankï¼ˆé‡æ’åºï¼‰** ã€‚è®©ä¸€ä¸ªä¸“é—¨çš„â€œè¯„å§”â€æ¨¡å‹å¯¹æ‰€æœ‰æŸ¥åˆ°çš„èµ„æ–™è¿›è¡ŒäºŒæ¬¡ç­›é€‰å’Œæ’åºï¼Œ**æŠŠå™ªéŸ³è¸¢å‡ºå»ï¼ŒæŠŠçœŸæ­£å…³é”®çš„ä¿¡æ¯æ’åˆ°æœ€å‰é¢**ï¼Œå‡è½»å¤§æ¨¡å‹çš„è´Ÿæ‹…ã€‚  
  
### 2. åœ¨ RAG æµç¨‹ä¸­ï¼Œâ€œæ–‡æœ¬åˆ‡åˆ†ï¼ˆChunkingï¼‰â€æ˜¯ä¸€ä¸ªå…³é”®æ­¥éª¤ã€‚  
  
* **åˆ‡åˆ†å¤ªå°çš„é—®é¢˜ï¼š** å¯¼è‡´**ä¿¡æ¯æ•£ä¹±ï¼Œä¸¢å¤±ä¸Šä¸‹æ–‡**ã€‚å°±åƒæŠŠä¸€ç¯‡æ–‡ç« åˆ‡æˆå•ä¸ªå•è¯ï¼Œå½“æ£€ç´¢åˆ°â€œè‹¹æœâ€è¿™ä¸ªè¯æ—¶ï¼Œæ¨¡å‹ä¸çŸ¥é“è¯´çš„æ˜¯â€œæ°´æœè‹¹æœâ€è¿˜æ˜¯â€œè‹¹æœå…¬å¸â€ã€‚å¬å›è¦†ç›–ç‡ä¼šä½ã€‚  
* **åˆ‡åˆ†å¤ªå¤§çš„é—®é¢˜ï¼š** **å¼•å…¥è¿‡å¤šå™ªéŸ³**ï¼Œå®¹æ˜“è¶…å‡ºå¤§æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ã€‚å°±åƒæŠŠä¸€æœ¬ä¹¦ä½œä¸ºå•ä¸ªç‰‡æ®µï¼Œå½“æ£€ç´¢æ—¶ï¼Œæ•´ä¸ªä¹¦çš„å†…å®¹éƒ½ä¼šè¢«ä¼ ç»™ AIï¼Œå¤§é‡çš„æ— å…³å†…å®¹ä¼šå¹²æ‰° AI çš„åˆ¤æ–­ã€‚å¬å›ç²¾åº¦ä¼šä½ã€‚  
* **â€œçˆ¶å­æ¨¡å¼â€åˆ‡åˆ†æ³•ï¼š** è¿™æ˜¯ä¸€ç§èªæ˜çš„æ–¹æ³•ã€‚  
    * **â€œå­æ–‡æ¡£â€ï¼ˆå°ç‰‡æ®µï¼‰ï¼š** ç”¨äº**ç²¾ç¡®æ£€ç´¢**ã€‚  
    * **â€œçˆ¶æ–‡æ¡£â€ï¼ˆå¤§ç‰‡æ®µï¼ŒåŒ…å«å­æ–‡æ¡£çš„ä¸Šä¸‹æ–‡ï¼‰ï¼š** ç”¨äº**ç”Ÿæˆç­”æ¡ˆ**ã€‚  
    * è¿™æ ·ï¼Œæ£€ç´¢æ—¶èƒ½å¿«é€Ÿå®šä½åˆ°æ ¸å¿ƒä¿¡æ¯ï¼ˆå­ï¼‰ï¼Œç”Ÿæˆæ—¶åˆèƒ½æä¾›å®Œæ•´çš„ä¸Šä¸‹æ–‡ï¼ˆçˆ¶ï¼‰ï¼Œå…¼é¡¾äº†æŸ¥å‡†å’Œä¸Šä¸‹æ–‡å®Œæ•´æ€§ã€‚  
  
### 3. ä»€ä¹ˆæ˜¯â€œå¤šè·¯å¬å›â€ï¼Ÿ  
  
* **å®šä¹‰ï¼š** ä¸ä¾èµ–å•ä¸€çš„æ£€ç´¢æ–¹å¼ï¼ˆæ¯”å¦‚åªé å‘é‡ç›¸ä¼¼åº¦ï¼‰ï¼Œè€Œæ˜¯**åŒæ—¶ä½¿ç”¨å¤šç§ä¸åŒçš„æ£€ç´¢æ–¹æ³•**æ¥æ‰¾åˆ°ç›¸å…³ä¿¡æ¯ã€‚  
* **éœ€è¦ç»“åˆçš„æ–¹æ³•ï¼š**  
    1.  **è¯­ä¹‰å‘é‡æ£€ç´¢ï¼š** é€šè¿‡ Embedding æ¨¡å‹åˆ¤æ–­â€œæ„æ€â€ç›¸ä¼¼çš„ç‰‡æ®µã€‚  
    2.  **æ¨¡ç³ŠæŸ¥è¯¢/å…¨æ–‡æ£€ç´¢ï¼š** ä¾é ä¼ ç»Ÿçš„**å…³é”®è¯åŒ¹é…**ï¼Œæ‰¾åŒ…å«ç‰¹å®šè¯æ±‡çš„ç‰‡æ®µã€‚  
    3.  **æ ‡ç­¾å¬å›ï¼š** åŸºäºé¢„å…ˆç”¨å¤§æ¨¡å‹æ‰“å¥½çš„â€œæ ‡ç­¾â€ï¼ˆå¦‚ äººç‰©ï¼šå¼ ä¼Ÿï¼Œåœ°ç‚¹ï¼šæ­å·ï¼‰ï¼Œè¿›è¡Œç²¾ç¡®è¿‡æ»¤ã€‚  
* **ç›®çš„ï¼š** **é¿å…â€œåç§‘â€** ã€‚å‘é‡æ£€ç´¢æ“…é•¿æ‰¾â€œæ„æ€ç›¸è¿‘â€çš„ï¼Œä½†å¯èƒ½é”™è¿‡å…³é”®è¯ï¼›å…³é”®è¯æ£€ç´¢æ“…é•¿æ‰¾â€œå­—é¢åŒ¹é…â€çš„ï¼Œä½†å¯èƒ½é”™è¿‡æ„æ€ç›¸è¿‘ä½†ç”¨è¯ä¸åŒçš„ã€‚å¤šè·¯å¬å›èƒ½å¤Ÿ**äº’è¡¥**ï¼Œå¤§å¤§æé«˜å¬å›è¦†ç›–ç‡ã€‚  
  
### 4. è¯·è§£é‡Šâ€œRerankï¼ˆé‡æ’åºï¼‰â€çš„ä½œç”¨ã€‚  
  
* **ä½œç”¨ï¼š** Rerank å°±åƒä¸€ä¸ªè£åˆ¤ï¼Œå®ƒæ¥æ”¶å¤šè·¯å¬å›ç³»ç»Ÿæ‰¾åˆ°çš„æ‰€æœ‰æ½œåœ¨ç›¸å…³æ–‡æ¡£ç‰‡æ®µï¼Œç„¶åæ ¹æ®é—®é¢˜ï¼Œç»™è¿™äº›ç‰‡æ®µ**é‡æ–°æ‰“åˆ†å¹¶æ’åº**ï¼Œé€‰å‡ºæœ€ç›¸å…³çš„ä¸€å°éƒ¨åˆ†ï¼ˆTop Kï¼‰ã€‚  
* **è§£å†³æŒ‡æ ‡ï¼š** ä¸»è¦è§£å†³**å¬å›ç²¾åº¦ä½**çš„é—®é¢˜ã€‚  
* **ä½¿ç”¨çš„ç»å…¸ç®—æ³•ï¼š** æ–‡ç« æåˆ°äº† **BM25**ã€‚å®ƒæ˜¯ä¸€ç§ä¼ ç»Ÿçš„ã€åŸºäºè¯é¢‘å’Œç¨€æœ‰åº¦çš„ç®—æ³•ï¼Œéå¸¸é€‚åˆç”¨æ¥å¯¹å…³é”®è¯åŒ¹é…çš„ç»“æœè¿›è¡Œç²¾ç¡®æ’åºã€‚  
  
### 5. åœ¨æ•´ä¸ª RAG ä¼˜åŒ–æµç¨‹ä¸­ï¼Œæ•°æ®åº“ï¼ˆå¦‚ PostgreSQL/PolarDBï¼‰ä¸»è¦æ‰®æ¼”äº†ä»€ä¹ˆè§’è‰²ï¼Ÿ  
  
æ•°æ®åº“åœ¨ RAG ä¼˜åŒ–ä¸­æ˜¯**åœ°åŸº**ã€‚  
  
* **ä¸»è¦è§’è‰²ï¼š** **çŸ¥è¯†åº“çš„å­˜å‚¨ä¸æ£€ç´¢ä¸­å¿ƒã€‚**  
* **å…·ä½“ä½œç”¨ï¼š**  
    1.  **å­˜å‚¨ï¼š** å­˜å‚¨çŸ¥è¯†åº“çš„**åŸå§‹æ–‡æœ¬**ã€**å‘é‡å€¼**ï¼ˆç”¨äºå‘é‡æ£€ç´¢ï¼‰ã€**æ ‡ç­¾å€¼**ï¼ˆç”¨äºæ ‡ç­¾å¬å›ï¼‰ã€‚  
    2.  **åŠ é€Ÿï¼š** é€šè¿‡æ•°æ®åº“çš„**ç´¢å¼•æŠ€æœ¯**ï¼ˆå¦‚å‘é‡ç´¢å¼•ã€å€’æ’ç´¢å¼•ï¼‰ï¼Œå¤§å¹…åŠ é€Ÿå¤šè·¯å¬å›çš„æ£€ç´¢é€Ÿåº¦ã€‚å¦‚æœæ²¡æœ‰é«˜æ•ˆçš„æ•°æ®åº“æ”¯æŒï¼Œå¤šè·¯å¬å›å¯èƒ½å› ä¸ºæŸ¥è¯¢å¤ªæ…¢è€Œæ— æ³•åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨ã€‚  
  
ç®€è€Œè¨€ä¹‹ï¼Œ**RAG çš„å¤æ‚ä¼˜åŒ–ç­–ç•¥éƒ½æ˜¯å»ºç«‹åœ¨å¼ºå¤§çš„æ•°æ®åº“æ£€ç´¢èƒ½åŠ›ä¹‹ä¸Šçš„ã€‚**  

---  
  
**è¦ä¹‰å›¾ç¤º**  
  
### 1. RAG æ ¸å¿ƒå·¥ä½œåŸç†å›¾

è¿™å¼ å›¾å±•ç¤ºäº† RAG å¦‚ä½•å°†â€œå¤–éƒ¨çŸ¥è¯†åº“â€ä¸â€œå¤§æ¨¡å‹â€ç»“åˆï¼Œè§£å†³å¤§æ¨¡å‹çŸ¥è¯†ç›²åŒºçš„é—®é¢˜ã€‚

```mermaid
graph TD
    User((ç”¨æˆ·æé—®)) --> Search[1\. æ£€ç´¢é˜¶æ®µ Retrieval]
    subgraph Knowledge_Base [ä¼ä¸šç§æœ‰/æœ€æ–°çŸ¥è¯†åº“]
        DB[(å‘é‡æ•°æ®åº“)]
    end
    Search -->|æŸ¥æ‰¾ç›¸å…³ç‰‡æ®µ| DB
    DB -->|è¿”å›å‚è€ƒèµ„æ–™| Context[2\. å¢å¼ºé˜¶æ®µ Augmentation]
    Context -->|é—®é¢˜ + å‚è€ƒèµ„æ–™| LLM[3\. ç”Ÿæˆé˜¶æ®µ Generation]
    LLM -->|äº§ç”Ÿæœ‰æ®å¯æŸ¥çš„å›ç­”| Answer((æœ€ç»ˆç­”æ¡ˆ))

    style Knowledge_Base fill:#f9f,stroke:#333,stroke-width:2px
    style LLM fill:#bbf,stroke:#333,stroke-width:2px
```



### 2. Ragas è¯„ä¼°æŒ‡æ ‡ä½“ç³»

è¿™å¼ å›¾æ‹†è§£äº†æ–‡ç« ä¸­æåˆ°çš„ä¸‰å¤§å…³é”®é‡åŒ–æŒ‡æ ‡ï¼Œå¸®åŠ©ä½ ç†è§£å¦‚ä½•è¯„ä»·ä¸€ä¸ª RAG ç³»ç»Ÿçš„å¥½åã€‚

```mermaid
mindmap
  root((RAG æ•ˆæœè¯„ä¼°))
    æ£€ç´¢è´¨é‡_æŸ¥èµ„æ–™
      å¬å›è¦†ç›–ç‡_Recall
        ::icon(fa fa-check-square)
        æŸ¥å…¨äº†å—
        å…³é”®ä¿¡æ¯ç‚¹æ˜¯å¦æ¼æ‰
      å¬å›ç²¾åº¦_Precision
        ::icon(fa fa-target)
        æŸ¥å‡†äº†å—
        æ— å…³å¹²æ‰°ä¿¡æ¯æ˜¯å¦å¤ªå¤š
    ç”Ÿæˆè´¨é‡_å†™ç­”æ¡ˆ
      å›ç­”å‡†ç¡®ç‡_Correctness
        äº‹å®å‡†ç¡®åº¦_75%
        è¯­ä¹‰ç›¸ä¼¼åº¦_25%
```



### 3. RAG â€œç¬¨â€çš„åŸå› è¯Šæ–­é€»è¾‘

å½“ AI è¡¨ç°ä¸ä½³æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿™å¥—é€»è¾‘å¿«é€Ÿå®šä½é—®é¢˜æ‰€åœ¨ï¼ˆå¯¹åº”æ–‡ä¸­çš„è¯Šæ–­è¡¨ï¼‰ã€‚

```mermaid
graph TD
    Start[AI å›ç­”é”™è¯¯/ä¸å¥½] --> Q1{èµ„æ–™æŸ¥åˆ°äº†å—?}
    Q1 -- æ²¡æŸ¥å…¨ --> Issue1[å¬å›è¦†ç›–ç‡ä½: ä¼˜åŒ–åˆ‡åˆ†æˆ–å¤šè·¯å¬å›]
    Q1 -- æŸ¥åˆ°äº† --> Q2{èµ„æ–™é‡Œæ‚è´¨å¤šå—?}
    Q2 -- æ‚è´¨å¤š/ä¹± --> Issue2[å¬å›ç²¾åº¦ä½: å¢åŠ  Rerank é‡æ’åº]
    Q2 -- èµ„æ–™å¾ˆç²¾å‡† --> Issue3[æ¨¡å‹èƒ½åŠ›å¼±: æ›´æ¢æ›´å¼ºå¤§ LLM]

    style Issue1 fill:#ffcccb
    style Issue2 fill:#ffcccb
    style Issue3 fill:#ffcccb
```



### 4. RAG ç³»ç»Ÿå…¨é“¾è·¯ä¼˜åŒ–æµç¨‹

è¿™æ˜¯ä¸€å¥—ä»æ–‡æ¡£å¤„ç†åˆ°æœ€ç»ˆç”Ÿæˆçš„å·¥ç¨‹åŒ–ä¼˜åŒ–è·¯å¾„ã€‚

```mermaid
flowchart LR
    Doc[æ–‡æ¡£å¤„ç†] --> Chunk[è¯­ä¹‰åˆ‡åˆ†/çˆ¶å­æ¨¡å¼]
    Chunk --> Embed[Embedding å‘é‡åŒ–]
    Embed --> Retrieval{å¤šè·¯å¬å›}
    
    subgraph Retrieval_Methods [å¬å›æŠ€æœ¯]
        direction TB
        V[å‘é‡æœç´¢]
        K[å…³é”®è¯ BM25]
        T[æ ‡ç­¾è¿‡æ»¤]
    end
    
    Retrieval --> Rerank[Rerank é‡æ’åº]
    Rerank --> Context[ä¸Šä¸‹æ–‡å¢å¼º/æ»‘åŠ¨çª—å£]
    Context --> Generation[LLM ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ]

    style Retrieval_Methods fill:#e1f5fe,stroke:#01579b
```
  
  
    
#### [PolarDB å­¦ä¹ å›¾è°±](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [PostgreSQL è§£å†³æ–¹æ¡ˆé›†åˆ](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [å¾·å“¥ / digoal's Github - å…¬ç›Šæ˜¯ä¸€è¾ˆå­çš„äº‹.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About å¾·å“¥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
