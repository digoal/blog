<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">HOW TO GET SHORTEST CONNECTION BETWEEN TWO CITIES</h2>
	<h5 id="">2012-06-27 16:14:56&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201252741456368/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>depesz 老兄的好文, 有这种场景应用的朋友可以参考他写的这个解决方案.</div><div>( 当长A市到B市有多条路径存在时,&nbsp;<span style="line-height: 22px;"  >找到两个市区之间的最短路径, 导航软件好像很在行, 但是用数据库来计算这个还是挺有趣的.&nbsp;</span>)</div><div><br></div>【原文】<div><a target="_blank" rel="nofollow" href="http://www.depesz.com/2012/06/25/how-to-get-shortest-connection-between-two-cities/"  >http://www.depesz.com/2012/06/25/how-to-get-shortest-connection-between-two-cities/</a></div><div><br></div><div>【2012-06-27静态页面摘录】</div><div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Yesterday, on&nbsp;<a style="text-decoration: none; color: rgb(0, 140, 220); border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-image: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; " rel="nofollow" href="irc://irc.freenode.net/#postgresql"  >#postgresql on irc</a>&nbsp;some guy asked:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >22:28 &lt; rafasc&gt; i am trying to use plpgsql to find the shortest path between two cities, each pair of cities has one or more edges, each edge has a different wheight. 22:28 &lt; rafasc&gt; Is there a easy way to compute the shortest path between two cities?</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Well, I was not really in a mood to solve it, so I just told him to try with recursive queries, and went on my way.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >But I thought about it. And decided to see if I can write the query.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><span id="more-2482"  ></span></p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >To get some test data, I created two simple tables:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ \d cities    <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Table</span> <span style="color: rgb(255, 0, 0);"  >"public.cities"</span>  <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Column</span> │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Type</span> │ Modifiers ────────┼──────┼───────────  city   │ text │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >not</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >null</span> Indexes:     <span style="color: rgb(255, 0, 0);"  >"cities_pkey"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >PRIMARY</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >KEY</span><span style="color: rgb(102, 204, 102);"  >,</span> btree <span style="color: rgb(102, 204, 102);"  >(</span>city<span style="color: rgb(102, 204, 102);"  >)</span> Referenced <span style="color: rgb(153, 51, 51); font-weight: bold;"  >by</span>:     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >TABLE</span> <span style="color: rgb(255, 0, 0);"  >"routes"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >CONSTRAINT</span> <span style="color: rgb(255, 0, 0);"  >"routes_from_city_fkey"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FOREIGN</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >KEY</span> <span style="color: rgb(102, 204, 102);"  >(</span>from_city<span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >REFERENCES</span> cities<span style="color: rgb(102, 204, 102);"  >(</span>city<span style="color: rgb(102, 204, 102);"  >)</span>     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >TABLE</span> <span style="color: rgb(255, 0, 0);"  >"routes"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >CONSTRAINT</span> <span style="color: rgb(255, 0, 0);"  >"routes_to_city_fkey"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FOREIGN</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >KEY</span> <span style="color: rgb(102, 204, 102);"  >(</span>to_city<span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >REFERENCES</span> cities<span style="color: rgb(102, 204, 102);"  >(</span>city<span style="color: rgb(102, 204, 102);"  >)</span> &nbsp; $ \d routes       <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Table</span> <span style="color: rgb(255, 0, 0);"  >"public.routes"</span>   <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Column</span>   │  <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Type</span>   │ Modifiers ───────────┼─────────┼───────────  from_city │ text    │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >not</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >null</span>  to_city   │ text    │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >not</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >null</span>  <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span>    │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >integer</span> │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >not</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >null</span> Indexes:     <span style="color: rgb(255, 0, 0);"  >"routes_pkey"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >PRIMARY</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >KEY</span><span style="color: rgb(102, 204, 102);"  >,</span> btree <span style="color: rgb(102, 204, 102);"  >(</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Check</span> constraints:     <span style="color: rgb(255, 0, 0);"  >"routes_check"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >CHECK</span> <span style="color: rgb(102, 204, 102);"  >(</span>from_city <span style="color: rgb(102, 204, 102);"  >&lt;</span> to_city<span style="color: rgb(102, 204, 102);"  >)</span> Foreign<span style="color: rgb(102, 204, 102);"  >-</span><span style="color: rgb(153, 51, 51); font-weight: bold;"  >key</span> constraints:     <span style="color: rgb(255, 0, 0);"  >"routes_from_city_fkey"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FOREIGN</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >KEY</span> <span style="color: rgb(102, 204, 102);"  >(</span>from_city<span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >REFERENCES</span> cities<span style="color: rgb(102, 204, 102);"  >(</span>city<span style="color: rgb(102, 204, 102);"  >)</span>     <span style="color: rgb(255, 0, 0);"  >"routes_to_city_fkey"</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FOREIGN</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >KEY</span> <span style="color: rgb(102, 204, 102);"  >(</span>to_city<span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >REFERENCES</span> cities<span style="color: rgb(102, 204, 102);"  >(</span>city<span style="color: rgb(102, 204, 102);"  >)</span></pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Data in them is very simple:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >select</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >from</span> cities <span style="color: rgb(153, 51, 51); font-weight: bold;"  >limit</span> <span style="color: rgb(204, 102, 204);"  >5</span>;       city ────────────────  Vancouver  Calgary  Winnipeg  Sault St Marie  Montreal <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >5</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >rows</span><span style="color: rgb(102, 204, 102);"  >)</span> &nbsp; $ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >select</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >from</span> routes <span style="color: rgb(153, 51, 51); font-weight: bold;"  >limit</span> <span style="color: rgb(204, 102, 204);"  >5</span>;  from_city │  to_city  │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> ───────────┼───────────┼────────  Calgary   │ Vancouver │      <span style="color: rgb(204, 102, 204);"  >3</span>  Seattle   │ Vancouver │      <span style="color: rgb(204, 102, 204);"  >1</span>  Portland  │ Seattle   │      <span style="color: rgb(204, 102, 204);"  >1</span>  Calgary   │ Seattle   │      <span style="color: rgb(204, 102, 204);"  >4</span>  Calgary   │ Helena    │      <span style="color: rgb(204, 102, 204);"  >4</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >5</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >rows</span><span style="color: rgb(102, 204, 102);"  >)</span></pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >In case you wonder C the data represents base map for “Ticket to Ride” game C awesome thing, and if you haven’t played it C get it, and play.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><a style="text-decoration: none; color: rgb(0, 140, 220); border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-image: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; " rel="nofollow" href="http://www.depesz.com/wp-content/uploads/2012/06/Ticket_to_ride.png"  ><img title="HOW TO GET SHORTEST CONNECTION BETWEEN TWO CITIES - 德哥@Digoal - The Heart,The World."  src="http://www.depesz.com/wp-content/uploads/2012/06/Ticket_to_ride-small.png"  width="400"  height="300"  alt="Ticket to Ride - US Map"  style="border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial;"  ></a></p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >This map was part of&nbsp;<a style="text-decoration: none; color: rgb(0, 140, 220); border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-image: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; " rel="nofollow" href="http://arstechnica.com/gaming/2011/05/review-ticket-to-ride-on-ipad-a-high-quality-port-of-board-game/"  >review</a>&nbsp;of the game on&nbsp;<a style="text-decoration: none; color: rgb(0, 140, 220); border-top-style: none; border-right-style: none; border-bottom-style: none; border-left-style: none; border-width: initial; border-color: initial; border-image: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; border-width: initial; border-color: initial; " rel="nofollow" href="http://arstechnica.com/"  >ars technica</a>.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >But anyway. So, I have 36 cities, and 78 unique paths between them, each with length information. So, with this I should be able to find the shortest path.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >One word of warning though C the fact that it’s possible to do in database, doesn’t mean it’s good idea. Personally, I think that it should be done in some standalone application, which would use some smarter algorithms, extensive cache, and so on. But C this is just a proof of concept, and the data size that I’m working on is small enough that it shouldn’t matter.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Each route is stored only once in routes. So I’ll start by duplicating the rows, so I will have them written “in both directions”:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  ><span style="color: rgb(153, 51, 51); font-weight: bold;"  >CREATE</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >VIEW</span> all_routes <span style="color: rgb(153, 51, 51); font-weight: bold;"  >AS</span>     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> routes     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >UNION</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >ALL</span>     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> to_city<span style="color: rgb(102, 204, 102);"  >,</span> from_city<span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> routes</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >This will save me some typing later on.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >First, let’s start with some small route, but one that will show that it actually works C Duluth-Toronto is great example.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Reason is very simple, We have these 3 routes:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >   from_city    │    to_city     │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> ────────────────┼────────────────┼────────  Duluth         │ Sault St Marie │      <span style="color: rgb(204, 102, 204);"  >3</span>  Sault St Marie │ Toronto        │      <span style="color: rgb(204, 102, 204);"  >2</span>  Duluth         │ Toronto        │      <span style="color: rgb(204, 102, 204);"  >6</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >3</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >rows</span><span style="color: rgb(102, 204, 102);"  >)</span></pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >There is a direct connection (length 6), but it’s actually cheaper to go via Sault St Marie, with total length of 5!</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><em>Here is a pause, of ~ 1 hour when I tried to write a query to solve my problem. And I failed. Kind of.</em></p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Query that would return the data is relatively simple:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  ><span style="color: rgb(153, 51, 51); font-weight: bold;"  >WITH</span> RECURSIVE     multiroutes <span style="color: rgb(153, 51, 51); font-weight: bold;"  >AS</span> <span style="color: rgb(102, 204, 102);"  >(</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span>             from_city<span style="color: rgb(102, 204, 102);"  >,</span>             to_city<span style="color: rgb(102, 204, 102);"  >,</span>             ARRAY<span style="color: rgb(102, 204, 102);"  >[</span> from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city <span style="color: rgb(102, 204, 102);"  >]</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> full_route<span style="color: rgb(102, 204, 102);"  >,</span>             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> total_length         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span>             all_routes         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span>             from_city <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(255, 0, 0);"  >'Duluth'</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >UNION</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >ALL</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span>             m<span style="color: rgb(102, 204, 102);"  >.</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span>             n<span style="color: rgb(102, 204, 102);"  >.</span>to_city<span style="color: rgb(102, 204, 102);"  >,</span>             m<span style="color: rgb(102, 204, 102);"  >.</span>full_route <span style="color: rgb(102, 204, 102);"  >||</span> n<span style="color: rgb(102, 204, 102);"  >.</span>to_city<span style="color: rgb(102, 204, 102);"  >,</span>             m<span style="color: rgb(102, 204, 102);"  >.</span>total_length <span style="color: rgb(102, 204, 102);"  >+</span> n<span style="color: rgb(102, 204, 102);"  >.</span><span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span>             multiroutes m             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >join</span> all_routes n <span style="color: rgb(153, 51, 51); font-weight: bold;"  >ON</span> m<span style="color: rgb(102, 204, 102);"  >.</span>to_city <span style="color: rgb(102, 204, 102);"  >=</span> n<span style="color: rgb(102, 204, 102);"  >.</span>from_city         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span>             n<span style="color: rgb(102, 204, 102);"  >.</span>to_city <span style="color: rgb(102, 204, 102);"  >&lt;&gt;</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >ALL</span><span style="color: rgb(102, 204, 102);"  >(</span> m<span style="color: rgb(102, 204, 102);"  >.</span>full_route <span style="color: rgb(102, 204, 102);"  >)</span>     <span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> multiroutes <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> to_city <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(255, 0, 0);"  >'Toronto'</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >ORDER</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >BY</span> total_length <span style="color: rgb(153, 51, 51); font-weight: bold;"  >desc</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >limit</span> <span style="color: rgb(204, 102, 204);"  >1</span>;</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >But the problem is C it’s extremely slow. And uses a lot of resources, which made OOM killer in my desktop to kill it (yes, stupid OOM killer).</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >I tried to implement simple pruning of searched paths if they are longer than current shortest on given route, but I couldn’t find a way to do it C it seems to require subselect, and subselects referring to recursive queries, are not allowed within the recursive query itself.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><em>(I think that perhaps RhodiumToad (on irc) can do it in a single query, but I’m far away from his level of skills, so I had to pass)</em></p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Does that mean it can’t be done in database? No.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Luckily, we have functions. And functions can be rather smart.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >To make the function simpler to use and write, I defined a type:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  ><span style="color: rgb(153, 51, 51); font-weight: bold;"  >CREATE</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >TYPE</span> route_dsc <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> <span style="color: rgb(102, 204, 102);"  >(</span>     from_city     TEXT<span style="color: rgb(102, 204, 102);"  >,</span>     to_city       TEXT<span style="color: rgb(102, 204, 102);"  >,</span>     full_route    TEXT<span style="color: rgb(102, 204, 102);"  >[</span><span style="color: rgb(102, 204, 102);"  >]</span><span style="color: rgb(102, 204, 102);"  >,</span>     total_length  INT4 <span style="color: rgb(102, 204, 102);"  >)</span>;</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >This is a quite easy way to encapsulate all information about a single route as somewhat scalar value.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Now, I can write the function:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><table style="border-collapse: collapse;"  ><tbody><tr><td style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px; text-align: right; background-color: rgb(221, 238, 255); color: gray; overflow-x: visible; overflow-y: visible;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; font-size: 12px; line-height: 1.333;"  >1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 </pre></td><td style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; font-size: 12px; line-height: 1.333;"  ><span style="color: rgb(153, 51, 51); font-weight: bold;"  >CREATE</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >OR</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >REPLACE</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FUNCTION</span>     get_shortest_route<span style="color: rgb(102, 204, 102);"  >(</span> p_from TEXT<span style="color: rgb(102, 204, 102);"  >,</span> p_to TEXT <span style="color: rgb(102, 204, 102);"  >)</span>     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >RETURNS</span> SETOF route_dsc <span style="color: rgb(153, 51, 51); font-weight: bold;"  >AS</span> $$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >DECLARE</span>     sanity_count   INT4;     final_routes   route_dsc<span style="color: rgb(102, 204, 102);"  >[</span><span style="color: rgb(102, 204, 102);"  >]</span>;     current_routes route_dsc<span style="color: rgb(102, 204, 102);"  >[</span><span style="color: rgb(102, 204, 102);"  >]</span>;     r              route_dsc; <span style="color: rgb(153, 51, 51); font-weight: bold;"  >BEGIN</span>     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >count</span><span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(102, 204, 102);"  >*</span><span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >INTO</span> sanity_count         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> cities         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> city <span style="color: rgb(153, 51, 51); font-weight: bold;"  >in</span> <span style="color: rgb(102, 204, 102);"  >(</span>p_from<span style="color: rgb(102, 204, 102);"  >,</span> p_to<span style="color: rgb(102, 204, 102);"  >)</span>;     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >IF</span> sanity_count <span style="color: rgb(102, 204, 102);"  >&lt;&gt;</span> <span style="color: rgb(204, 102, 204);"  >2</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >THEN</span>         raise exception <span style="color: rgb(255, 0, 0);"  >'These are NOT two, distinct, correct city names.'</span>;     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >END</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >IF</span>; &nbsp;     current_routes :<span style="color: rgb(102, 204, 102);"  >=</span> array<span style="color: rgb(102, 204, 102);"  >(</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >row</span><span style="color: rgb(102, 204, 102);"  >(</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >,</span> ARRAY<span style="color: rgb(102, 204, 102);"  >[</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >]</span><span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span><span style="color: rgb(102, 204, 102);"  >)</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> all_routes         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> from_city <span style="color: rgb(102, 204, 102);"  >=</span> p_from     <span style="color: rgb(102, 204, 102);"  >)</span>;     final_routes :<span style="color: rgb(102, 204, 102);"  >=</span> current_routes; &nbsp;     LOOP         current_routes :<span style="color: rgb(102, 204, 102);"  >=</span> array<span style="color: rgb(102, 204, 102);"  >(</span>             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >row</span><span style="color: rgb(102, 204, 102);"  >(</span>                 c<span style="color: rgb(102, 204, 102);"  >.</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span>                 a<span style="color: rgb(102, 204, 102);"  >.</span>to_city<span style="color: rgb(102, 204, 102);"  >,</span>                 c<span style="color: rgb(102, 204, 102);"  >.</span>full_route <span style="color: rgb(102, 204, 102);"  >||</span> a<span style="color: rgb(102, 204, 102);"  >.</span>to_city<span style="color: rgb(102, 204, 102);"  >,</span>                 c<span style="color: rgb(102, 204, 102);"  >.</span>total_length <span style="color: rgb(102, 204, 102);"  >+</span> a<span style="color: rgb(102, 204, 102);"  >.</span><span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span><span style="color: rgb(102, 204, 102);"  >)</span>             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span>                 unnest<span style="color: rgb(102, 204, 102);"  >(</span> current_routes <span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> c                 <span style="color: rgb(153, 51, 51); font-weight: bold;"  >join</span> all_routes a <span style="color: rgb(153, 51, 51); font-weight: bold;"  >on</span> c<span style="color: rgb(102, 204, 102);"  >.</span>to_city <span style="color: rgb(102, 204, 102);"  >=</span> a<span style="color: rgb(102, 204, 102);"  >.</span>from_city             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span>                 a<span style="color: rgb(102, 204, 102);"  >.</span>to_city <span style="color: rgb(102, 204, 102);"  >&lt;&gt;</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >all</span><span style="color: rgb(102, 204, 102);"  >(</span> c<span style="color: rgb(102, 204, 102);"  >.</span>full_route <span style="color: rgb(102, 204, 102);"  >)</span>                 <span style="color: rgb(153, 51, 51); font-weight: bold;"  >AND</span>                 c<span style="color: rgb(102, 204, 102);"  >.</span>total_length <span style="color: rgb(102, 204, 102);"  >+</span> a<span style="color: rgb(102, 204, 102);"  >.</span><span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> <span style="color: rgb(102, 204, 102);"  >&lt;=</span> least<span style="color: rgb(102, 204, 102);"  >(</span>                     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >coalesce</span><span style="color: rgb(102, 204, 102);"  >(</span>                         <span style="color: rgb(102, 204, 102);"  >(</span>                             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >min</span><span style="color: rgb(102, 204, 102);"  >(</span>l<span style="color: rgb(102, 204, 102);"  >.</span>total_length<span style="color: rgb(102, 204, 102);"  >)</span>                             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> unnest<span style="color: rgb(102, 204, 102);"  >(</span> final_routes <span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> l                             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> <span style="color: rgb(102, 204, 102);"  >(</span> l<span style="color: rgb(102, 204, 102);"  >.</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> l<span style="color: rgb(102, 204, 102);"  >.</span>to_city <span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(102, 204, 102);"  >(</span>c<span style="color: rgb(102, 204, 102);"  >.</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> p_to<span style="color: rgb(102, 204, 102);"  >)</span>                         <span style="color: rgb(102, 204, 102);"  >)</span><span style="color: rgb(102, 204, 102);"  >,</span>                         c<span style="color: rgb(102, 204, 102);"  >.</span>total_length <span style="color: rgb(102, 204, 102);"  >+</span> a<span style="color: rgb(102, 204, 102);"  >.</span><span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span>                     <span style="color: rgb(102, 204, 102);"  >)</span><span style="color: rgb(102, 204, 102);"  >,</span>                     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >coalesce</span><span style="color: rgb(102, 204, 102);"  >(</span>                         <span style="color: rgb(102, 204, 102);"  >(</span>                             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >min</span><span style="color: rgb(102, 204, 102);"  >(</span>l<span style="color: rgb(102, 204, 102);"  >.</span>total_length<span style="color: rgb(102, 204, 102);"  >)</span>                             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> unnest<span style="color: rgb(102, 204, 102);"  >(</span> final_routes <span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> l                             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> <span style="color: rgb(102, 204, 102);"  >(</span> l<span style="color: rgb(102, 204, 102);"  >.</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> l<span style="color: rgb(102, 204, 102);"  >.</span>to_city <span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(102, 204, 102);"  >(</span>c<span style="color: rgb(102, 204, 102);"  >.</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> a<span style="color: rgb(102, 204, 102);"  >.</span>to_city<span style="color: rgb(102, 204, 102);"  >)</span>                         <span style="color: rgb(102, 204, 102);"  >)</span><span style="color: rgb(102, 204, 102);"  >,</span>                         c<span style="color: rgb(102, 204, 102);"  >.</span>total_length <span style="color: rgb(102, 204, 102);"  >+</span> a<span style="color: rgb(102, 204, 102);"  >.</span><span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span>                     <span style="color: rgb(102, 204, 102);"  >)</span>                 <span style="color: rgb(102, 204, 102);"  >)</span>         <span style="color: rgb(102, 204, 102);"  >)</span>;         EXIT <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHEN</span> current_routes <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(255, 0, 0);"  >'{}'</span>;         final_routes :<span style="color: rgb(102, 204, 102);"  >=</span> final_routes <span style="color: rgb(102, 204, 102);"  >||</span> current_routes;     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >END</span> LOOP;     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >RETURN</span> query         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WITH</span> rr <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> <span style="color: rgb(102, 204, 102);"  >(</span>             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span>                 from_city<span style="color: rgb(102, 204, 102);"  >,</span>                 to_city<span style="color: rgb(102, 204, 102);"  >,</span>                 full_route<span style="color: rgb(102, 204, 102);"  >,</span>                 total_length<span style="color: rgb(102, 204, 102);"  >,</span>                 dense_rank<span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(102, 204, 102);"  >)</span>                     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >over</span> <span style="color: rgb(102, 204, 102);"  >(</span>partition <span style="color: rgb(153, 51, 51); font-weight: bold;"  >BY</span> from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city <span style="color: rgb(153, 51, 51); font-weight: bold;"  >ORDER</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >BY</span> total_length<span style="color: rgb(102, 204, 102);"  >)</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >as</span> rank             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> unnest<span style="color: rgb(102, 204, 102);"  >(</span> final_routes <span style="color: rgb(102, 204, 102);"  >)</span>             <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> from_city <span style="color: rgb(102, 204, 102);"  >=</span> p_from <span style="color: rgb(153, 51, 51); font-weight: bold;"  >AND</span> to_city <span style="color: rgb(102, 204, 102);"  >=</span> p_to         <span style="color: rgb(102, 204, 102);"  >)</span>         <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >,</span> full_route<span style="color: rgb(102, 204, 102);"  >,</span> total_length <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> rr <span style="color: rgb(153, 51, 51); font-weight: bold;"  >where</span> rank <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(204, 102, 204);"  >1</span>;     <span style="color: rgb(153, 51, 51); font-weight: bold;"  >RETURN</span>; <span style="color: rgb(153, 51, 51); font-weight: bold;"  >END</span>; $$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >language</span> plpgsql;</pre></td></tr></table></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Looks huge, but in fact it’s only because there are many queries inside. So, let’s see what the function does:</p><ul style="color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><li style=""  >lines 1-4 C standard preamble with function name, 2 arguments (cities we want to connect), and information that we will be returning set of records based on the type I just defined. In here you might wonder C why set of? We want just the shortest route. Yes, that’s correct but it’s perfectly possible (and very common) that there are many rows with the same, minimal length. So, instead of picking one randomly C I will return them all.</li><li style=""  >lines 6-9 C variable declarations, not really interesting</li><li style=""  >lines 11-16 C sanity check. Simple verification that both given names are city names, and that they are different.</li><li style=""  >lines 18-22 C I build current_routes based on all routes coming from source city. For example, If I’d call the function to find me route from Duluth to Toronto, the array would get these rows:<div style="color: rgb(17, 0, 0); background-color: rgb(249, 249, 249); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 650px;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >,</span> ARRAY<span style="color: rgb(102, 204, 102);"  >[</span>from_city<span style="color: rgb(102, 204, 102);"  >,</span> to_city<span style="color: rgb(102, 204, 102);"  >]</span><span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> all_routes <span style="color: rgb(153, 51, 51); font-weight: bold;"  >WHERE</span> from_city <span style="color: rgb(102, 204, 102);"  >=</span> <span style="color: rgb(255, 0, 0);"  >'Duluth'</span>;  from_city │    to_city     │           array           │ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >length</span> ───────────┼────────────────┼───────────────────────────┼────────  Duluth    │ Helena         │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Helena<span style="color: rgb(102, 204, 102);"  >}</span>           │      <span style="color: rgb(204, 102, 204);"  >6</span>  Duluth    │ Winnipeg       │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Winnipeg<span style="color: rgb(102, 204, 102);"  >}</span>         │      <span style="color: rgb(204, 102, 204);"  >4</span>  Duluth    │ Sault St Marie │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Sault St Marie"</span><span style="color: rgb(102, 204, 102);"  >}</span> │      <span style="color: rgb(204, 102, 204);"  >3</span>  Duluth    │ Toronto        │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Toronto<span style="color: rgb(102, 204, 102);"  >}</span>          │      <span style="color: rgb(204, 102, 204);"  >6</span>  Duluth    │ Omaha          │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >}</span>            │      <span style="color: rgb(204, 102, 204);"  >2</span>  Duluth    │ Chicago        │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Chicago<span style="color: rgb(102, 204, 102);"  >}</span>          │      <span style="color: rgb(204, 102, 204);"  >3</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >6</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >rows</span><span style="color: rgb(102, 204, 102);"  >)</span></pre></div></div></li><li style=""  >line 23 C I copy current_routes to “final_routes”. current_routes contains only routes that the loop below has to work on, but final routes C is an array of all routes that will be used for finding final solution</li><li style=""  >lines 25-59 C basically infinite loop (of course with proper exit condition), which recursively finds routes:<ul><li style=""  >lines 26-56 C core of the function. This query builds new list of routes, based on what’s in current_routes, with following criteria:<ul><li style=""  >new route must be from a city that is at the end of some route in “current_routes” (i.e. it’s next segment for multi-city route</li><li style=""  >added (to route) city cannot be already in full_route (there is no point in revisiting cities when we’re looking for shortest path</li><li style=""  >new total length of route (i.e. some route from current_routes + new segment) has to be shorter (or the same) as existing shortest path between these two cities. By “these” I mean original “from” city, and newly added “to” city. So, if we already have a route between cities “a” and “b” that is “10″ long, there is no point in adding new route that is “20″ long.</li><li style=""  >similar condition as above, but checking against already found&nbsp;<em>requested</em>&nbsp;route C i.e. route between cities user requested in passing arguments</li><li style=""  >above two criteria make sense only if there are matching routes already in final_routes C hence the need for coalesce()</li></ul><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em;"  >All such routes are stored in current_routes for future checking</p></li><li style=""  >line 57 C if the query above didn’t return any routes C we’re done, can exit the loop</li><li style=""  >line 58 C if there are some routes C add them to final_routes, and repeat the loop</li></ul></li><li style=""  >lines 60-72 C return of the important data. I take all the routes in final_routes, from there, pick only the ones that match from_city/to_city with parameters given on function call, and then I use dense_rank() to find all records that have minimal total_length. All these records will get returned.</li></ul><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >If that’s complex, let me show you an example. What is stored, in which variable, at which step, when finding the route from Duluth to Toronto.</p><ul style="color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><li style=""  >after line 23 in function, both current_routes and final_routes contain:<br><table style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  ><thead><tr><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >from_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >to_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >total_length</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >full_route</th></tr></thead><tbody><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Helena</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Helena}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Winnipeg</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >4</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Winnipeg}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Sault St Marie</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,”Sault St Marie”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Toronto</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Toronto}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Omaha</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >2</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Chicago</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago}</td></tr></table></li><li style=""  >First run of the main recursive query C at line 57 current_routes are:<br><table style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  ><thead><tr><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >from_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >to_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >total_length</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >full_route</th></tr></thead><tbody><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Toronto</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,”Sault St Marie”,Toronto}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Pittsburg</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago,Pittsburg}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Saint Louis</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago,”Saint Louis”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Denver</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,Denver}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Kansas City</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”}</td></tr></table><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em;"  >and since it’s obviously not empty set C it continues.<br><br>Please note that it didn’t (for example) add route Duluth C Helena C Seattle (which is correct route, as you can see on the image above). Reason is very simple C we already found one route Duluth C Toronto, and its length is 6, so adding new route which is longer than this C doesn’t make sense.</p></li><li style=""  >At line 58 final_routes are set to:<br><table style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  ><thead><tr><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >from_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >to_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >total_length</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >full_route</th></tr></thead><tbody><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Helena</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Helena}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Winnipeg</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >4</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Winnipeg}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Sault St Marie</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,”Sault St Marie”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Toronto</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Toronto}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Omaha</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >2</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Chicago</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Toronto</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,”Sault St Marie”,Toronto}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Pittsburg</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago,Pittsburg}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Saint Louis</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago,”Saint Louis”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Denver</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,Denver}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Kansas City</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”}</td></tr></table><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em;"  >Which is simply previous final_routes with added new 5.</p></li><li style=""  >After next iteration of the loop, based on 5-element current_routes, we got only two new routes:<br><table style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  ><thead><tr><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >from_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >to_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >total_length</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >full_route</th></tr></thead><tbody><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Oklahoma City</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”,”Oklahoma City”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Saint Louis</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”,”Saint Louis”}</td></tr></table><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em;"  >And of course they got added to final_routes.</p></li><li style=""  >another iteration of the loop, based on current_routes with just two elements C didn’t return any rows. There simply is no way to extend routes “Duluth-Omaha-Kansas City” or “Duluth-Omaha-Saint Louis” in a way that wouldn’t extend already found route “Duluth-Sault St Marie-Toronto” with length 5.</li><li style=""  >Since this iteration of loop didn’t find anything, loop exits, and the final_routes contains:<br><table style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  ><thead><tr><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >from_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >to_city</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >total_length</th><th style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em; text-align: center;"  >full_route</th></tr></thead><tbody><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Helena</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Helena}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Winnipeg</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >4</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Winnipeg}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Sault St Marie</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,”Sault St Marie”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Toronto</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Toronto}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Omaha</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >2</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Chicago</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Toronto</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,”Sault St Marie”,Toronto}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Pittsburg</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago,Pittsburg}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Saint Louis</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Chicago,”Saint Louis”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Denver</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >6</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,Denver}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Kansas City</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >3</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Oklahoma City</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”,”Oklahoma City”}</td></tr><tr><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Duluth</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >Saint Louis</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >5</td><td style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: black; border-right-color: black; border-bottom-color: black; border-left-color: black; border-image: initial; border-collapse: collapse; padding-top: 0.5em; padding-right: 0.5em; padding-bottom: 0.5em; padding-left: 0.5em;"  >{Duluth,Omaha,”Kansas City”,”Saint Louis”}</td></tr></table></li></ul><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Based on the final_routes above, query in lines 61-72 calculates correct answer, and shows it.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >OK. So it works. But how slow it is?</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >First, let’s start with very simple example C Atlanta C Nashville. These two cities are connected using a single one-element route. Call to function:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> get_shortest_route<span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(255, 0, 0);"  >'Atlanta'</span><span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(255, 0, 0);"  >'Nashville'</span><span style="color: rgb(102, 204, 102);"  >)</span>;  from_city │  to_city  │     full_route      │ total_length ───────────┼───────────┼─────────────────────┼──────────────  Atlanta   │ Nashville │ <span style="color: rgb(102, 204, 102);"  >{</span>Atlanta<span style="color: rgb(102, 204, 102);"  >,</span>Nashville<span style="color: rgb(102, 204, 102);"  >}</span> │            <span style="color: rgb(204, 102, 204);"  >1</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >1</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >row</span><span style="color: rgb(102, 204, 102);"  >)</span> &nbsp; <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Time</span>: <span style="color: rgb(204, 102, 204);"  >1.045</span> ms</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >What about the Duluth-Toronto?</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> get_shortest_route<span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(255, 0, 0);"  >'Duluth'</span><span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(255, 0, 0);"  >'Toronto'</span><span style="color: rgb(102, 204, 102);"  >)</span>;  from_city │ to_city │            full_route             │ total_length ───────────┼─────────┼───────────────────────────────────┼──────────────  Duluth    │ Toronto │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Sault St Marie"</span><span style="color: rgb(102, 204, 102);"  >,</span>Toronto<span style="color: rgb(102, 204, 102);"  >}</span> │            <span style="color: rgb(204, 102, 204);"  >5</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >1</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >row</span><span style="color: rgb(102, 204, 102);"  >)</span> &nbsp; <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Time</span>: <span style="color: rgb(204, 102, 204);"  >2.239</span> ms</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >Something longer perhaps:</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> get_shortest_route<span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(255, 0, 0);"  >'Duluth'</span><span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(255, 0, 0);"  >'Los Angeles'</span><span style="color: rgb(102, 204, 102);"  >)</span>;  from_city │   to_city   │                                  full_route                                   │ total_length ───────────┼─────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────  Duluth    │ Los Angeles │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >,</span>Denver<span style="color: rgb(102, 204, 102);"  >,</span>Phoenix<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Los Angeles"</span><span style="color: rgb(102, 204, 102);"  >}</span>                                   │           <span style="color: rgb(204, 102, 204);"  >14</span>  Duluth    │ Los Angeles │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >,</span>Denver<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Santa Fe"</span><span style="color: rgb(102, 204, 102);"  >,</span>Phoenix<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Los Angeles"</span><span style="color: rgb(102, 204, 102);"  >}</span>                        │           <span style="color: rgb(204, 102, 204);"  >14</span>  Duluth    │ Los Angeles │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Kansas City"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Oklahoma City"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Santa Fe"</span><span style="color: rgb(102, 204, 102);"  >,</span>Phoenix<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Los Angeles"</span><span style="color: rgb(102, 204, 102);"  >}</span> │           <span style="color: rgb(204, 102, 204);"  >14</span>  Duluth    │ Los Angeles │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Helena<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Salt Lake City"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Las Vegas"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Los Angeles"</span><span style="color: rgb(102, 204, 102);"  >}</span>                    │           <span style="color: rgb(204, 102, 204);"  >14</span>  Duluth    │ Los Angeles │ <span style="color: rgb(102, 204, 102);"  >{</span>Duluth<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >,</span>Denver<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Salt Lake City"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Las Vegas"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Los Angeles"</span><span style="color: rgb(102, 204, 102);"  >}</span>              │           <span style="color: rgb(204, 102, 204);"  >14</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >5</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >rows</span><span style="color: rgb(102, 204, 102);"  >)</span></pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >And how about a cross country?</p><div style="color: rgb(17, 0, 0); border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: silver; border-right-color: silver; border-bottom-color: silver; border-left-color: silver; border-image: initial; margin-top: 0px; margin-right: 0px; margin-bottom: 1.5em; margin-left: 0px; overflow-x: auto; overflow-y: hidden; width: 690px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  ><div style="vertical-align: top; padding-top: 2px; padding-right: 4px; padding-bottom: 2px; padding-left: 4px;"  ><pre style="margin-top: 0px; margin-bottom: 0px; width: auto; float: none; clear: none; overflow-x: visible; overflow-y: visible; line-height: 1.333;"  >$ <span style="color: rgb(153, 51, 51); font-weight: bold;"  >SELECT</span> <span style="color: rgb(102, 204, 102);"  >*</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >FROM</span> get_shortest_route<span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(255, 0, 0);"  >'Vancouver'</span><span style="color: rgb(102, 204, 102);"  >,</span> <span style="color: rgb(255, 0, 0);"  >'Miami'</span><span style="color: rgb(102, 204, 102);"  >)</span>;  from_city │ to_city │                                      full_route                                      │ total_length ───────────┼─────────┼──────────────────────────────────────────────────────────────────────────────────────┼──────────────  Vancouver │ Miami   │ <span style="color: rgb(102, 204, 102);"  >{</span>Vancouver<span style="color: rgb(102, 204, 102);"  >,</span>Calgary<span style="color: rgb(102, 204, 102);"  >,</span>Helena<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Kansas City"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Saint Louis"</span><span style="color: rgb(102, 204, 102);"  >,</span>Nashville<span style="color: rgb(102, 204, 102);"  >,</span>Atlanta<span style="color: rgb(102, 204, 102);"  >,</span>Miami<span style="color: rgb(102, 204, 102);"  >}</span> │           <span style="color: rgb(204, 102, 204);"  >23</span>  Vancouver │ Miami   │ <span style="color: rgb(102, 204, 102);"  >{</span>Vancouver<span style="color: rgb(102, 204, 102);"  >,</span>Seattle<span style="color: rgb(102, 204, 102);"  >,</span>Helena<span style="color: rgb(102, 204, 102);"  >,</span>Omaha<span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Kansas City"</span><span style="color: rgb(102, 204, 102);"  >,</span><span style="color: rgb(255, 0, 0);"  >"Saint Louis"</span><span style="color: rgb(102, 204, 102);"  >,</span>Nashville<span style="color: rgb(102, 204, 102);"  >,</span>Atlanta<span style="color: rgb(102, 204, 102);"  >,</span>Miami<span style="color: rgb(102, 204, 102);"  >}</span> │           <span style="color: rgb(204, 102, 204);"  >23</span> <span style="color: rgb(102, 204, 102);"  >(</span><span style="color: rgb(204, 102, 204);"  >2</span> <span style="color: rgb(153, 51, 51); font-weight: bold;"  >rows</span><span style="color: rgb(102, 204, 102);"  >)</span> &nbsp; <span style="color: rgb(153, 51, 51); font-weight: bold;"  >Time</span>: <span style="color: rgb(204, 102, 204);"  >62.507</span> ms</pre></div></div><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >The longer the road the more time it takes to find it. Which is pretty understandable.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >So, to wrap it. It can be done in database. It is not as slow as I expected.&nbsp;<em>I</em>&nbsp;wasn’t able to find a way to do it without functions, but it might be possible for someone smarter than me.</p><p style="padding-top: 10px; padding-bottom: 10px; margin-top: 0px; margin-bottom: 0px; text-indent: 3em; color: rgb(49, 49, 49); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; text-align: justify;"  >And I still don’t think it’s a good idea to put this logic in database.</p><br><wbr></div></div>
	</div>
</div>
</body>
</html>