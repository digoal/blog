<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">使用chol()分解正定矩阵(positive definite matrix), Choleskey</h2>
	<h5 id="">2015-04-13 10:52:05&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201531310451672/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>正定矩阵的定义 :&nbsp;</div><div><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.3999996185303px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >一个<span lang="en"   xmllang="en"   style="font-family: serif;"   ><span style="white-space: nowrap;"   ><i>n</i>×<i>n</i></span></span>的实<a title="&#23565;&#31281;&#30697;&#38499;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%B0%8D%E7%A8%B1%E7%9F%A9%E9%99%A3"   >对称矩阵</a><b><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   alt="M"   src="http://upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"   style="border-style: none; vertical-align: middle; margin: 0px; display: inline-block;"   ></b>是<b>正定</b>的，<a title="&#24403;&#19988;&#20165;&#24403;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%BD%93%E4%B8%94%E4%BB%85%E5%BD%93"   >当且仅当</a>对于所有的非零实系数<a title="&#21521;&#37327;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%90%91%E9%87%8F"   >向量</a><span lang="en"   xmllang="en"   style="font-family: serif;"   ><span style="white-space: nowrap;"   ><i>z</i></span></span>，都有<span lang="en"   xmllang="en"   style="font-family: serif;"   ><span style="white-space: nowrap;"   ><i>z</i><sup style="line-height: 1;"   >T</sup><b><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   alt="M"   src="http://upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"   style="border-style: none; vertical-align: middle; margin: 0px; display: inline-block;"   ></b><i>z</i>&nbsp;&gt; 0</span></span>。其中<i>z</i><sup style="line-height: 1;"   >T</sup>表示<i>z</i>的<a title="&#36681;&#32622;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E8%BD%89%E7%BD%AE"   >转置</a>。</p><p style="margin-top: 0.5em; margin-bottom: 0.5em; line-height: 22.3999996185303px; color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px;"   >对于<a title="&#22797;&#25968;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%A4%8D%E6%95%B0"   >复数</a>的情况，定义则为：一个<span lang="en"   xmllang="en"   style="font-family: serif;"   ><span style="white-space: nowrap;"   ><i>n</i>×<i>n</i></span></span>的<a title="&#22467;&#23572;&#31859;&#29305;&#30697;&#38453;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%9F%83%E5%B0%94%E7%B1%B3%E7%89%B9%E7%9F%A9%E9%98%B5"   >埃尔米特矩阵</a>(或厄米矩阵)<b><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   alt="M"   src="http://upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"   style="border-style: none; vertical-align: middle; margin: 0px; display: inline-block;"   ></b>是正定的当且仅当对于每个非零的}向量<i>z</i>，都有<i>z</i><sup style="line-height: 1;"   >*</sup><b><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   alt="M"   src="http://upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"   style="border-style: none; vertical-align: middle; margin: 0px; display: inline-block;"   ></b><i>z</i>&nbsp;&gt; 0。其中<i>z</i><sup style="line-height: 1;"   >*</sup>表示<i>z</i>的<a title="&#20849;&#36717;&#36716;&#32622;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%85%B1%E8%BD%AD%E8%BD%AC%E7%BD%AE"   >共轭转置</a>。由于<b><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   alt="M"   src="http://upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"   style="border-style: none; vertical-align: middle; margin: 0px; display: inline-block;"   ></b>是<a title="&#22467;&#23572;&#31859;&#29305;&#30697;&#38453;" style="text-decoration: none; color: rgb(11, 0, 128); background: none;" rel="nofollow" href="http://zh.wikipedia.org/wiki/%E5%9F%83%E5%B0%94%E7%B1%B3%E7%89%B9%E7%9F%A9%E9%98%B5"   >埃尔米特矩阵</a>，经计算可知，对于任意的}向量<i>z</i>，<i>z</i><sup style="line-height: 1;"   >*</sup><i><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   alt="M"   src="http://upload.wikimedia.org/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"   style="border-style: none; vertical-align: middle; margin: 0px; display: inline-block;"   >z</i>必然是实数，从而可以与0比较大小。因此这个定义是自洽的。</p></div><div>使用chol可以分解为上三角和下三角矩阵.</div><div>对于正定矩阵A，可对其进行Choleskey分解，即：A=P'P，其中P为上三角矩阵，在R中可以用函数chol()进行Choleskey分解.</div><div>例子 :&nbsp;</div><div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; a &lt;- diag(3)+1</font></div><div><font size="2"   >&gt; a</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;2 &nbsp; &nbsp;1 &nbsp; &nbsp;1</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;1 &nbsp; &nbsp;2 &nbsp; &nbsp;1</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;1 &nbsp; &nbsp;1 &nbsp; &nbsp;2</font></div><div><font size="2"   >&gt; chol(a)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[,1] &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; &nbsp;[,3]</font></div><div><font size="2"   >[1,] 1.414214 0.7071068 0.7071068</font></div><div><font size="2"   >[2,] 0.000000 1.2247449 0.4082483</font></div><div><font size="2"   >[3,] 0.000000 0.0000000 1.1547005</font></div><div><font size="2"   >&gt; t(chol(a))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [,1] &nbsp; &nbsp; &nbsp;[,2] &nbsp; &nbsp; [,3]</font></div><div><font size="2"   >[1,] 1.4142136 0.0000000 0.000000</font></div><div><font size="2"   >[2,] 0.7071068 1.2247449 0.000000</font></div><div><font size="2"   >[3,] 0.7071068 0.4082483 1.154701</font></div><p></p></pre></div><div>验证 : &nbsp;<span style="line-height: 28px;"   >A=P'P</span></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; crossprod(chol(a))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;2 &nbsp; &nbsp;1 &nbsp; &nbsp;1</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;1 &nbsp; &nbsp;2 &nbsp; &nbsp;1</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;1 &nbsp; &nbsp;1 &nbsp; &nbsp;2</font></div><div><font size="2"   >&gt; t(chol(a)) %*% chol(a)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp;[,1] [,2] [,3]</font></div><div><font size="2"   >[1,] &nbsp; &nbsp;2 &nbsp; &nbsp;1 &nbsp; &nbsp;1</font></div><div><font size="2"   >[2,] &nbsp; &nbsp;1 &nbsp; &nbsp;2 &nbsp; &nbsp;1</font></div><div><font size="2"   >[3,] &nbsp; &nbsp;1 &nbsp; &nbsp;1 &nbsp; &nbsp;2</font></div><p></p></pre></div></div><div><div>若矩阵为对称正定矩阵，可以利用Choleskey分解求行列式的值，如：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; prod(diag(chol(A))^2)</font></div><div><font size="2"   >[1] 5</font></div><div><font size="2"   >&gt; det(A)</font></div><div><font size="2"   >[1] 5</font></div><p></p></pre></div><div>若矩阵为对称正定矩阵，可以利用Choleskey分解求矩阵的逆，这时用函数chol2inv()，这种用法更有效。如：</div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >&gt; chol2inv(chol(A))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; [,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] 0.8 -0.2 -0.2 -0.2</font></div><div><font size="2"   >[2,] -0.2 0.8 -0.2 -0.2</font></div><div><font size="2"   >[3,] -0.2 -0.2 0.8 -0.2</font></div><div><font size="2"   >[4,] -0.2 -0.2 -0.2 0.8</font></div><div><font size="2"   >&gt; solve(A)</font></div><div><font size="2"   >&nbsp; [,1] [,2] [,3] [,4]</font></div><div><font size="2"   >[1,] 0.8 -0.2 -0.2 -0.2</font></div><div><font size="2"   >[2,] -0.2 0.8 -0.2 -0.2</font></div><div><font size="2"   >[3,] -0.2 -0.2 0.8 -0.2</font></div><div><font size="2"   >[4,] -0.2 -0.2 -0.2 0.8</font></div><p></p></pre></div></div><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://zh.wikipedia.org/zh/%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5"   >http://zh.wikipedia.org/zh/%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5</a></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="Choleskey分解正定矩阵(positive definite matrix) - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>