<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">[转]Python3获取股票行情数据（中国个股/中国指数/全球指数）</h2>
	<h5 id="">2015-06-30 15:08:25&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020155303825767/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>搞挖掘没有数据样本是不行的，股票数据是非常好的样本。</div><div>【原文】</div><div><a target="_blank" rel="nofollow" href="http://www.cnblogs.com/txw1958/archive/2012/07/28/python3-stock.html"   >http://www.cnblogs.com/txw1958/archive/2012/07/28/python3-stock.html</a></div><div><br></div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >#!/usr/local/bin/python3</font></div><div><font size="2"   >#coding=utf-8</font></div><div><font size="2"   >#source http://www.cnblogs.com/txw1958/</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >import os, io, sys, re, time, json, base64</font></div><div><font size="2"   >import webbrowser, urllib.request</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >period_All_List = [</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "min", &nbsp; &nbsp; &nbsp;#分时线</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "daily", &nbsp; &nbsp;#日K线</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "weekly", &nbsp; #周K线</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "monthly" &nbsp; #月K线</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</font></div><div><font size="2"   >period_min = period_All_List[0]</font></div><div><font size="2"   >period_daily = period_All_List[1]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >ChinaStockIndexList = [</font></div><div><font size="2"   >&nbsp; &nbsp; "000001", # sh000001 上证指数</font></div><div><font size="2"   >&nbsp; &nbsp; "399001", # sz399001 深证成指</font></div><div><font size="2"   >&nbsp; &nbsp; "000300", # sh000300 沪深300</font></div><div><font size="2"   >&nbsp; &nbsp; "399005", # sz399005 中小板指</font></div><div><font size="2"   >&nbsp; &nbsp; "399006", # sz399006 创业板指</font></div><div><font size="2"   >&nbsp; &nbsp; "000003", &nbsp;# sh000003 B股指数</font></div><div><font size="2"   >]</font></div><div><font size="2"   >ChinaStockIndividualList = [</font></div><div><font size="2"   >&nbsp; &nbsp; "000063", # &nbsp;中兴通讯</font></div><div><font size="2"   >&nbsp; &nbsp; "600036", # &nbsp;招商银行</font></div><div><font size="2"   >]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >WorldStockIndexList = [</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"000001", 'yahoo':"000001.SS",'name':{'chinese':"中国上证指数", 'english':"CHINA SHANGHAI COMPOSITE INDEX"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"399001", 'yahoo':"399001.SZ",'name':{'chinese':"中国深证成指", 'english':"SZSE COMPONENT INDEX"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"DJI", 'yahoo':"^DJI",'name':{'chinese':"美国道琼斯工业平均指数", 'english':"Dow Jones Industrial Average"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"IXIC", 'yahoo':"^IXIC",'name':{'chinese':"美国纳斯达克综合指数", 'english':"NASDAQ Composite"},},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"GSPC", 'yahoo':"^GSPC",'name':{'chinese':"美国标准普尔500指数", 'english':"S&amp;P 500"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"N225", 'yahoo':"^N225",'name':{'chinese':"日本日经225指数", 'english':"NIKKEI 225"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"TWII", 'yahoo':"^TWII",'name':{'chinese':"台湾台北加权指数", 'english':"TSEC weighted index"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"HSI", 'yahoo':"^HSI",'name':{'chinese':"香港恒生指数", 'english':"HANG SENG INDEX"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"FCHI", 'yahoo':"^FCHI",'name':{'chinese':"法国CAC40指数", 'english':"CAC 40"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"FTSE", 'yahoo':"^FTSE",'name':{'chinese':"英国富时100指数", 'english':"FTSE 100"}},</font></div><div><font size="2"   >&nbsp; &nbsp; {'code':"GDAXI", 'yahoo':"^GDAXI",'name':{'chinese':"德国法兰克福DAX指数", 'english':"DAX"}</font></div><div><font size="2"   >&nbsp; &nbsp; }</font></div><div><font size="2"   >]</font></div><div><font size="2"   >WorldStockIndexList_SP500 = &nbsp;WorldStockIndexList[7]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#国内股票数据：指数</font></div><div><font size="2"   >def getChinaStockIndexInfo(stockCode, period):</font></div><div><font size="2"   >&nbsp; &nbsp; try:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; exchange = "sz" if (int(stockCode) // 100000 == 3) else "sh"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; #http://hq.sinajs.cn/list=s_sh000001</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; dataUrl = "http://hq.sinajs.cn/list=s_" + exchange + stockCode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stdout = urllib.request.urlopen(dataUrl)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stdoutInfo = stdout.read().decode('gb2312')</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; tempData = re.search('''(")(.+)(")''', stdoutInfo).group(2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockInfo = tempData.split(",")</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; #stockCode = stockCode,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockName &nbsp; = stockInfo[0]</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockEnd &nbsp; &nbsp;= stockInfo[1] &nbsp;#当前价，15点后为收盘价</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockZD &nbsp; &nbsp; = stockInfo[2] &nbsp;#涨跌</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockLastEnd= str(float(stockEnd) - float(stockZD)) #开盘价</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockFD &nbsp; &nbsp; = stockInfo[3] &nbsp;#幅度</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockZS &nbsp; &nbsp; = stockInfo[4] &nbsp;#总手</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockZS_W &nbsp; = str(int(stockZS) / 100)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockJE &nbsp; &nbsp; = stockInfo[5] &nbsp;#金额</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockJE_Y &nbsp; = str(int(stockJE) / 10000)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; content = "#" + stockName + "#" + "(" + str(stockCode) + ")" + " 收盘：" \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + stockEnd + "，涨跌：" + stockZD + "，幅度：" + stockFD + "%" \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + "，总手：" + stockZS_W + "万" + "，金额：" + stockJE_Y + "亿" + " &nbsp;"</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; imgPath = "http://image.sinajs.cn/newchart/" + period + "/n/" + exchange + str(stockCode) + ".gif"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; twitter = {'message': content, 'image': imgPath}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; except Exception as e:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print("&gt;&gt;&gt;&gt;&gt;&gt; Exception: " + str(e))</font></div><div><font size="2"   >&nbsp; &nbsp; else:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; return twitter</font></div><div><font size="2"   >&nbsp; &nbsp; finally:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; None</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#国内股票数据：个股</font></div><div><font size="2"   >def getChinaStockIndividualInfo(stockCode, period):</font></div><div><font size="2"   >&nbsp; &nbsp; try:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; exchange = "sh" if (int(stockCode) // 100000 == 6) else "sz"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; dataUrl = "http://hq.sinajs.cn/list=" + exchange + stockCode</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stdout = urllib.request.urlopen(dataUrl)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stdoutInfo = stdout.read().decode('gb2312')</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; tempData = re.search('''(")(.+)(")''', stdoutInfo).group(2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockInfo = tempData.split(",")</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; #stockCode = stockCode,</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockName &nbsp; = stockInfo[0] &nbsp;#名称</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockStart &nbsp;= stockInfo[1] &nbsp;#开盘</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockLastEnd= stockInfo[2] &nbsp;#昨收盘</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockCur &nbsp; &nbsp;= stockInfo[3] &nbsp;#当前</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockMax &nbsp; &nbsp;= stockInfo[4] &nbsp;#最高</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockMin &nbsp; &nbsp;= stockInfo[5] &nbsp;#最低</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockUp &nbsp; &nbsp; = round(float(stockCur) - float(stockLastEnd), 2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockRange &nbsp;= round(float(stockUp) / float(stockLastEnd), 4) * 100</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockVolume = round(float(stockInfo[8]) / (100 * 10000), 2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockMoney &nbsp;= round(float(stockInfo[9]) / (100000000), 2)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockTime &nbsp; = stockInfo[31]</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; content = "#" + stockName + "#(" + stockCode + ")" + " 开盘:" + stockStart \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; + ",最新:" + stockCur + ",最高:" + stockMax + ",最低:" + stockMin \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; + ",涨跌:" + str(stockUp) + ",幅度:" + str(stockRange) + "%" \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; + ",总手:" + str(stockVolume) + "万" + ",金额:" + str(stockMoney) \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; + "亿" + ",更新时间:" + stockTime + " &nbsp;"</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; imgUrl = "http://image.sinajs.cn/newchart/" + period + "/n/" + exchange + str(stockCode) + ".gif"</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; twitter = {'message': content, 'image': imgUrl}</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; except Exception as e:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print("&gt;&gt;&gt;&gt;&gt;&gt; Exception: " + str(e))</font></div><div><font size="2"   >&nbsp; &nbsp; else:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; return twitter</font></div><div><font size="2"   >&nbsp; &nbsp; finally:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; None</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#全球股票指数</font></div><div><font size="2"   >def getWorldStockIndexInfo(stockDict):</font></div><div><font size="2"   >&nbsp; &nbsp; try:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; #http://download.finance.yahoo.com/d/quotes.csv?s=^IXIC&amp;f=sl1c1p2l</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; yahooCode = stockDict['yahoo']</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; dataUrl = "http://download.finance.yahoo.com/d/quotes.csv?s=" + yahooCode + "&amp;f=sl1c1p2l"</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stdout = urllib.request.urlopen(dataUrl)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stdoutInfo = stdout.read().decode('gb2312')</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; tempData = stdoutInfo.replace('"', '')</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockInfo = tempData.split(",")</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockNameCn = stockDict['name']['chinese']</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockNameEn = stockDict['name']['english']</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockCode &nbsp; = stockDict['code']</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockEnd &nbsp; &nbsp;= stockInfo[1] &nbsp;#当前价，5点后为收盘价</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockZD &nbsp; &nbsp; = stockInfo[2] &nbsp;#涨跌</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockLastEnd= str(float(stockEnd) - float(stockZD)) #开盘价</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockFD &nbsp; &nbsp; = stockInfo[3] &nbsp;#幅度</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; percent &nbsp; &nbsp; = float(stockFD.replace("%", ""))</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; matchResult = re.search("([\w?\s?:]*)(\-)", stockInfo[4]) &nbsp;#日期和最新值</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; stockDate &nbsp; = matchResult.group(1)</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; content = "#" + stockNameCn + "# " + stockNameEn + "(" + stockCode + ")" \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + " 当前：" + stockEnd + ", 涨跌：" + stockZD + ", 幅度：" + stockFD \</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + ", 最后交易时间：" + stockDate</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; twitter = content</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >&nbsp; &nbsp; except Exception as err:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print("&gt;&gt;&gt;&gt;&gt;&gt; Exception: " + yahooCode + " " + str(err))</font></div><div><font size="2"   >&nbsp; &nbsp; else:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; return twitter</font></div><div><font size="2"   >&nbsp; &nbsp; finally:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; None</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >def test_china_index_data():</font></div><div><font size="2"   >&nbsp; &nbsp; for stockCode in ChinaStockIndexList:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; twitter = getChinaStockIndexInfo(stockCode, period_daily)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print(twitter['message'] + twitter['image'])</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >def test_china_individual_data():</font></div><div><font size="2"   >&nbsp; &nbsp; for stockCode in ChinaStockIndividualList:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; twitter = getChinaStockIndividualInfo(stockCode, period_min)</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print(twitter['message'] + twitter['image'])</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >def test_global_index_data():</font></div><div><font size="2"   >&nbsp; &nbsp; for stockDict in WorldStockIndexList:</font></div><div><font size="2"   >&nbsp; &nbsp; &nbsp; &nbsp; print(getWorldStockIndexInfo(stockDict))</font></div><div><font size="2"   ><br></font></div><div><font size="2"   ><br></font></div><div><font size="2"   >def main():</font></div><div><font size="2"   >&nbsp; &nbsp; "main function"</font></div><div><font size="2"   >&nbsp; &nbsp; print(base64.b64decode(b'Q29weXJpZ2h0IChjKSAyMDEyIERvdWN1YmUgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLg==').decode())</font></div><div><font size="2"   >&nbsp; &nbsp; test_china_index_data()</font></div><div><font size="2"   >&nbsp; &nbsp; test_china_individual_data()</font></div><div><font size="2"   >&nbsp; &nbsp; test_global_index_data()</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >if __name__ == '__main__':</font></div><div><font size="2"   >&nbsp; &nbsp; main()</font></div><p></p></pre></div><div><br></div><div><br></div><div><br></div><div><pre class="prettyprint"   ><p></p><div><font size="2"   >*** Python 3.2.2 (default, Sep &nbsp;4 2011, 09:51:08) [MSC v.1500 32 bit (Intel)] on win32. ***</font></div><div><font size="2"   >&gt;&gt;&gt;&nbsp;</font></div><div><font size="2"   >#上证指数#(000001) 收盘：2128.765，涨跌：2.761，幅度：0.13%，总手：5207.69万，金额：466.8022亿 &nbsp;http://image.sinajs.cn/newchart/daily/n/sh000001.gif</font></div><div><font size="2"   >#深证成指#(399001) 收盘：9087.130，涨跌：5.232，幅度：0.06%，总手：626366.6万，金额：475.5102亿 &nbsp;http://image.sinajs.cn/newchart/daily/n/sz399001.gif</font></div><div><font size="2"   >#沪深300#(000300) 收盘：2349.108，涨跌：1.620，幅度：0.07%，总手：3109.05万，金额：330.4818亿 &nbsp;http://image.sinajs.cn/newchart/daily/n/sh000300.gif</font></div><div><font size="2"   >#中小板指#(399005) 收盘：4289.397，涨跌：-28.691，幅度：-0.66%，总手：40025.33万，金额：52.3716亿 &nbsp;http://image.sinajs.cn/newchart/daily/n/sz399005.gif</font></div><div><font size="2"   >#创业板指#(399006) 收盘：703.581，涨跌：-3.144，幅度：-0.44%，总手：18349.6万，金额：30.0858亿 &nbsp;http://image.sinajs.cn/newchart/daily/n/sz399006.gif</font></div><div><font size="2"   >#Ｂ股指数#(000003) 收盘：217.495，涨跌：-0.164，幅度：-0.08%，总手：23.23万，金额：1.2213亿 &nbsp;http://image.sinajs.cn/newchart/daily/n/sh000003.gif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#中兴通讯#(000063) 开盘:11.35,最新:11.48,最高:11.58,最低:11.30,涨跌:0.14,幅度:1.23%,总手:11.01万,金额:1.26亿,更新时间:15:05:51 &nbsp;http://image.sinajs.cn/newchart/min/n/sz000063.gif</font></div><div><font size="2"   >#招商银行#(600036) 开盘:9.62,最新:9.75,最高:9.86,最低:9.62,涨跌:0.16,幅度:1.67%,总手:53.18万,金额:5.18亿,更新时间:15:02:09 &nbsp;http://image.sinajs.cn/newchart/min/n/sh600036.gif</font></div><div><font size="2"   ><br></font></div><div><font size="2"   >#中国上证指数# CHINA SHANGHAI COMPOSITE INDEX(000001) 当前：2128.765, 涨跌：+2.761, 幅度：+0.13%, 最后交易时间：3:01am&nbsp;</font></div><div><font size="2"   >#中国深证成指# SZSE COMPONENT INDEX(399001) 当前：9087.13, 涨跌：+5.231, 幅度：+0.06%, 最后交易时间：3:00am&nbsp;</font></div><div><font size="2"   >&gt;&gt;&gt;&gt;&gt;&gt; Exception: ^DJI list index out of range</font></div><div><font size="2"   >None</font></div><div><font size="2"   >#美国纳斯达克综合指数# NASDAQ Composite(IXIC) 当前：2930.03, 涨跌：+36.78, 幅度：+1.27%, 最后交易时间：12:03pm&nbsp;</font></div><div><font size="2"   >#美国标准普尔500指数# S&amp;P 500(GSPC) 当前：1374.55, 涨跌：+14.53, 幅度：+1.07%, 最后交易时间：12:03pm&nbsp;</font></div><div><font size="2"   >#日本日经225指数# NIKKEI 225(N225) 当前：8566.64, 涨跌：+123.54, 幅度：+1.46%, 最后交易时间：2:28am&nbsp;</font></div><div><font size="2"   >#台湾台北加权指数# TSEC weighted index(TWII) 当前：7124.49, 涨跌：+153.80, 幅度：+2.21%, 最后交易时间：1:33am&nbsp;</font></div><div><font size="2"   >#香港恒生指数# HANG SENG INDEX(HSI) 当前：19274.961, 涨跌：+382.172, 幅度：+2.02%, 最后交易时间：4:01am&nbsp;</font></div><div><font size="2"   >#法国CAC40指数# CAC 40(FCHI) 当前：3280.19, 涨跌：+73.07, 幅度：+2.28%, 最后交易时间：11:59am&nbsp;</font></div><div><font size="2"   >#英国富时100指数# FTSE 100(FTSE) 当前：5627.21, 涨跌：+54.05, 幅度：+0.97%, 最后交易时间：11:35am&nbsp;</font></div><div><font size="2"   >#德国法兰克福DAX指数# DAX(GDAXI) 当前：6689.40, 涨跌：+106.44, 幅度：+1.62%, 最后交易时间：11:45am&nbsp;</font></div><div><font size="2"   >&gt;&gt;&gt;</font></div><p></p></pre></div><div><br></div><div><br></div><div>一些数据接口：</div><div><div>#Sina 数据</div><div>#&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://hq.sinajs.cn/list=sh600000"   >http://hq.sinajs.cn/list=sh600000</a></div><div>#&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://hq.sinajs.cn/list=sz000913"   >http://hq.sinajs.cn/list=sz000913</a></div><div><br></div><div>&nbsp;</div><div>#var hq_str_sh601006="大秦铁路, 27.55, 27.25, 26.91, 27.55, 26.20, 26.91, 26.92,</div><div># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 22114263, 589824680, 4695, 26.91, 57590, 26.90, 14700, 26.89,</div><div># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14300,6.88, 15100, 26.87, 3100, 26.92, 8900, 26.93, 14230,</div><div># &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 26.94, 25150, 26.95, 15220, 26.96, 2008-01-11, 15:05:32";</div><div><br></div><div>&nbsp;</div><div><br></div><div>&nbsp; &nbsp;0：”大秦铁路”，股票名字；</div><div>&nbsp; &nbsp;1：”27.55″，今日开盘价；</div><div>&nbsp; &nbsp;2：”27.25″，昨日收盘价；</div><div>&nbsp; &nbsp;3：”26.91″，当前价格；//时间结束后也就是收盘价了</div><div>&nbsp; &nbsp;4：”27.55″，今日最高价；</div><div>&nbsp; &nbsp;5：”26.20″，今日最低价；</div><div>&nbsp; &nbsp;6：”26.91″，竞买价，即“买一”报价；</div><div>&nbsp; &nbsp;7：”26.92″，竞卖价，即“卖一”报价；</div><div>&nbsp; &nbsp;8：”22114263″，成交的股票数，由于股票交易以一百股为基本单位，所以在使用时，通常把该值除以一百；</div><div>&nbsp; &nbsp;9：”589824680″，成交金额，单位为“元”，为了一目了然，通常以“万元”为成交金额的单位，所以通常把该值除以一万；</div><div>&nbsp; &nbsp;10：”4695″，“买一”申请4695股，即47手；</div><div>&nbsp; &nbsp;11：”26.91″，“买一”报价；</div><div>&nbsp; &nbsp;12：”57590″，“买二”</div><div>&nbsp; &nbsp;13：”26.90″，“买二”</div><div>&nbsp; &nbsp;14：”14700″，“买三”</div><div>&nbsp; &nbsp;15：”26.89″，“买三”</div><div>&nbsp; &nbsp;16：”14300″，“买四”</div><div>&nbsp; &nbsp;17：”26.88″，“买四”</div><div>&nbsp; &nbsp;18：”15100″，“买五”</div><div>&nbsp; &nbsp;19：”26.87″，“买五”</div><div>&nbsp; &nbsp;20：”3100″，“卖一”申报3100股，即31手；</div><div>&nbsp; &nbsp;21：”26.92″，“卖一”报价 (22, 23), (24, 25), (26,27), (28, 29)分别为“卖二”至“卖四的情况”</div><div>&nbsp; &nbsp;30：”2008-01-11″，日期；</div><div>&nbsp; &nbsp;31：”15:05:32″，时间；</div><div>'''</div><div><br></div><div>&nbsp;</div><div><br></div><div>'''</div><div>上证综合指数（000001），</div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://hq.sinajs.cn/list=s_sh000001"   >http://hq.sinajs.cn/list=s_sh000001</a>&nbsp; 上证综合指数</div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://hq.sinajs.cn/list=s_sz399001"   >http://hq.sinajs.cn/list=s_sz399001</a>&nbsp; 深圳成指</div><div>var hq_str_s_sh000001=”上证指数,3094.668,-128.073,-3.97,436653,5458126″;</div><div>数据含义分别为： 指数名称，当前点数，当前价格，涨跌率，成交量（手），成交额（万元）；</div><div>&nbsp; &nbsp; ##['上证指数', &nbsp;000000</div><div>&nbsp; &nbsp; ##'2377.512', 收盘</div><div>&nbsp; &nbsp; ##'-5.973', &nbsp; 涨跌：</div><div>&nbsp; &nbsp; ##'-0.25', &nbsp; &nbsp;幅度：</div><div>&nbsp; &nbsp; ##'585346', &nbsp; 总手: /100 万</div><div>&nbsp; &nbsp; ##'5317351'] &nbsp;金额：/1000 亿</div><div><br></div><div>&nbsp;</div><div><br></div><div>K线图</div><div><br></div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://image.sinajs.cn/newchart/daily/n/sh601006.gif"   >http://image.sinajs.cn/newchart/daily/n/sh601006.gif</a>&nbsp; &nbsp; &nbsp;日K线</div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://image.sinajs.cn/newchart/min/n/sh000001.gif"   >http://image.sinajs.cn/newchart/min/n/sh000001.gif</a>&nbsp; &nbsp; &nbsp; &nbsp;分时线</div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://image.sinajs.cn/newchart/daily/n/sh000001.gif"   >http://image.sinajs.cn/newchart/daily/n/sh000001.gif</a>&nbsp; &nbsp; &nbsp;日K线</div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://image.sinajs.cn/newchart/weekly/n/sh000001.gif"   >http://image.sinajs.cn/newchart/weekly/n/sh000001.gif</a>&nbsp; &nbsp;周K线</div><div><a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://image.sinajs.cn/newchart/monthly/n/sh000001.gif"   >http://image.sinajs.cn/newchart/monthly/n/sh000001.gif</a>&nbsp; &nbsp;月K线</div><div><br></div><div>&nbsp;</div><div><br></div><div># 和讯网的图片数据</div><div>#&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://minpic.quote.stock.hexun.com/WebPic/SH/Min/601669_emb.gif"   >http://minpic.quote.stock.hexun.com/WebPic/SH/Min/601669_emb.gif</a></div><div>#&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://minpic.quote.stock.hexun.com/WebPic/SZ/Min/000063_emb.gif"   >http://minpic.quote.stock.hexun.com/WebPic/SZ/Min/000063_emb.gif</a></div><div>'''</div><div><br></div><div>Yahoo财经频道获取股票数据的API：</div><div>http://finance.yahoo.com/d/quotes.csv?s=&lt;股票名称&gt;&amp;f=&lt;数据列选项&gt;</div><div>参数s ― 表示股票名称，多个股票之间使用英文加号分隔，如“XOM+BBDb.TO+JNJ+MSFT”，罗列了四个公司的股票：XOM, BBDb.TO, JNJ, MSFT。 f ― 表示返回数据列，如“snd1l1yr”。</div><div>示例：</div><div><a target="_blank" rel="nofollow" href="http://finance.yahoo.com/d/quotes.csv?s=XOM+BBDb.TO+JNJ+MSFT&amp;f=snd1l1yr"   >http://finance.yahoo.com/d/quotes.csv?s=XOM+BBDb.TO+JNJ+MSFT&amp;f=snd1l1yr</a></div><div>返回：</div><div>"XOM","Exxon Mobil Corpo","10/7/2010",63.85,2.69,12.33</div><div>"BBD-B.TO","BOMBARDIER INC., ","10/7/2010",5.27,1.90,N/A</div><div>"JNJ","Johnson &amp; Johnson","10/7/2010",63.22,3.26,13.06</div><div>"MSFT","Microsoft Corpora","10/7/2010",24.53,2.12,11.68</div><div><br></div><div>上述是获取当前最新的数据，若需要获得历史数据，请使用下面API。</div><div>http://ichart.yahoo.com/table.csv?s=&lt;string&gt;&amp;a=&lt;int&gt;&amp;b=&lt;int&gt;&amp;c=&lt;int&gt;&amp;d=&lt;int&gt;&amp;e=&lt;int&gt;&amp;f=&lt;int&gt;&amp;g=d&amp;ignore=.csv</div><div><br></div><div>参数s ― 股票名称 a ― 起始时间，月 b ― 起始时间，日 c ― 起始时间，年 d ― 结束时间，月 e ― 结束时间，日 f ― 结束时间，年 g ― 时间周期。Example: g=w, 表示周期是‘周’。d-&gt;‘日’(day), w-&gt;‘周’(week)，m-&gt;‘月’(mouth)，v-&gt;‘dividends only’</div><div>一定注意月份参数，其值比真实数据-1。如需要9月数据，则写为08。</div><div><br></div><div>示例 查询浦发银行2010.09.25 C 2010.10.8之间日线数据</div><div><a target="_blank" rel="nofollow" href="http://ichart.yahoo.com/table.csv?s=600000.SS&amp;a=08&amp;b=25&amp;c=2010&amp;d=09&amp;e=8&amp;f=2010&amp;g=d"   >http://ichart.yahoo.com/table.csv?s=600000.SS&amp;a=08&amp;b=25&amp;c=2010&amp;d=09&amp;e=8&amp;f=2010&amp;g=d</a></div><div>返回：</div><div>Date,Open,High,Low,Close,Volume,Adj Close</div><div>2010-09-30,12.37,12.99,12.32,12.95,76420500,12.95</div><div>2010-09-29,12.20,12.69,12.12,12.48,79916400,12.48</div><div>2010-09-28,12.92,12.92,12.57,12.58,63988100,12.58</div><div>2010-09-27,13.00,13.02,12.89,12.94,43203600,12.94</div><div><br></div><div>深沪股票代码</div><div>yahoo的api是国际性的，是支持国内沪深股市的，但代码稍微变动一下，如浦发银行的代号是：600000.SS。规则是：上海市场末尾加.ss，深圳市场末尾加.sz。</div><div><br></div><div>―― EOF ――</div><div><br></div><div>参考</div><div><a target="_blank" rel="nofollow" href="http://code.google.com/p/yahoo-finance-managed/"   >http://code.google.com/p/yahoo-finance-managed/</a></div><div><a target="_blank" rel="nofollow" href="http://finance.yahoo.com/"   >http://finance.yahoo.com/</a></div><div><a target="_blank" rel="nofollow" href="http://www.gummy-stuff.org/Yahoo-data.htm"   >http://www.gummy-stuff.org/Yahoo-data.htm</a></div><div>Python API Class</div><div><a target="_blank" rel="nofollow" href="http://www.goldb.org/ystockquote.html"   >http://www.goldb.org/ystockquote.html</a></div><div><br></div><div>附录</div><div>雅虎股票API f参数对照表</div><div>a Ask a2 Average Daily Volume a5 Ask Size</div><div>b Bid b2 Ask (Real-time) b3 Bid (Real-time)</div><div>b4 Book Value b6 Bid Size c Change &amp; Percent Change</div><div>c1 Change c3 Commission c6 Change (Real-time)</div><div>c8 After Hours Change (Real-time) d Dividend/Share d1 Last Trade Date</div><div>d2 Trade Date e Earnings/Share e1 Error Indication (returned for symbol changed / invalid)</div><div>e7 EPS Estimate Current Year e8 EPS Estimate Next Year e9 EPS Estimate Next Quarter</div><div>f6 Float Shares g Day’s Low h Day’s High</div><div>j 52-week Low k 52-week High g1 Holdings Gain Percent</div><div>g3 Annualized Gain g4 Holdings Gain g5 Holdings Gain Percent (Real-time)</div><div>g6 Holdings Gain (Real-time) i More Info i5 Order Book (Real-time)</div><div>j1 Market Capitalization j3 Market Cap (Real-time) j4 EBITDA</div><div>j5 Change From 52-week Low j6 Percent Change From 52-week Low k1 Last Trade (Real-time) With Time</div><div>k2 Change Percent (Real-time) k3 Last Trade Size k4 Change From 52-week High</div><div>k5 Percebt Change From 52-week High l Last Trade (With Time) l1 Last Trade (Price Only)</div><div>l2 High Limit l3 Low Limit m Day’s Range</div><div>m2 Day’s Range (Real-time) m3 50-day Moving Average m4 200-day Moving Average</div><div>m5 Change From 200-day Moving Average m6 Percent Change From 200-day Moving Average m7 Change From 50-day Moving Average</div><div>m8 Percent Change From 50-day Moving Average n Name n4 Notes</div><div>o Open p Previous Close p1 Price Paid</div><div>p2 Change in Percent p5 Price/Sales p6 Price/Book</div><div>q Ex-Dividend Date r P/E Ratio r1 Dividend Pay Date</div><div>r2 P/E Ratio (Real-time) r5 PEG Ratio r6 Price/EPS Estimate Current Year</div><div>r7 Price/EPS Estimate Next Year s Symbol s1 Shares Owned</div><div>s7 Short Ratio t1 Last Trade Time t6 Trade Links</div><div>t7 Ticker Trend t8 1 yr Target Price v Volume</div><div>v1 Holdings Value v7 Holdings Value (Real-time) w 52-week Range</div><div>w1 Day’s Value Change w4 Day’s Value Change (Real-time) x Stock Exchange</div><div>y Dividend Yield</div></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="[转]Python3获取股票行情数据（中国个股/中国指数/全球指数） - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>