<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">oVirt Architecture</h2>
	<h5 id="">2014-08-08 10:42:35&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/16387704020147810211552/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>[原文]</div><div><a target="_blank" rel="nofollow" href="http://www.ovirt.org/Architecture"   >http://www.ovirt.org/Architecture</a></div><div><br></div><div><h1 id="firstHeading"   style="margin: 10px 0px 30px; font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-weight: normal; line-height: 40px; color: rgb(46, 52, 54); text-rendering: optimizelegibility; font-size: 38.5px; padding-bottom: 9px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); padding-top: 0px;"   ><span dir="auto"   >Architecture</span></h1><div id="contentSub"   style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ></div><div id="mw-content-text"   lang="en"   dir="ltr"   style="direction: ltr;"   ><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; clear: right; float: right;position:inherit;"   ><div><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/NIPxBEhD3AqPIEY8TBOzhQ==/6598170377797862422.png"   ></div>&nbsp;</div><table id="toc"   style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; max-width: 100%; border-collapse: collapse; border-spacing: 0px; margin: 30px 0px 20px 20px; background-color: transparent;"   ><tbody><tr><td style="padding: 0px 20px 10px; border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px;position:inherit; background-color: rgb(238, 238, 238);"   ><div id="toctitle"   style="position:inherit; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); padding: 0px 8ex 0px 10px; margin: 0px -10px 20px; direction: ltr;"   ><h2 style="margin: 0px; font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-weight: normal; line-height: 40px; color: rgb(85, 87, 83); text-rendering: optimizelegibility; font-size: 24px; padding-top: 0px;"   >Contents</h2><span style="position:inherit; top: 19px; right: 10px; font-size: 0px;"   >&nbsp;[<a id="togglelink" style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer; font-size: 12px;" class="internal" rel="nofollow" href="http://www.ovirt.org/Architecture#"   >hide</a>]&nbsp;</span></div><ul style="margin-top: 0.3em; margin-bottom: 0.3em; margin-left: 0px;"   ><li style="line-height: 20px; list-style: none; margin-top: 0px;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#oVirt_Architecture"   ><span>1</span>&nbsp;<span>oVirt Architecture</span></a><ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 2em;"   ><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Overall_architecture"   ><span>1.1</span>&nbsp;<span>Overall architecture</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Engine"   ><span>1.2</span>&nbsp;<span>Engine</span></a><ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 2em;"   ><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Engine-Core_Architecture"   ><span>1.2.1</span>&nbsp;<span>Engine-Core Architecture</span></a></li></ul></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Host_Agent_.28VDSM.29"   ><span>1.3</span>&nbsp;<span>Host Agent (VDSM)</span></a><ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 2em;"   ><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Hooks_mechanism"   ><span>1.3.1</span>&nbsp;<span>Hooks mechanism</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#MOM_integration"   ><span>1.3.2</span>&nbsp;<span>MOM integration</span></a></li></ul></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Web-based_User_Interface"   ><span>1.4</span>&nbsp;<span>Web-based User Interface</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#REST_API"   ><span>1.5</span>&nbsp;<span>REST API</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#CLI.2FSDK"   ><span>1.6</span>&nbsp;<span>CLI/SDK</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Reports_Engine"   ><span>1.7</span>&nbsp;<span>Reports Engine</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#DWH"   ><span>1.8</span>&nbsp;<span>DWH</span></a></li><li style="line-height: 20px; margin-top: 0px; list-style: none;"   ><a style="color: rgb(78, 154, 6); text-decoration: none; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Architecture#Guest_Agent"   ><span>1.9</span>&nbsp;<span>Guest Agent</span></a></li></ul></li></ul></td></tr></table><h1 style="color: inherit; font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 38.5px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="oVirt_Architecture"   >oVirt Architecture</span></h1><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >标准的oVirt部署包含的组件(引擎, 负责管理VM平台, 还包含用户平台和报告平台; 数据库, 存储管理普通的数据, 报告数据; 计算节点, 跑虚拟机的节点; 存储节点, 存放ISO镜像以及磁盘img镜像).</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >A standard oVirt deployment consists of three things, primarily:</p><ul style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px;"   >ovirt-engine which is used use to deploy, monitor, move, stop and create VM images, configure storage, network , etc.</li><li style="line-height: 20px; margin-top: 10px;"   >One or more hosts (nodes), on which we run virtual machines (VMs)</li><li style="line-height: 20px; margin-top: 10px;"   >One or more storage nodes, which hold the images and ISOs corresponding to those VMs</li></ul><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >Also, usually an idendity service is deployed aside the engine, to authenticate users and administrators for ovirt-engine.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >The nodes are Linux distributions with VDSM and libvirt installed, along with some extra packages to easily enable virtualization of networking and other system services. The supported Linux distributions to date are Fedora 17 or oVirt-node, which is basically a stripped-down distribution containing just enough components to allow virtualization.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >The storage nodes can use block or file storage, and can be local or remote, accessed via NFS. Storage technologies like Gluster are supported through the POSIXFS storage type. Storage nodes are grouped into storage pools, which can ensure high availability and redundancy. The&nbsp;<a title="Vdsm Storage Terminology" style="color: rgb(78, 154, 6); text-decoration: none; font-weight: 600; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/Vdsm_Storage_Terminology"   >Vdsm Storage Terminology</a>&nbsp;page has more details.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br>The different diagrams and descriptions below represent the architecture of the oVirt project, and its different components.</p><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Overall_architecture"   >Overall architecture</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >The following diagram shows the different components in the oVirt project:</p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/-GY5FnZcMHwgBuKCct3pYg==/6608778465980625928.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >HOST Agent, 计算节点的代理软件, 用于与管理节点engine通讯, 开启虚拟机, 挂载存储, 运行钩子程序等.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >Guest Agent, 虚拟机里面安装的agent,&nbsp;<a target="_blank" rel="nofollow" href="http://www.ovirt.org/Ovirt_guest_agent"   >http://www.ovirt.org/Ovirt_guest_agent</a>.&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >SPICE 客户端, 用于连接虚拟机的控制界面, 例如console. 客户端需要下载响应的管理软件来连接对应的console, 例如windows中spice和vnc需要Remote Viewer. 下载地址 :&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;<a target="_blank" rel="nofollow" href="http://www.ovirt.org/Console_Client_Resources"   >http://www.ovirt.org/Console_Client_Resources</a></p><p><a target="_blank" rel="nofollow" href="http://virt-manager.org/download/"   >http://virt-manager.org/download/</a></p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >These main components are:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >Engine (ovirt-engine) - manages the oVirt hosts, and allows system administrators to create and deploy new VMs</li><li style="line-height: 20px; margin-top: 10px;"   >Admin Portal - web based UI application on top of the engine, that sysadmins use to perform advanced actions.</li><li style="line-height: 20px; margin-top: 10px;"   >User Portal - a simplified web based UI application for simpler management use-cases.</li><li style="line-height: 20px; margin-top: 10px;"   >REST API - an API which allows applications to perform virtualization actions, which is used by the command line tools and the python SDK</li><li style="line-height: 20px; margin-top: 10px;"   >CLI/SDK - The command line interface and SDK provide a way to communicate with engine via script actions.</li><li style="line-height: 20px; margin-top: 10px;"   >Database - Postgres database is used by the engine to provide persistency for the configuration of the ovirt deployment.</li><li style="line-height: 20px; margin-top: 10px;"   >Host agent (VDSM) - the oVirt engine communicates with VSDM to request VM related actions on the nodes</li><li style="line-height: 20px; margin-top: 10px;"   >Guest Agent - The guest agent runs inside the VM, and provides information on resource usage to the oVirt engine. Communication is done over a virtualised serial connection.&nbsp;</li><li style="line-height: 20px; margin-top: 10px;"   >AD/IPA - directory services. Engine uses them to receive information on users and groups to be used with ovirt's permissions mechanism.</li><li style="line-height: 20px; margin-top: 10px;"   >DWH (Data Warehouse) - The data warehouse component performs ETL on data extracted from the db using Talend , and inserts it to history DB.</li><li style="line-height: 20px; margin-top: 10px;"   >Reports Engine - generates reports based on data in history DB, on system resource usage, using Jasper Reports</li><li style="line-height: 20px; margin-top: 10px;"   >SPICE client - utility which allows users to access the VMs.</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >The sections below will give a description and architectural aspects for each such component.</p><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Engine"   >Engine</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >oVirt engine is a JBoss-based Java application (previously C#) which runs as a web service. This service talks directly to VDSM on the hosts to deploy, start, stop, migrate and monitor VMs, and it can also create new images on storage from templates.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >It is a large scale, centralized management for server and desktop virtualization, based on leading performance, scalability and security infrastructure technologies.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >Some features provided by the engine:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >VM lifecycle management</li><li style="line-height: 20px; margin-top: 10px;"   >Authentication via LDAP providers (AD/IPA)</li><li style="line-height: 20px; margin-top: 10px;"   >Network management - adding logical networks, and attaching them to hosts</li><li style="line-height: 20px; margin-top: 10px;"   >Storage management - managing storage domains (NFS/iSCSI/Local), and virtual VM disks</li><li style="line-height: 20px; margin-top: 10px;"   >High Availability - restart guest VMs from failed hosts automatically on other hosts</li><li style="line-height: 20px; margin-top: 10px;"   >Live Migration - move running VM between hosts with zero downtime</li><li style="line-height: 20px; margin-top: 10px;"   >System Scheduler - continuously load balance VMs based on resource usage/policies</li><li style="line-height: 20px; margin-top: 10px;"   >Power Saver - concentrate virtual machines on fewer servers during off-peak hours</li><li style="line-height: 20px; margin-top: 10px;"   >Maintenance Manager - no downtime for virtual machines during planned maintenance windows.</li><li style="line-height: 20px; margin-top: 10px;"   >Image Management - template based provisioning, thin provisioning and snapshots</li><li style="line-height: 20px; margin-top: 10px;"   >Monitoring - for all objects in system C VM guests, hosts, networking, storage etc.</li><li style="line-height: 20px; margin-top: 10px;"   >Export/Import - import and export VMs and templates using OVF files</li><li style="line-height: 20px; margin-top: 10px;"   >V2V - convert VMs from VMware and RHEL/Xen environments to the oVirt environment</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >The following diagram shows the different layers in the oVirt engine component:</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/hEc16r7thNCpNjBHBi07wg==/887209126692632232.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><h3 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 18px; line-height: 20px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Engine-Core_Architecture"   >Engine-Core Architecture</span></h3><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >The following diagram shows the different components in the engine-core:</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/foUpIY1ndfgVa5vDS3I_Vg==/6608236406749255840.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >The main components in the engine core are:</p><ul style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px;"   >DB Broker - responsible for all the DB related actions</li><li style="line-height: 20px; margin-top: 10px;"   >VDS Broker - responsible for all actions that require communicating with VDSM</li><li style="line-height: 20px; margin-top: 10px;"   >LDAP Broker - responsible for authenticating and fetching user/group attributes from the LDAP directory (currently support AD, IPA and RHDS)</li><li style="line-height: 20px; margin-top: 10px;"   >Backend Bean - a Singleton bean responsible for running actions, queries and monitoring of the different entities</li></ul><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Host_Agent_.28VDSM.29"   >Host Agent (VDSM)</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >VDSM is a component developed in Python, which covers all functionality required by oVirt Engine for host, VM, networking and storage management.</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >The VDSM API is XML-RPC based (planned to move to REST API). This is how ovirt-engine communicates with VDSM.</li><li style="line-height: 20px; margin-top: 10px;"   >Configures host, networking and shared storage</li><li style="line-height: 20px; margin-top: 10px;"   >Uses libvirt for VM life cycle operations</li><li style="line-height: 20px; margin-top: 10px;"   >Multithreaded, multi-processes</li><li style="line-height: 20px; margin-top: 10px;"   >Speaks with its guest agent via virtio-serial</li><li style="line-height: 20px; margin-top: 10px;"   >Adds customized clustering support for LVM that scales to hundreds of nodes</li><li style="line-height: 20px; margin-top: 10px;"   >Implements a distributed image repository over the supported storage types (local directory, FCP, FCoE, iSCSI, NFS, SAS)</li><li style="line-height: 20px; margin-top: 10px;"   >Multihost system, one concurrent metadata writer</li><li style="line-height: 20px; margin-top: 10px;"   >Scales linearly in data writers</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/bmrw-R-jlanuZjDTV6w_ww==/3001086201789512452.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><span style="line-height: 31.5px; color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 18px;"   >Hooks mechanism</span></p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >Allows administrators to define scripts to modify VM operation eg. Add extra options such as CPU pinning, watchdog device, direct LUN access, etc.</li><li style="line-height: 20px; margin-top: 10px;"   >Allows oVirt to be extended for new KVM features before full integration is done</li><li style="line-height: 20px; margin-top: 10px;"   >An easy way to test a new kvm/libvirt/linux feature</li><li style="line-height: 20px; margin-top: 10px;"   >The hook mechanism is called before VDSM initiates the VM startup using libvirt.</li><li style="line-height: 20px; margin-top: 10px;"   >The hook changes the VM definition, and VDSM passes this definition to libvirt to start the VM.</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >The following diagram illustrates the Hook mechanism in the VM lifetime cycle:</p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/xIxKJjiWYHIGBs4llp-sOw==/6597442501099124448.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><h3 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 18px; line-height: 20px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="MOM_integration"   >MOM integration</span></h3><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/zWVfp0mB-ikTZkSYrqjZyA==/2125980499195875442.jpg"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >VDSM is integrated with&nbsp;<a title="MoM" style="color: rgb(78, 154, 6); text-decoration: none; font-weight: 600; cursor: pointer;" rel="nofollow" href="http://www.ovirt.org/MoM"   >MoM</a>. The behavior of MOM is configured with policies. With these policies users can fine tune the host for high memory overcommit or safe operation. In order to control its mom instance, vdsm does ship a mom configuration file and a mom policy file that sets mom's default behavior. At startup, vdsmd imports mom and initializes it with the configuration and policy files. From that point on, mom interacts with vdsm through the well-defined API in API.py and is controlling the memory balloons of each VM running on the host. The MOM Instance runs as a thread within the vdsm daemon.</p><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Web-based_User_Interface"   >Web-based User Interface</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >Following diagram provides a high level overview of oVirt user interface architecture:</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/ACoKAZxFSU9IawgQBkVnYQ==/6619112775769731415.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><ul style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px;"   ><a rel="nofollow" href="http://www.gwtproject.org/overview.html"   >Google Web Toolkit</a>: Java-based SDK providing tools and APIs for building web applications</li><li style="line-height: 20px; margin-top: 10px;"   ><a rel="nofollow" href="https://github.com/ArcBees/GWTP"   >GWT Platform</a>:&nbsp;<a rel="nofollow" href="http://en.wikipedia.org/wiki/Model_View_Presenter"   >Model-View-Presenter</a>&nbsp;framework following GWT&nbsp;<a rel="nofollow" href="http://www.gwtproject.org/articles/mvp-architecture.html"   >best</a>&nbsp;<a rel="nofollow" href="http://www.gwtproject.org/articles/mvp-architecture-2.html"   >practices</a>&nbsp;(<a rel="nofollow" href="http://courses.coreservlets.com/Course-Materials/pdf/ajax/GWT-MVP-Intro.pdf"   >slides</a>)</li><li style="line-height: 20px; margin-top: 10px;"   ><a rel="nofollow" href="http://code.google.com/p/google-gin/wiki/GinTutorial"   >GWT INjection</a>:&nbsp;<a rel="nofollow" href="http://en.wikipedia.org/wiki/Dependency_injection"   >dependency injection</a>&nbsp;framework for GWT</li><li style="line-height: 20px; margin-top: 10px;"   >oVirt GWT-Common: module housing common components such as widgets, abstract and infra-level classes, etc.</li><li style="line-height: 20px; margin-top: 10px;"   ><a title="UIPlugins (page does not exist)" style="color: rgb(186, 0, 0); text-decoration: none; font-weight: 600; cursor: pointer;" class="new" rel="nofollow" href="http://www.ovirt.org/index.php?title=UIPlugins&amp;action=edit&amp;redlink=1"   >oVirt UI Plugins</a>: feature allowing WebAdmin UI to be extended by JavaScript-based plugins at runtime</li></ul><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br>Following diagram shows a typical GWT development workflow:</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img0.ph.126.net/urxr6b6rO6Up3wi3AXe3zA==/6608788361585274900.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >&nbsp;</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br>oVirt UI is designed around following concepts:</p><ul style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px;"   >web browser as application platform, capable of delivering rich user experience through JavaScript-based applications</li><li style="line-height: 20px; margin-top: 10px;"   >dependency injection and event bus to employ loosely-coupled component architecture</li><li style="line-height: 20px; margin-top: 10px;"   >Model-View-Presenter for clean separation between presentation (View) and related business logic (Presenter)</li></ul><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="REST_API"   >REST API</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >RESTful API for integration with oVirt Engine:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >REST interface exposed for all API functions</li><li style="line-height: 20px; margin-top: 10px;"   >Stands for Representational State Transfer</li><li style="line-height: 20px; margin-top: 10px;"   >Modeling entity actions around HTTP verbs<ul style="margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px; margin-top: 10px;"   >GET</li><li style="line-height: 20px; margin-top: 10px;"   >PUT</li><li style="line-height: 20px; margin-top: 10px;"   >POST</li><li style="line-height: 20px; margin-top: 10px;"   >DELETE</li></ul></li><li style="line-height: 20px; margin-top: 10px;"   >Still uses 'actions' for some state changes</li><li style="line-height: 20px; margin-top: 10px;"   >Self describes C entity navigation and actions</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >REST Concepts:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >ClientCserver</li><li style="line-height: 20px; margin-top: 10px;"   >Stateless</li><li style="line-height: 20px; margin-top: 10px;"   >Cacheable</li><li style="line-height: 20px; margin-top: 10px;"   >Uniform interface</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="CLI.2FSDK"   >CLI/SDK</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >CLI and SDK are using on the REST api mentioned above.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >SDK:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >Python based SDK to allow performing actions on the different entities</li><li style="line-height: 20px; margin-top: 10px;"   >Complete protocol abstraction</li><li style="line-height: 20px; margin-top: 10px;"   >Full compliance with the oVirt API architecture</li><li style="line-height: 20px; margin-top: 10px;"   >Auto-completion</li><li style="line-height: 20px; margin-top: 10px;"   >Self descriptive</li><li style="line-height: 20px; margin-top: 10px;"   >Intuitive and easy to use</li><li style="line-height: 20px; margin-top: 10px;"   >Auto-Generated</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >CLI:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >Python based CLI to allow querying and performing actions on the different entities</li><li style="line-height: 20px; margin-top: 10px;"   >Complete protocol abstraction</li><li style="line-height: 20px; margin-top: 10px;"   >Full compliance with the oVirt API architecture</li><li style="line-height: 20px; margin-top: 10px;"   >Highly descriptive help for each operation</li><li style="line-height: 20px; margin-top: 10px;"   >Intuitive and easy to use</li><li style="line-height: 20px; margin-top: 10px;"   >Auto-Generated</li></ol><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Reports_Engine"   >Reports Engine</span></h2><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >Based on Jasper Reports</li><li style="line-height: 20px; margin-top: 10px;"   >Jasper allows to import/export reports definitions</li><li style="line-height: 20px; margin-top: 10px;"   >Rich reporting engine<ul style="margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px; margin-top: 10px;"   >Report scheduling</li><li style="line-height: 20px; margin-top: 10px;"   >Filters</li><li style="line-height: 20px; margin-top: 10px;"   >Export to various formats</li><li style="line-height: 20px; margin-top: 10px;"   >Report creation studio</li></ul></li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="DWH"   >DWH</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >The DWH component contains:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >ETL based on talendforge.org</li><li style="line-height: 20px; margin-top: 10px;"   >Periodic polling from operational DB</li><li style="line-height: 20px; margin-top: 10px;"   >Types of data<ul style="margin-top: 0.3em; margin-bottom: 0px; margin-left: 1.6em;"   ><li style="line-height: 20px; margin-top: 10px;"   >Config with version tracking</li><li style="line-height: 20px; margin-top: 10px;"   >Statistics C aggregated hourly/daily</li></ul></li><li style="line-height: 20px; margin-top: 10px;"   >API is view based</li></ol><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p><h2 style="color: rgb(85, 87, 83); font-family: 'Venturis Sans', 'Open Sans', sans-serif; font-size: 24px; line-height: 40px; margin: 10px 0px; font-weight: normal; text-rendering: optimizelegibility; padding-top: 1em;"   ><span id="Guest_Agent"   >Guest Agent</span></h2><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0px;"   >The guest agent provides additional information to oVirt Engine, such as guest memory usage, guest ip address, installed applications and sso.</p><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   >Architectural details:</p><ol style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px; margin-top: 0.3em; margin-bottom: 0px; margin-left: 3.2em;"   ><li style="line-height: 20px;"   >Python code, available for both linux and windows guests</li><li style="line-height: 20px; margin-top: 10px;"   >Communication is done over virtio-serial</li><li style="line-height: 20px; margin-top: 10px;"   >SSO for windows is based on a gina module for XP and a credential provider for windows 7</li><li style="line-height: 20px; margin-top: 10px;"   >SSO for RHEL 6 is based on a PAM module with support for both KDE and Gnome</li></ol><div style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   alt="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   style="margin:0 10px 0 0;"   src="http://img1.ph.126.net/LMMheOOAKfkuAVHYhWVhNQ==/2059833879668955799.png"   ></div><p style="color: rgb(46, 52, 54); font-family: 'Source Sans Pro', sans-serif; font-size: 14px; line-height: 20px;"   ><br></p></div></div><div><br></div><div>[参考]</div><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="http://www.ovirt.org/Architecture"   >http://www.ovirt.org/Architecture</a></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="oVirt Architecture - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>