<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>PostgreSQL research</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">PostgreSQL research</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">mongo_fdw enhanced by enterprisedb</h2>
	<h5 id="">2014-10-31 16:57:50&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/digoal@126/blog/static/163877040201493145750794/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>主要增加了可写功能, 连接池功能, 更新了最新的C驱动.</div><div>有需要的朋友可以一试.</div><div><br></div><div><h1 style="box-sizing: border-box; font-size: 2.25em; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; line-height: 1.2;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; margin-top: 0px !important;"   >MongoDB Foreign Data Wrapper for PostgreSQL</h1><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >This&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="http://www.mongodb.com/"   >MongoDB</a>&nbsp;extension implements the PostgreSQL's Foreign Data Wrapper.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Please note that this version of&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;only works with PostgreSQL Version&nbsp;<strong style="box-sizing: border-box;"   >9.3</strong>&nbsp;and greater.</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-installation" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#installation"   ></a>Installation</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The MongoDB FDW depends on the official MongoDB C Driver version 0.8 and includes it as a git submodule. If you are cloning this repository for the first time, be sure to pass the --recursive option to git clone in order to initialize the driver submodule to a useable state.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >If have checked out this project before and for some reason your submodule is not up-to-date, run git submodule update --init.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >When you type&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >make</code>, the C driver's source code also gets automatically compiled and linked.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Note: Make sure you have permission to "/usr/local" (default installation location) folder.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Note that we have verified the&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;extension only on MacOS X, Fedora and Ubuntu systems. If you run into issues on other systems, please&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="https://github.com/enterprisedb/mongo_fdw/issues/new"   >let us know</a></p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-enhancements" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#enhancements"   ></a>Enhancements</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The following enhancements are added to the latest version of mongo_fdw</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-write-able-fdw" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#write-able-fdw"   ></a>Write-able FDW</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The previous version was only read-only, the latest version provides the write capability. The user can now issue insert/update and delete statements for the foreign tables using the mongo_fdw.</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-connection-pooling" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#connection-pooling"   ></a>Connection Pooling</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The latest version comes with a connection pooler that utilises the same mongo database connection for all the queries in the same session. The previous version would open a new mongodb connection for every query. This is a performance enhancement.</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-new-mongodb-c-driver-support" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#new-mongodb-c-driver-support"   ></a>New MongoDB C Driver Support</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The third enhancement is to add a new&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="http://www.mongodb.com/"   >MongoDB</a>' C driver. The current implementation is based on the legacy driver of MongoDB. But&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="http://www.mongodb.com/"   >MongoDB</a>&nbsp;is provided completely new library for driver called MongoDB's Meta Driver. So I have added support of that driver. Now compile time option is available to use legacy and Meta driver. I am sure there are many other benefits of the new Mongo-C-driver that we are not leveraging but we will adopt those as we learn more about the new C driver.</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-usage" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#usage"   ></a>Usage</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The following parameters can be set on a MongoDB foreign server object:</p><ul style="box-sizing: border-box; padding-left: 2em; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   ><li style="box-sizing: border-box;"   ><strong style="box-sizing: border-box;"   ><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-weight: normal; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >address</code></strong>: the address or hostname of the MongoDB server Defaults to&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >127.0.0.1</code></li><li style="box-sizing: border-box;"   ><strong style="box-sizing: border-box;"   ><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-weight: normal; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >port</code></strong>: the port number of the MongoDB server. Defaults to&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >27017</code></li></ul><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >The following parameters can be set on a MongoDB foreign table object:</p><ul style="box-sizing: border-box; padding-left: 2em; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   ><li style="box-sizing: border-box;"   ><strong style="box-sizing: border-box;"   ><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-weight: normal; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >database</code></strong>: the name of the MongoDB database to query. Defaults to&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >test</code></li><li style="box-sizing: border-box;"   ><strong style="box-sizing: border-box;"   ><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-weight: normal; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >collection</code></strong>: the name of the MongoDB collection to query. Defaults to the foreign table name used in the relevant&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >CREATE</code>&nbsp;command</li></ul><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >As an example, the following commands demonstrate loading the&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;wrapper, creating a server, and then creating a foreign table associated with a MongoDB collection. The commands also show specifying option values in the&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >OPTIONS</code>&nbsp;clause. If an option value isn't provided, the wrapper uses the default value mentioned above.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   ><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;can collect data distribution statistics will incorporate them when estimating costs for the query execution plan. To see selected execution plans for a query, just run&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >EXPLAIN</code>.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Examples with&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="http://www.mongodb.com/"   >MongoDB</a>'s equivalent statments.</p><div style="box-sizing: border-box; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"   ><pre style="box-sizing: border-box; overflow: auto; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; margin-top: 0px; margin-bottom: 0px; font-stretch: normal; line-height: 1.45; padding: 16px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: normal; word-break: normal; background-color: rgb(247, 247, 247);"   ><span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- load extension first time after install</span>
CREATE EXTENSION mongo_fdw;

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- create server object</span>
CREATE SERVER mongo_server
         FOREIGN DATA WRAPPER mongo_fdw
         OPTIONS (address <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'127.0.0.1'</span>, port <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'27017'</span>);

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- create user mapping</span>
<span style="box-sizing: border-box; font-weight: bold;"   >CREATE</span> <span style="box-sizing: border-box; font-weight: bold;"   >USER</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119); font-weight: bold;"   >MAPPING</span> FOR postgres
         SERVER mongo_server
         OPTIONS (username <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'mongo_user'</span>, password <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'mongo_pass'</span>);

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- create foreign table</span>
CREATE FOREIGN TABLE warehouse(
         _id NAME,
         warehouse_id <span style="box-sizing: border-box; font-weight: bold; color: rgb(68, 85, 136);"   >int</span>,
         warehouse_name <span style="box-sizing: border-box; font-weight: bold; color: rgb(68, 85, 136);"   >text</span>,
         warehouse_created <span style="box-sizing: border-box; font-weight: bold; color: rgb(68, 85, 136);"   >timestamptz</span>)
SERVER mongo_server
         OPTIONS (database <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'db'</span>, collection <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'warehouse'</span>);

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- Note: first column of the table must be "_id" of type "NAME".</span>

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- select from table</span>
<span style="box-sizing: border-box; font-weight: bold;"   >SELECT</span> <span style="box-sizing: border-box; font-weight: bold;"   >*</span> <span style="box-sizing: border-box; font-weight: bold;"   >FROM</span> warehouse <span style="box-sizing: border-box; font-weight: bold;"   >WHERE</span> warehouse_id <span style="box-sizing: border-box; font-weight: bold;"   >=</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>;

           _id          | warehouse_id | warehouse_name |     warehouse_created
<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >------------------------+----------------+---------------------------</span>
53720b1904864dc1f5a571a0|            <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span> | UPS            | <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >12</span><span style="box-sizing: border-box; font-weight: bold;"   >-</span>DEC<span style="box-sizing: border-box; font-weight: bold;"   >-</span><span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >14</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >12</span>:<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >12</span>:<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >10</span> <span style="box-sizing: border-box; font-weight: bold;"   >+</span><span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >05</span>:<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >00</span>


<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >db</span>.<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >warehouse</span>.find({<span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_id"</span> : <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>}).pretty()
{
    <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"_id"</span> : ObjectId(<span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"53720b1904864dc1f5a571a0"</span>),
    <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_id"</span> : <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>,
    <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_name"</span> : <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"UPS"</span>,
    <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_created"</span> : ISODate(<span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"2014-12-12T07:12:10Z"</span>)
}


<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- insert row in table</span>
<span style="box-sizing: border-box; font-weight: bold;"   >INSERT INTO</span> warehouse <span style="box-sizing: border-box; font-weight: bold;"   >values</span> (<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >0</span>, <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>, <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'UPS'</span>, to_date(<span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'2014-12-12T07:12:10Z'</span>));

<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >db</span>.<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >warehouse</span>.insert
(
    {
        <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_id"</span> : NumberInt(<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>),
        <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_name"</span> : <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"UPS"</span>,
        <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_created"</span> : ISODate(<span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"2014-12-12T07:12:10Z"</span>)
    }
);

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- delete row from table</span>
<span style="box-sizing: border-box; font-weight: bold;"   >DELETE</span> <span style="box-sizing: border-box; font-weight: bold;"   >FROM</span> warehouse <span style="box-sizing: border-box; font-weight: bold;"   >where</span> warehouse_id <span style="box-sizing: border-box; font-weight: bold;"   >=</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >3</span>;

<span style="box-sizing: border-box; font-weight: bold;"   >&gt;</span>    <span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >db</span>.<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >warehouse</span>.remove({<span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_id"</span> : <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >2</span>})


<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- update a row of table</span>
<span style="box-sizing: border-box; font-weight: bold;"   >UPDATE</span> warehouse <span style="box-sizing: border-box; font-weight: bold;"   >set</span> warehouse_name <span style="box-sizing: border-box; font-weight: bold;"   >=</span> <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >'UPS_NEW'</span> <span style="box-sizing: border-box; font-weight: bold;"   >where</span> warehouse_id <span style="box-sizing: border-box; font-weight: bold;"   >=</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>;

<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >db</span>.<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >warehouse</span>.<span style="box-sizing: border-box; font-weight: bold;"   >update</span>
(
   {
        <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_id"</span> : <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>
   },
   {
        <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_id"</span> : <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>,
        <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"warehouse_name"</span> : <span style="box-sizing: border-box; color: rgb(223, 80, 0);"   >"UPS_NEW"</span>
   }
)

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- explain a table</span>
EXPLAIN <span style="box-sizing: border-box; font-weight: bold;"   >SELECT</span> <span style="box-sizing: border-box; font-weight: bold;"   >*</span> <span style="box-sizing: border-box; font-weight: bold;"   >FROM</span> warehouse <span style="box-sizing: border-box; font-weight: bold;"   >WHERE</span> warehouse_id <span style="box-sizing: border-box; font-weight: bold;"   >=</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>;
                           QUERY PLAN
 <span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-----------------------------------------------------------------</span>
 Foreign Scan <span style="box-sizing: border-box; font-weight: bold;"   >on</span> warehouse  (cost<span style="box-sizing: border-box; font-weight: bold;"   >=</span><span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >0</span>.<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >00</span>..<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >0</span>.<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >00</span> rows<span style="box-sizing: border-box; font-weight: bold;"   >=</span><span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1000</span> width<span style="box-sizing: border-box; font-weight: bold;"   >=</span><span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >44</span>)
   Filter: (warehouse_id <span style="box-sizing: border-box; font-weight: bold;"   >=</span> <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >1</span>)
   Foreign Namespace: <span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >db</span>.<span style="box-sizing: border-box; color: rgb(9, 78, 153);"   >warehouse</span>
 Planning <span style="box-sizing: border-box; font-weight: bold; color: rgb(68, 85, 136);"   >time</span>: <span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >0</span>.<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >671</span> ms
(<span style="box-sizing: border-box; color: rgb(148, 82, 119);"   >4</span> rows)

<span style="box-sizing: border-box; color: rgb(153, 153, 136); font-style: italic;"   >-- collect data distribution statistics`</span>
ANALYZE warehouse;
</pre></div><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-limitations" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#limitations"   ></a>Limitations</h2><ul style="box-sizing: border-box; padding-left: 2em; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   ><li style="box-sizing: border-box;"   ><p style="box-sizing: border-box; margin-top: 16px; margin-bottom: 16px;"   >If the BSON document key contains uppercase letters or occurs within a nested document,<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;requires the corresponding column names to be declared in double quotes.</p></li><li style="box-sizing: border-box;"   ><p style="box-sizing: border-box; margin-top: 16px; margin-bottom: 16px;"   >Note that PostgreSQL limits column names to 63 characters by default. If you need column names that are longer, you can increase the&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >NAMEDATALEN</code>&nbsp;constant in&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >src/include/pg_config_manual.h</code>, compile, and reinstall.</p></li></ul><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-contributing" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#contributing"   ></a>Contributing</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Have a fix for a bug or an idea for a great new feature? Great! Check out the contribution guidelines&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw/blob/master/CONTRIBUTING.md"   >here</a>. For all other types of questions or comments about the wrapper please contact us at&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >@</code><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >enterprisedb.com</code>.</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-support" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#support"   ></a>Support</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >This project will be modified to maintain compatibility with new PostgreSQL releases. The project owners set aside a day every month to look over open issues and support emails, but are not engaged in active feature development. Reported bugs will be addressed by apparent severity.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >As with many open source projects, you may be able to obtain support via the public mailing list (<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >mongo_fdw</code>&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >@</code>&nbsp;<code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >enterprisedb.com</code>). If you need commercial support, please contact the EnterpriseDB sales team, or check whether your existing PostgreSQL support provider can also support mongo_fdw.</p><h2 style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em;position:inherit; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif;"   ><a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; position: absolute; top: 0px; bottom: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; background: transparent;" name="user-content-license" aria-hidden="true" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw#license"   ></a>License</h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Portions Copyright ? 2004-2014, EnterpriseDB Corporation.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >Portions Copyright ? 2012C2014 Citus Data, Inc.</p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px;"   >This program is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p><p style="box-sizing: border-box; margin-top: 0px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 25.6000003814697px; margin-bottom: 0px !important;"   >See the&nbsp;<a style="box-sizing: border-box; color: rgb(65, 131, 196); text-decoration: none; background: transparent;" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw/blob/master/LICENSE"   ><code style="box-sizing: border-box; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 14px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157);"   >LICENSE</code></a>&nbsp;file for full details.</p></div><wbr><div><br></div>[参考]<wbr><div>1.&nbsp;<a style="line-height: 28px;" target="_blank" rel="nofollow" href="https://github.com/EnterpriseDB/mongo_fdw"   >https://github.com/EnterpriseDB/mongo_fdw</a></div><div><br></div>
<a rel="nofollow" href="http://info.flagcounter.com/h9V1"   ><img title="mongo_fdw enhanced by enterprisedb - 德哥@Digoal - PostgreSQL research"   src="http://s03.flagcounter.com/count/h9V1/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_0/flags_0/"   alt="Flag Counter"   border="0"   ></a></div>
	</div>
</div>
</body>
</html>